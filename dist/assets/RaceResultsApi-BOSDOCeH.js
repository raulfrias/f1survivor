async function o(n){try{console.log(`Fetching race results for session: ${n}`);const e=l(n);if(e)return console.log("Using cached race results"),e;const r=m(n);return r?(s(n,r),r):(console.warn(`No race results available for session: ${n}`),null)}catch(e){return console.error("Failed to fetch race results:",e),null}}function l(n){try{const e=localStorage.getItem(`race_results_${n}`);if(!e)return null;const r=JSON.parse(e),a=Date.now()-new Date(r.fetched_at).getTime(),i=24*60*60*1e3;return a>i?(localStorage.removeItem(`race_results_${n}`),null):r.results}catch(e){return console.error("Error reading cached results:",e),null}}function s(n,e){try{const r={results:e,fetched_at:new Date().toISOString()};localStorage.setItem(`race_results_${n}`,JSON.stringify(r))}catch(r){console.error("Error caching results:",r)}}function m(n){return{"bhr-2025-race":{session_key:n,session_name:"Race",location:"Bahrain",date:"2025-03-02",positions:[{position:1,driver_number:1,full_name:"Max Verstappen",team_name:"Red Bull Racing"},{position:2,driver_number:4,full_name:"Lando Norris",team_name:"McLaren"},{position:3,driver_number:16,full_name:"Charles Leclerc",team_name:"Ferrari"},{position:4,driver_number:55,full_name:"Carlos Sainz",team_name:"Ferrari"},{position:5,driver_number:63,full_name:"George Russell",team_name:"Mercedes"},{position:6,driver_number:44,full_name:"Lewis Hamilton",team_name:"Mercedes"},{position:7,driver_number:11,full_name:"Sergio Perez",team_name:"Red Bull Racing"},{position:8,driver_number:14,full_name:"Fernando Alonso",team_name:"Aston Martin"},{position:9,driver_number:18,full_name:"Lance Stroll",team_name:"Aston Martin"},{position:10,driver_number:81,full_name:"Oscar Piastri",team_name:"McLaren"},{position:11,driver_number:27,full_name:"Nico Hulkenberg",team_name:"Haas"},{position:12,driver_number:20,full_name:"Kevin Magnussen",team_name:"Haas"},{position:13,driver_number:10,full_name:"Pierre Gasly",team_name:"Alpine"},{position:14,driver_number:31,full_name:"Esteban Ocon",team_name:"Alpine"},{position:15,driver_number:23,full_name:"Alexander Albon",team_name:"Williams"},{position:16,driver_number:2,full_name:"Logan Sargeant",team_name:"Williams"},{position:17,driver_number:77,full_name:"Valtteri Bottas",team_name:"Kick Sauber"},{position:18,driver_number:24,full_name:"Zhou Guanyu",team_name:"Kick Sauber"},{position:19,driver_number:22,full_name:"Yuki Tsunoda",team_name:"RB"},{position:20,driver_number:3,full_name:"Daniel Ricciardo",team_name:"RB"}]},"sau-2025-race":{session_key:n,session_name:"Race",location:"Saudi Arabia",date:"2025-03-09",positions:[{position:1,driver_number:16,full_name:"Charles Leclerc",team_name:"Ferrari"},{position:2,driver_number:1,full_name:"Max Verstappen",team_name:"Red Bull Racing"},{position:3,driver_number:4,full_name:"Lando Norris",team_name:"McLaren"},{position:4,driver_number:55,full_name:"Carlos Sainz",team_name:"Ferrari"},{position:5,driver_number:44,full_name:"Lewis Hamilton",team_name:"Mercedes"},{position:6,driver_number:63,full_name:"George Russell",team_name:"Mercedes"},{position:7,driver_number:81,full_name:"Oscar Piastri",team_name:"McLaren"},{position:8,driver_number:11,full_name:"Sergio Perez",team_name:"Red Bull Racing"},{position:9,driver_number:14,full_name:"Fernando Alonso",team_name:"Aston Martin"},{position:10,driver_number:18,full_name:"Lance Stroll",team_name:"Aston Martin"},{position:11,driver_number:27,full_name:"Nico Hulkenberg",team_name:"Haas"},{position:12,driver_number:20,full_name:"Kevin Magnussen",team_name:"Haas"},{position:13,driver_number:10,full_name:"Pierre Gasly",team_name:"Alpine"},{position:14,driver_number:31,full_name:"Esteban Ocon",team_name:"Alpine"},{position:15,driver_number:23,full_name:"Alexander Albon",team_name:"Williams"},{position:16,driver_number:2,full_name:"Logan Sargeant",team_name:"Williams"},{position:17,driver_number:77,full_name:"Valtteri Bottas",team_name:"Kick Sauber"},{position:18,driver_number:24,full_name:"Zhou Guanyu",team_name:"Kick Sauber"},{position:19,driver_number:22,full_name:"Yuki Tsunoda",team_name:"RB"},{position:20,driver_number:3,full_name:"Daniel Ricciardo",team_name:"RB"}]},"esp-2025-race":{session_key:n,session_name:"Race",location:"Barcelona",date:"2025-06-01",positions:[{position:1,driver_number:1,full_name:"Max Verstappen",team_name:"Red Bull Racing"},{position:2,driver_number:4,full_name:"Lando Norris",team_name:"McLaren"},{position:3,driver_number:16,full_name:"Charles Leclerc",team_name:"Ferrari"},{position:4,driver_number:81,full_name:"Oscar Piastri",team_name:"McLaren"},{position:5,driver_number:63,full_name:"George Russell",team_name:"Mercedes"},{position:6,driver_number:44,full_name:"Lewis Hamilton",team_name:"Mercedes"},{position:7,driver_number:11,full_name:"Sergio Perez",team_name:"Red Bull Racing"},{position:8,driver_number:14,full_name:"Fernando Alonso",team_name:"Aston Martin"},{position:9,driver_number:18,full_name:"Lance Stroll",team_name:"Aston Martin"},{position:10,driver_number:27,full_name:"Nico Hulkenberg",team_name:"Kick Sauber"},{position:11,driver_number:20,full_name:"Kevin Magnussen",team_name:"Haas"},{position:12,driver_number:10,full_name:"Pierre Gasly",team_name:"Alpine"},{position:13,driver_number:31,full_name:"Esteban Ocon",team_name:"Alpine"},{position:14,driver_number:22,full_name:"Yuki Tsunoda",team_name:"RB"},{position:15,driver_number:55,full_name:"Carlos Sainz",team_name:"Williams"},{position:16,driver_number:23,full_name:"Alexander Albon",team_name:"Williams"},{position:17,driver_number:77,full_name:"Valtteri Bottas",team_name:"Kick Sauber"},{position:18,driver_number:24,full_name:"Zhou Guanyu",team_name:"Kick Sauber"},{position:19,driver_number:2,full_name:"Logan Sargeant",team_name:"Williams"},{position:20,driver_number:3,full_name:"Daniel Ricciardo",team_name:"RB"}]}}[n]||null}function u(n,e){if(!e||!e.positions)return{status:"PENDING",position:null};const r=e.positions.find(t=>t.driver_number===n.driverId);if(!r)return{status:"DNF",position:"DNF"};const a=r.position;return{status:a<=10?"SURVIVED":"ELIMINATED",position:`P${a}`}}async function _(n){const e=[];for(const r of n)try{const a=`${r.raceId}-race`,i=await o(a),t=u(r,i);e.push({...r,raceResults:i,survivalStatus:t})}catch(a){console.error(`Error processing pick for race ${r.raceId}:`,a),e.push({...r,raceResults:null,survivalStatus:{status:"PENDING",position:null}})}return e}function c(n){return!n.some(e=>e.survivalStatus&&e.survivalStatus.status==="ELIMINATED")}function d(n){const e=n.filter(a=>a.survivalStatus&&a.survivalStatus.status!=="PENDING");if(e.length===0)return 100;const r=e.filter(a=>a.survivalStatus.status==="SURVIVED");return Math.round(r.length/e.length*100)}export{s as cacheRaceResults,d as calculateSurvivalRate,u as calculateSurvivalStatus,o as fetchRaceResults,l as getCachedRaceResults,_ as getPicksWithResults,c as isPlayerAlive};
