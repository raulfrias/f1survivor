(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const fo=[{id:"aus-2025",location:"Melbourne",raceName:"Australian GP",country:"Australia",circuit:"Melbourne",date:"2025-03-16",timeLocal:"15:00",timeGMT:"04:00",dateStart:"2025-03-16T04:00:00+00:00",round:1},{id:"chn-2025",location:"Shanghai",raceName:"Chinese GP",country:"China",circuit:"Shanghai",date:"2025-03-23",timeLocal:"15:00",timeGMT:"07:00",dateStart:"2025-03-23T07:00:00+00:00",round:2},{id:"jpn-2025",location:"Suzuka",raceName:"Japanese GP",country:"Japan",circuit:"Suzuka",date:"2025-04-06",timeLocal:"14:00",timeGMT:"05:00",dateStart:"2025-04-06T05:00:00+00:00",round:3},{id:"bhr-2025",location:"Sakhir",raceName:"Bahrain GP",country:"Bahrain",circuit:"Sakhir",date:"2025-04-13",timeLocal:"18:00",timeGMT:"15:00",dateStart:"2025-04-13T15:00:00+00:00",round:4},{id:"sau-2025",location:"Jeddah",raceName:"Saudi Arabian GP",country:"Saudi Arabia",circuit:"Jeddah",date:"2025-04-20",timeLocal:"20:00",timeGMT:"17:00",dateStart:"2025-04-20T17:00:00+00:00",round:5},{id:"mia-2025",location:"Miami",raceName:"Miami GP",country:"United States",circuit:"Miami",date:"2025-05-04",timeLocal:"16:00",timeGMT:"20:00",dateStart:"2025-05-04T20:00:00+00:00",round:6},{id:"emi-2025",location:"Imola",raceName:"Emilia-Romagna GP",country:"Italy",circuit:"Imola",date:"2025-05-18",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-05-18T13:00:00+00:00",round:7},{id:"mon-2025",location:"Monaco",raceName:"Monaco GP",country:"Monaco",circuit:"Monaco",date:"2025-05-25",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-05-25T13:00:00+00:00",round:8},{id:"esp-2025",location:"Barcelona",raceName:"Spanish GP",country:"Spain",circuit:"Barcelona",date:"2025-06-01",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-06-01T13:00:00+00:00",round:9},{id:"can-2025",location:"Montreal",raceName:"Canadian GP",country:"Canada",circuit:"Montreal",date:"2025-06-15",timeLocal:"14:00",timeGMT:"18:00",dateStart:"2025-06-15T18:00:00+00:00",round:10},{id:"aut-2025",location:"Spielberg",raceName:"Austrian GP",country:"Austria",circuit:"Red Bull Ring",date:"2025-06-29",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-06-29T13:00:00+00:00",round:11},{id:"gbr-2025",location:"Silverstone",raceName:"British GP",country:"Great Britain",circuit:"Silverstone",date:"2025-07-06",timeLocal:"15:00",timeGMT:"14:00",dateStart:"2025-07-06T14:00:00+00:00",round:12},{id:"bel-2025",location:"Spa",raceName:"Belgian GP",country:"Belgium",circuit:"Spa-Francorchamps",date:"2025-07-27",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-07-27T13:00:00+00:00",round:13},{id:"hun-2025",location:"Budapest",raceName:"Hungarian GP",country:"Hungary",circuit:"Hungaroring",date:"2025-08-03",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-08-03T13:00:00+00:00",round:14},{id:"ned-2025",location:"Zandvoort",raceName:"Dutch GP",country:"Netherlands",circuit:"Zandvoort",date:"2025-08-31",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-08-31T13:00:00+00:00",round:15},{id:"ita-2025",location:"Monza",raceName:"Italian GP",country:"Italy",circuit:"Monza",date:"2025-09-07",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-09-07T13:00:00+00:00",round:16},{id:"aze-2025",location:"Baku",raceName:"Azerbaijan GP",country:"Azerbaijan",circuit:"Baku",date:"2025-09-21",timeLocal:"15:00",timeGMT:"11:00",dateStart:"2025-09-21T11:00:00+00:00",round:17},{id:"sgp-2025",location:"Singapore",raceName:"Singapore GP",country:"Singapore",circuit:"Marina Bay",date:"2025-10-05",timeLocal:"20:00",timeGMT:"12:00",dateStart:"2025-10-05T12:00:00+00:00",round:18},{id:"usa-2025",location:"Austin",raceName:"United States GP",country:"United States",circuit:"COTA",date:"2025-10-19",timeLocal:"14:00",timeGMT:"19:00",dateStart:"2025-10-19T19:00:00+00:00",round:19},{id:"mex-2025",location:"Mexico City",raceName:"Mexico City GP",country:"Mexico",circuit:"Mexico City",date:"2025-10-26",timeLocal:"14:00",timeGMT:"20:00",dateStart:"2025-10-26T20:00:00+00:00",round:20},{id:"bra-2025",location:"São Paulo",raceName:"São Paulo GP",country:"Brazil",circuit:"Interlagos",date:"2025-11-09",timeLocal:"14:00",timeGMT:"17:00",dateStart:"2025-11-09T17:00:00+00:00",round:21},{id:"lv-2025",location:"Las Vegas",raceName:"Las Vegas GP",country:"United States",circuit:"Las Vegas",date:"2025-11-22",timeLocal:"20:00",timeGMT:"04:00",dateStart:"2025-11-23T04:00:00+00:00",round:22},{id:"qat-2025",location:"Lusail",raceName:"Qatar GP",country:"Qatar",circuit:"Lusail",date:"2025-11-30",timeLocal:"19:00",timeGMT:"16:00",dateStart:"2025-11-30T16:00:00+00:00",round:23},{id:"uae-2025",location:"Abu Dhabi",raceName:"Abu Dhabi GP",country:"United Arab Emirates",circuit:"Yas Marina",date:"2025-12-07",timeLocal:"17:00",timeGMT:"13:00",dateStart:"2025-12-07T13:00:00+00:00",round:24}];function uc(e=new Date){const t=fo.filter(n=>new Date(n.dateStart)>e);return t.length===0?null:t.sort((n,r)=>new Date(n.dateStart)-new Date(r.dateStart))[0]}const Cy=Object.freeze(Object.defineProperty({__proto__:null,F1_2025_CALENDAR:fo,getNextRace:uc},Symbol.toStringTag,{value:"Module"})),lc="modulepreload",dc=function(e,t){return new URL(e,t).href},Ai={},po=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let o=function(l){return Promise.all(l.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const a=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=o(n.map(l=>{if(l=dc(l,r),l in Ai)return;Ai[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(!!r)for(let g=a.length-1;g>=0;g--){const m=a[g];if(m.href===l&&(!d||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":lc,d||(p.as="script"),p.crossOrigin="",p.href=l,u&&p.setAttribute("nonce",u),document.head.appendChild(p),d)return new Promise((g,m)=>{p.addEventListener("load",g),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},hc="Logging",fc="x-amz-user-agent",pc="NoHubcallbackProvidedException";var ce;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(ce||(ce={}));const Ni={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class X{constructor(t,n=ce.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...n){let r=this.level;X.LOG_LEVEL&&(r=X.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(r=window.LOG_LEVEL);const i=Ni[r];if(!(Ni[t]>=i))return;let o=console.log.bind(console);t===ce.ERROR&&console.error&&(o=console.error.bind(console)),t===ce.WARN&&console.warn&&(o=console.warn.bind(console)),X.BIND_ALL_LOG_LEVELS&&(t===ce.INFO&&console.info&&(o=console.info.bind(console)),t===ce.DEBUG&&console.debug&&(o=console.debug.bind(console)));const a=`[${t}] ${this._ts()} ${this.name}`;let c="";if(n.length===1&&typeof n[0]=="string")c=`${a} - ${n[0]}`,o(c);else if(n.length===1)c=`${a} ${n[0]}`,o(a,n[0]);else if(typeof n[0]=="string"){let u=n.slice(1);u.length===1&&(u=u[0]),c=`${a} - ${n[0]} ${u}`,o(`${a} - ${n[0]}`,u)}else c=`${a} ${n}`,o(a,n);for(const u of this._pluggables){const l={message:c,timestamp:Date.now()};u.pushLogs([l])}}log(...t){this._log(ce.INFO,...t)}info(...t){this._log(ce.INFO,...t)}warn(...t){this._log(ce.WARN,...t)}error(...t){this._log(ce.ERROR,...t)}debug(...t){this._log(ce.DEBUG,...t)}verbose(...t){this._log(ce.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===hc&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}X.LOG_LEVEL=null;X.BIND_ALL_LOG_LEVELS=!1;class re extends Error{constructor({message:t,name:n,recoverySuggestion:r,underlyingError:i,metadata:s}){if(super(t),this.name=n,this.underlyingError=i,this.recoverySuggestion=r,s){const{extendedRequestId:o,httpStatusCode:a,requestId:c}=s;this.metadata={extendedRequestId:o,httpStatusCode:a,requestId:c}}this.constructor=re,Object.setPrototypeOf(this,re.prototype)}}var Ye;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(Ye||(Ye={}));const Fr=(e,t=re)=>(n,r,i)=>{const{message:s,recoverySuggestion:o}=e[r];if(!n)throw new t({name:r,message:i?`${s} ${i}`:s,recoverySuggestion:o})},Je=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",Ot=new X("Hub");class go{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,n){const r=this.listeners.get(t);if(!r){Ot.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...r.filter(({callback:i})=>i!==n)])}dispatch(t,n,r,i){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(i===Je||Ot.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const s={channel:t,payload:{...n},source:r,patternInfo:[]};try{this._toListeners(s)}catch(o){Ot.error(o)}}listen(t,n,r="noname"){let i;if(typeof n!="function")throw new re({name:pc,message:"No callback supplied to Hub"});i=n;let s=this.listeners.get(t);return s||(s=[],this.listeners.set(t,s)),s.push({name:r,callback:i}),()=>{this._remove(t,i)}}_toListeners(t){const{channel:n,payload:r}=t,i=this.listeners.get(n);i&&i.forEach(s=>{Ot.debug(`Dispatching to ${n} with `,r);try{s.callback(t)}catch(o){Ot.error(o)}})}}const Qe=new go("__default__"),_n=new go("internal-hub"),gc=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new re({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},mc=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new re({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},yc=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new re({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},qr={convert(e,t){let n=e;return t!=null&&t.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),yc()(n)}};var Ce;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(Ce||(Ce={}));const Ec={[Ce.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Ce.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Ce.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Ce.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Ce.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},$r=Fr(Ec);function M(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,$r(t,Ce.AuthUserPoolException)}function mo(e){var n,r,i,s,o,a,c,u;const t=!!((r=(n=e==null?void 0:e.loginWith)==null?void 0:n.oauth)!=null&&r.domain)&&!!((s=(i=e==null?void 0:e.loginWith)==null?void 0:i.oauth)!=null&&s.redirectSignOut)&&!!((a=(o=e==null?void 0:e.loginWith)==null?void 0:o.oauth)!=null&&a.redirectSignIn)&&!!((u=(c=e==null?void 0:e.loginWith)==null?void 0:c.oauth)!=null&&u.responseType);$r(t,Ce.OAuthNotConfigureException)}function En(e){const t=!!(e!=null&&e.identityPoolId);$r(t,Ce.InvalidIdentityPoolIdException)}function nt(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const r=t[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(qr.convert(r).split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),s=JSON.parse(i);return{toString:()=>e,payload:s}}catch{throw new Error("Invalid token payload")}}const yo=e=>e&&e["nonRetryable"],un=new X("retryUtil");async function vc(e,t,n,r){if(typeof e!="function")throw Error("functionToRetry must be a function");return new Promise(async(i,s)=>{let o=0,a=!1,c=()=>{},u;for(;!a;){o++,un.debug(`${e.name} attempt #${o} with this vars: ${JSON.stringify(t)}`);try{i(await e(...t));return}catch(l){if(u=l,un.debug(`error on ${e.name}`,l),yo(l)){un.debug(`${e.name} non retryable error`,l),s(l);return}const d=n(o,t,l);if(un.debug(`${e.name} retrying in ${d} ms`),d===!1||a){s(l);return}else await new Promise(h=>{c=h,setTimeout(c,d)})}}s(u)})}const Eo=e=>{const t=Reflect.ownKeys(e);for(const n of t){const r=e[n];(r&&typeof r=="object"||typeof r=="function")&&Eo(r)}return Object.freeze(e)},Sc=new X("parseAWSExports"),Ic={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},wc=(e={})=>{var yi,Ei,vi,Si,Ii,wi;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new re({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:r,aws_appsync_region:i,aws_bots_config:s,aws_cognito_identity_pool_id:o,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:u,aws_cognito_password_protection_settings:l,aws_cognito_verification_mechanisms:d,aws_cognito_signup_attributes:h,aws_cognito_social_providers:f,aws_cognito_username_attributes:p,aws_mandatory_sign_in:g,aws_mobile_analytics_app_id:m,aws_mobile_analytics_app_region:E,aws_user_files_s3_bucket:S,aws_user_files_s3_bucket_region:w,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:I,aws_user_pools_id:v,aws_user_pools_web_client_id:A,geo:_,oauth:O,predictions:D,aws_cloud_logic_custom:$,Notifications:j,modelIntrospection:k}=e,x={};m&&(x.Analytics={Pinpoint:{appId:m,region:E}});const{InAppMessaging:F,Push:J}=j??{};if(F!=null&&F.AWSPinpoint||J!=null&&J.AWSPinpoint){if(F!=null&&F.AWSPinpoint){const{appId:G,region:et}=F.AWSPinpoint;x.Notifications={InAppMessaging:{Pinpoint:{appId:G,region:et}}}}if(J!=null&&J.AWSPinpoint){const{appId:G,region:et}=J.AWSPinpoint;x.Notifications={...x.Notifications,PushNotification:{Pinpoint:{appId:G,region:et}}}}}if(Array.isArray(s)&&(x.Interactions={LexV1:Object.fromEntries(s.map(G=>[G.name,G]))}),r){const G=Ic[n];G||Sc.debug(`Invalid authentication type ${n}. Falling back to IAM.`),x.API={GraphQL:{endpoint:r,apiKey:t,region:i,defaultAuthMode:G??"iam"}},k&&(x.API.GraphQL.modelIntrospection=k)}const de=c?{status:c&&c.toLowerCase(),totpEnabled:(u==null?void 0:u.includes("TOTP"))??!1,smsEnabled:(u==null?void 0:u.includes("SMS"))??!1}:void 0,R=l?{minLength:l.passwordPolicyMinLength,requireLowercase:((yi=l.passwordPolicyCharacters)==null?void 0:yi.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((Ei=l.passwordPolicyCharacters)==null?void 0:Ei.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((vi=l.passwordPolicyCharacters)==null?void 0:vi.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((Si=l.passwordPolicyCharacters)==null?void 0:Si.includes("REQUIRES_SYMBOLS"))??!1}:void 0,L=Array.from(new Set([...d??[],...h??[]])).reduce((G,et)=>({...G,[et.toLowerCase()]:{required:!0}}),{}),q=(p==null?void 0:p.includes("EMAIL"))??!1,je=(p==null?void 0:p.includes("PHONE_NUMBER"))??!1;(o||v)&&(x.Auth={Cognito:{identityPoolId:o,allowGuestAccess:g!=="enable",signUpVerificationMethod:a,userAttributes:L,userPoolClientId:A,userPoolId:v,mfa:de,passwordFormat:R,loginWith:{username:!(q||je),email:q,phone:je}}});const kt=O?Object.keys(O).length>0:!1,ir=f?f.length>0:!1;if(x.Auth&&kt&&(x.Auth.Cognito.loginWith={...x.Auth.Cognito.loginWith,oauth:{...Tc(O),...ir&&{providers:bc(f)}}}),S&&(x.Storage={S3:{bucket:S,region:w,dangerouslyConnectToHttpEndpointForTesting:I}}),_){const{amazon_location_service:G}=_;x.Geo={LocationService:{maps:G.maps,geofenceCollections:G.geofenceCollections,searchIndices:G.search_indices,region:G.region}}}if($&&(x.API={...x.API,REST:$.reduce((G,et)=>{const{name:ac,endpoint:cc,region:Ti,service:bi}=et;return{...G,[ac]:{endpoint:cc,...bi?{service:bi}:void 0,...Ti?{region:Ti}:void 0}}},{})}),D){const{VoiceId:G}=((wi=(Ii=D==null?void 0:D.convert)==null?void 0:Ii.speechGenerator)==null?void 0:wi.defaults)??{};x.Predictions=G?{...D,convert:{...D.convert,speechGenerator:{...D.convert.speechGenerator,defaults:{voiceId:G}}}}:D}return x},Ci=e=>(e==null?void 0:e.split(","))??[],Tc=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:r,responseType:i})=>({domain:e,scopes:t,redirectSignIn:Ci(n),redirectSignOut:Ci(r),responseType:i}),bc=e=>e.map(t=>{const n=t.toLowerCase();return n.charAt(0).toUpperCase()+n.slice(1)}),Ac=Symbol("oauth-listener");let ln;const Nc=new Uint8Array(16);function Cc(){if(!ln&&(ln=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ln))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ln(Nc)}const te=[];for(let e=0;e<256;++e)te.push((e+256).toString(16).slice(1));function xc(e,t=0){return te[e[t+0]]+te[e[t+1]]+te[e[t+2]]+te[e[t+3]]+"-"+te[e[t+4]]+te[e[t+5]]+"-"+te[e[t+6]]+te[e[t+7]]+"-"+te[e[t+8]]+te[e[t+9]]+"-"+te[e[t+10]]+te[e[t+11]]+te[e[t+12]]+te[e[t+13]]+te[e[t+14]]+te[e[t+15]]}const Pc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),xi={randomUUID:Pc};function Rc(e,t,n){if(xi.randomUUID&&!t&&!e)return xi.randomUUID();e=e||{};const r=e.random||(e.rng||Cc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return xc(r)}function _c(e){const{version:t}=e;return t?t.startsWith("1"):!1}function kc(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:r}=e;return{S3:{bucket:t,region:n,buckets:r&&Vc(r)}}}function Oc(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:r,password_policy:i,mfa_configuration:s,mfa_methods:o,unauthenticated_identities_enabled:a,oauth:c,username_attributes:u,standard_required_attributes:l,groups:d}=e,h={Cognito:{userPoolId:t,userPoolClientId:n,groups:d}};return r&&(h.Cognito={...h.Cognito,identityPoolId:r}),i&&(h.Cognito.passwordFormat={requireLowercase:i.require_lowercase,requireNumbers:i.require_numbers,requireUppercase:i.require_uppercase,requireSpecialCharacters:i.require_symbols,minLength:i.min_length??6}),s&&(h.Cognito.mfa={status:Kc(s),smsEnabled:o==null?void 0:o.includes("SMS"),totpEnabled:o==null?void 0:o.includes("TOTP")}),a&&(h.Cognito.allowGuestAccess=a),c&&(h.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:Bc(c.identity_providers)}}),u&&(h.Cognito.loginWith={...h.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),l&&(h.Cognito.userAttributes=l.reduce((f,p)=>({...f,[p]:{required:!0}}),{})),h}function Dc(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function Lc(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:r,search_indices:i}=e;return{LocationService:{region:t,searchIndices:i,geofenceCollections:n,maps:r}}}function Mc(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:r,api_key:i,model_introspection:s}=e;return{GraphQL:{endpoint:r,defaultAuthMode:vo(n),region:t,apiKey:i,modelIntrospection:s}}}function Uc(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:n,api_key:r,default_authorization_type:i}=e.events;return{Events:{endpoint:t,defaultAuthMode:vo(i),region:n,apiKey:r}}}function Fc(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:r}=e,i=n.includes("IN_APP_MESSAGING"),s=n.includes("APNS")||n.includes("FCM");if(!(i||s))return;const o={};return i&&(o.InAppMessaging={Pinpoint:{appId:r,region:t}}),s&&(o.PushNotification={Pinpoint:{appId:r,region:t}}),o}function qc(e){const t={};if(e.storage&&(t.Storage=kc(e.storage)),e.auth&&(t.Auth=Oc(e.auth)),e.analytics&&(t.Analytics=Dc(e.analytics)),e.geo&&(t.Geo=Lc(e.geo)),e.data&&(t.API=Mc(e.data)),e.custom){const n=Uc(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=Fc(e.notifications)),t}const $c={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function vo(e){return $c[e]}const Pi={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function Bc(e=[]){return e.reduce((t,n)=>(Pi[n]!==void 0&&t.push(Pi[n]),t),[])}function Kc(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function Vc(e){const t={};return e.forEach(({name:n,bucket_name:r,aws_region:i,paths:s})=>{if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);const o=s?Object.entries(s).reduce((a,[c,u])=>(u!==void 0&&(a[c]=u),a),{}):void 0;t[n]={bucketName:r,region:i,paths:o}}),t}const So=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?wc(e):_c(e)?qc(e):e;var pr=function(e,t){return pr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},pr(e,t)};function Br(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");pr(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Io(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(l){try{u(r.next(l))}catch(d){o(d)}}function c(l){try{u(r.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((r=r.apply(e,t||[])).next())})}function Kr(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Ht(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function mr(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function lt(e){return this instanceof lt?(this.v=e,this):new lt(e)}function jc(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){r[f]&&(i[f]=function(g){return new Promise(function(m,E){s.push([f,g,m,E])>1||c(f,g)})},p&&(i[f]=p(i[f])))}function c(f,p){try{u(r[f](p))}catch(g){h(s[0][3],g)}}function u(f){f.value instanceof lt?Promise.resolve(f.value.v).then(l,d):h(s[0][2],f)}function l(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Hc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Ht=="function"?Ht(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}var he=64,Gc=32,Wc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),zc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Yc=Math.pow(2,53)-1,vn=function(){function e(){this.state=Int32Array.from(zc),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>Yc)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[n++],r--,this.bufferLength===he&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%he>=he-8){for(var i=this.bufferLength;i<he;i++)n.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(var i=this.bufferLength;i<he-8;i++)n.setUint8(i,0);n.setUint32(he-8,Math.floor(t/4294967296),!0),n.setUint32(he-4,t),this.hashBuffer(),this.finished=!0}for(var s=new Uint8Array(Gc),i=0;i<8;i++)s[i*4]=this.state[i]>>>24&255,s[i*4+1]=this.state[i]>>>16&255,s[i*4+2]=this.state[i]>>>8&255,s[i*4+3]=this.state[i]>>>0&255;return s},e.prototype.hashBuffer=function(){for(var t=this,n=t.buffer,r=t.state,i=r[0],s=r[1],o=r[2],a=r[3],c=r[4],u=r[5],l=r[6],d=r[7],h=0;h<he;h++){if(h<16)this.temp[h]=(n[h*4]&255)<<24|(n[h*4+1]&255)<<16|(n[h*4+2]&255)<<8|n[h*4+3]&255;else{var f=this.temp[h-2],p=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[h-15];var g=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(p+this.temp[h-7]|0)+(g+this.temp[h-16]|0)}var m=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&l)|0)+(d+(Wc[h]+this.temp[h]|0)|0)|0,E=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&s^i&o^s&o)|0;d=l,l=u,u=c,c=a+m|0,a=o,o=s,s=i,i=m+E|0}r[0]+=i,r[1]+=s,r[2]+=o,r[3]+=a,r[4]+=c,r[5]+=u,r[6]+=l,r[7]+=d},e}();const Jc=e=>new TextEncoder().encode(e);var Qc=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:Jc;function wo(e){return e instanceof Uint8Array?e:typeof e=="string"?Qc(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function Xc(e){return typeof e=="string"?e.length===0:e.byteLength===0}var Gt=function(){function e(t){this.secret=t,this.hash=new vn,this.reset()}return e.prototype.update=function(t){if(!(Xc(t)||this.error))try{this.hash.update(wo(t))}catch(n){this.error=n}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return Io(this,void 0,void 0,function(){return Kr(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new vn,this.secret){this.outer=new vn;var t=Zc(this.secret),n=new Uint8Array(he);n.set(t);for(var r=0;r<he;r++)t[r]^=54,n[r]^=92;this.hash.update(t),this.outer.update(n);for(var r=0;r<t.byteLength;r++)t[r]=0}},e}();function Zc(e){var t=wo(e);if(t.byteLength>he){var n=new vn;n.update(t),t=n.digest()}var r=new Uint8Array(he);return r.set(t),r}const To={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),To[e]=t}function eu(e){let t="";for(let n=0;n<e.byteLength;n++)t+=To[e[n]];return t}var z;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(z||(z={}));var kn;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(kn||(kn={}));var Ri;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(Ri||(Ri={}));var _i;(function(e){e.Record="1",e.IdentifyUser="2"})(_i||(_i={}));var yr;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(yr||(yr={}));var oe;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(oe||(oe={}));var ki;(function(e){e.Subscribe="1",e.GraphQl="2"})(ki||(ki={}));var Oi;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(Oi||(Oi={}));var Di;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(Di||(Di={}));var Li;(function(e){e.None="0"})(Li||(Li={}));var Mi;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(Mi||(Mi={}));var Ui;(function(e){e.Subscribe="1"})(Ui||(Ui={}));var Fi;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(Fi||(Fi={}));var qi;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(qi||(qi={}));const tu="6.15.0",Bn=()=>typeof global<"u",vt=()=>typeof window<"u",bo=()=>typeof document<"u",Vr=()=>typeof process<"u",Wt=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));var $i={};function nu(){const e=r=>r.startsWith("_react")||r.startsWith("__react"),t=r=>Object.keys(r).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return bo()&&n().some(t)}function ru(){return Vr()&&typeof $i<"u"&&!!Object.keys($i).find(e=>e.includes("react"))}function iu(){return vt()&&Wt(window,"__VUE")}function su(){return Bn()&&Wt(global,"__VUE")}var Bi={};function ou(){return vt()&&Wt(window,"__SVELTE")}function au(){return Vr()&&typeof Bi<"u"&&!!Object.keys(Bi).find(e=>e.includes("svelte"))}function cu(){return vt()&&window.next&&typeof window.next=="object"}function uu(){return Bn()&&(Wt(global,"__next")||Wt(global,"__NEXT"))}function lu(){return vt()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function du(){return Bn()&&typeof global.__NUXT_PATHS__<"u"}var Ki={};function hu(){const e=!!(bo()&&document.querySelector("[ng-version]")),t=!!(vt()&&typeof window.ng<"u");return e||t}function fu(){var e;return Vr()&&typeof Ki=="object"&&((e=Ki.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function pu(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function gu(){return Bn()&&typeof global.expo<"u"}function mu(){return vt()}const yu=[{platform:z.Expo,detectionMethod:gu},{platform:z.ReactNative,detectionMethod:pu},{platform:z.NextJs,detectionMethod:cu},{platform:z.Nuxt,detectionMethod:lu},{platform:z.Angular,detectionMethod:hu},{platform:z.React,detectionMethod:nu},{platform:z.VueJs,detectionMethod:iu},{platform:z.Svelte,detectionMethod:ou},{platform:z.WebUnknown,detectionMethod:mu},{platform:z.NextJsSSR,detectionMethod:uu},{platform:z.NuxtSSR,detectionMethod:du},{platform:z.ReactSSR,detectionMethod:ru},{platform:z.VueJsSSR,detectionMethod:su},{platform:z.AngularSSR,detectionMethod:fu},{platform:z.SvelteSSR,detectionMethod:au}];function Eu(){var e;return((e=yu.find(t=>t.detectionMethod()))==null?void 0:e.platform)||z.ServerSideUnknown}let Bt;const sr=[];let Er=!1;const vu=10,Su=10,Iu=1e3,Ao=()=>{var e;if(!Bt){if(Bt=Eu(),Er)for(;sr.length;)(e=sr.pop())==null||e();else sr.forEach(t=>{t()});Vi(z.ServerSideUnknown,vu),Vi(z.WebUnknown,Su)}return Bt};function wu(){Bt=void 0}function Vi(e,t){Bt===e&&!Er&&setTimeout(()=>{wu(),Er=!0,setTimeout(Ao,Iu)},t)}const Tu={},bu=(e,t)=>{var n,r;return(r=(n=Tu[e])==null?void 0:n[t])==null?void 0:r.additionalDetails},Au="aws-amplify",Nu=e=>e.replace(/\+.*/,""),Cu=({category:e,action:t}={})=>{const n=[[Au,Nu(tu)]];if(e&&n.push([e,t]),n.push(["framework",Ao()]),e&&t){const r=bu(e,t);r&&r.forEach(i=>{n.push(i)})}return n},St=e=>Cu(e).map(([r,i])=>r&&i?`${r}/${i}`:r).join(" ");function ne(e){return typeof e=="function"}function xu(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var or=xu(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function ji(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var jr=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Ht(o),c=a.next();!c.done;c=a.next()){var u=c.value;u.remove(this)}}catch(g){t={error:g}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else o.remove(this);var l=this.initialTeardown;if(ne(l))try{l()}catch(g){s=g instanceof or?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=Ht(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{Hi(p)}catch(g){s=s??[],g instanceof or?s=mr(mr([],gr(s)),gr(g.errors)):s.push(g)}}}catch(g){r={error:g}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(s)throw new or(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Hi(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&ji(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&ji(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();jr.EMPTY;function No(e){return e instanceof jr||e&&"closed"in e&&ne(e.remove)&&ne(e.add)&&ne(e.unsubscribe)}function Hi(e){ne(e)?e():e.unsubscribe()}var Pu={Promise:void 0},Ru={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,mr([e,t],gr(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Co(e){Ru.setTimeout(function(){throw e})}function Gi(){}function _u(e){e()}var Hr=function(e){Br(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,No(n)&&n.add(r)):r.destination=Du,r}return t.create=function(n,r,i){return new vr(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(jr),ku=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){dn(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){dn(r)}else dn(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){dn(n)}},e}(),vr=function(e){Br(t,e);function t(n,r,i){var s=e.call(this)||this,o;return ne(n)||!n?o={next:n??void 0,error:r??void 0,complete:i??void 0}:o=n,s.destination=new ku(o),s}return t}(Hr);function dn(e){Co(e)}function Ou(e){throw e}var Du={closed:!0,next:Gi,error:Ou,complete:Gi},Gr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Lu(e){return e}function Mu(e){return e.length===0?Lu:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var ae=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,s=Fu(t)?t:new vr(t,n,r);return _u(function(){var o=i,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?i._subscribe(s):i._trySubscribe(s))}),s},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=Wi(n),new n(function(i,s){var o=new vr({next:function(a){try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[Gr]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Mu(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=Wi(t),new t(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},e.create=function(t){return new e(t)},e}();function Wi(e){var t;return(t=e??Pu.Promise)!==null&&t!==void 0?t:Promise}function Uu(e){return e&&ne(e.next)&&ne(e.error)&&ne(e.complete)}function Fu(e){return e&&e instanceof Hr||Uu(e)&&No(e)}function qu(e){return ne(e==null?void 0:e.lift)}function Zt(e){return function(t){if(qu(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Kn(e,t,n,r,i){return new $u(e,t,n,r,i)}var $u=function(e){Br(t,e);function t(n,r,i,s,o,a){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(u){try{r(u)}catch(l){n.error(l)}}:e.prototype._next,c._error=s?function(u){try{s(u)}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=i?function(){try{i()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(Hr),xo=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Po(e){return ne(e==null?void 0:e.then)}function Ro(e){return ne(e[Gr])}function _o(e){return Symbol.asyncIterator&&ne(e==null?void 0:e[Symbol.asyncIterator])}function ko(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Bu(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Oo=Bu();function Do(e){return ne(e==null?void 0:e[Oo])}function Lo(e){return jc(this,arguments,function(){var n,r,i,s;return Kr(this,function(o){switch(o.label){case 0:n=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,lt(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,lt(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,lt(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Mo(e){return ne(e==null?void 0:e.getReader)}function Vn(e){if(e instanceof ae)return e;if(e!=null){if(Ro(e))return Ku(e);if(xo(e))return Vu(e);if(Po(e))return ju(e);if(_o(e))return Uo(e);if(Do(e))return Hu(e);if(Mo(e))return Gu(e)}throw ko(e)}function Ku(e){return new ae(function(t){var n=e[Gr]();if(ne(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Vu(e){return new ae(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function ju(e){return new ae(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Co)})}function Hu(e){return new ae(function(t){var n,r;try{for(var i=Ht(e),s=i.next();!s.done;s=i.next()){var o=s.value;if(t.next(o),t.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function Uo(e){return new ae(function(t){Wu(e,t).catch(function(n){return t.error(n)})})}function Gu(e){return Uo(Lo(e))}function Wu(e,t){var n,r,i,s;return Io(this,void 0,void 0,function(){var o,a;return Kr(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=Hc(e),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function tt(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function Fo(e,t){return t===void 0&&(t=0),Zt(function(n,r){n.subscribe(Kn(r,function(i){return tt(r,e,function(){return r.next(i)},t)},function(){return tt(r,e,function(){return r.complete()},t)},function(i){return tt(r,e,function(){return r.error(i)},t)}))})}function qo(e,t){return t===void 0&&(t=0),Zt(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function zu(e,t){return Vn(e).pipe(qo(t),Fo(t))}function Yu(e,t){return Vn(e).pipe(qo(t),Fo(t))}function Ju(e,t){return new ae(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Qu(e,t){return new ae(function(n){var r;return tt(n,t,function(){r=e[Oo](),tt(n,t,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return ne(r==null?void 0:r.return)&&r.return()}})}function $o(e,t){if(!e)throw new Error("Iterable cannot be null");return new ae(function(n){tt(n,t,function(){var r=e[Symbol.asyncIterator]();tt(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Xu(e,t){return $o(Lo(e),t)}function Zu(e,t){if(e!=null){if(Ro(e))return zu(e,t);if(xo(e))return Ju(e,t);if(Po(e))return Yu(e,t);if(_o(e))return $o(e,t);if(Do(e))return Qu(e,t);if(Mo(e))return Xu(e,t)}throw ko(e)}function el(e,t){return t?Zu(e,t):Vn(e)}function Wr(e,t){return Zt(function(n,r){var i=0;n.subscribe(Kn(r,function(s){r.next(e.call(t,s,i++))}))})}function tl(e,t){return Zt(function(n,r){var i=0;n.subscribe(Kn(r,function(s){return e.call(t,s,i++)&&r.next(s)}))})}function Bo(e){return Zt(function(t,n){var r=null,i=!1,s;r=t.subscribe(Kn(n,void 0,void 0,function(o){s=Vn(e(o,Bo(e)(t))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}const nl=()=>{if(typeof self>"u")return!1;const e=self;return typeof e.WorkerGlobalScope<"u"&&self instanceof e.WorkerGlobalScope};class dt{networkMonitor(t){const n=nl()?self:typeof window<"u"&&window;return n?new ae(r=>{r.next({online:n.navigator.onLine});const i=()=>{r.next({online:!0})},s=()=>{r.next({online:!1})};return n.addEventListener("online",i),n.addEventListener("offline",s),dt._observers.push(r),()=>{n.removeEventListener("online",i),n.removeEventListener("offline",s),dt._observers=dt._observers.filter(o=>o!==r)}}):el([{online:!0}])}static _observerOverride(t){for(const n of this._observers){if(n.closed){this._observers=this._observers.filter(r=>r!==n);continue}n!=null&&n.next&&n.next(t)}}}dt._observers=[];const Ko=()=>typeof window<"u"&&typeof window.document<"u",zi=new X("Auth");class rl{configure(t,n){var r,i;this.authConfig=t,this.authOptions=n,t&&((r=t.Cognito)!=null&&r.userPoolEndpoint)&&zi.warn(Yi("Amazon Cognito User Pool")),t&&((i=t.Cognito)!=null&&i.identityPoolEndpoint)&&zi.warn(Yi("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var s,o,a,c,u,l;let n,r;const i=await this.getTokens(t);return i?(r=(o=(s=i.accessToken)==null?void 0:s.payload)==null?void 0:o.sub,n=await((c=(a=this.authOptions)==null?void 0:a.credentialsProvider)==null?void 0:c.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:i,authenticated:!0,forceRefresh:t.forceRefresh}))):n=await((l=(u=this.authOptions)==null?void 0:u.credentialsProvider)==null?void 0:l.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:i,credentials:n==null?void 0:n.credentials,identityId:n==null?void 0:n.identityId,userSub:r}}async clearCredentials(){var t,n;await((n=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:n.clearCredentialsAndIdentityId())}async getTokens(t){var n,r;return await((r=(n=this.authOptions)==null?void 0:n.tokenProvider)==null?void 0:r.getTokens(t))??void 0}}const Yi=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class il{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new rl}configure(t,n){const r=So(t);this.resourcesConfig=r,n&&(this.libraryOptions=n),this.resourcesConfig=Eo(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Qe.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",Je),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[Ac](t){var n,r,i;(r=(n=this.resourcesConfig.Auth)==null?void 0:n.Cognito.loginWith)!=null&&r.oauth?t((i=this.resourcesConfig.Auth)==null?void 0:i.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,n,r;!((n=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&n.oauth)||!this.oAuthListener||(this.oAuthListener((r=this.resourcesConfig.Auth)==null?void 0:r.Cognito),this.oAuthListener=void 0)}}const K=new il,sl=(e,t)=>e.Auth.fetchAuthSession(t),zr=e=>sl(K,e);function Vo(){return K.Auth.clearCredentials()}const jn=e=>{const{headers:t,statusCode:n}=e;return{...ol(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},ol=e=>typeof(e==null?void 0:e.$metadata)=="object",ot=async e=>{if(!e||e.statusCode<300)return;const t=await en(e),r=(o=>{const[a]=o.toString().split(/[,:]+/);return a.includes("#")?a.split("#")[1]:a})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),i=t.message??t.Message??"Unknown error",s=new Error(i);return Object.assign(s,{name:r,$metadata:jn(e)})},en=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:jn(e)})},Ee=(e,t,n,r)=>async(i,s)=>{const o={...r,...i},a=await o.endpointResolver(o,s),c=await t(s,a),u=await e(c,{...o});return n(u)},jo=5*60*1e3;function Ho(e=jo){return r=>{const i=2**r*100+100*Math.random();return i>e?!1:i}}const Go=3,Ji="amz-sdk-invocation-id",al="amz-sdk-request",Qi=5*60*1e3,Yr=e=>{const n=Ho(Qi)(e);return n===!1?Qi:n},cl=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],ul=e=>!!e&&cl.includes(e),Jr=e=>async(t,n)=>{const r=n??await e(t)??void 0,i=(r==null?void 0:r.code)||(r==null?void 0:r.name),s=t==null?void 0:t.statusCode;return{retryable:fl(n)||hl(s,i)||ul(i)||pl(s,i)}},ll=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],dl=["TimeoutError","RequestTimeout","RequestTimeoutException"],hl=(e,t)=>e===429||!!t&&ll.includes(t),fl=e=>[Ye.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),pl=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&dl.includes(t),Wo="cognito-identity",zo={service:Wo,retryDecider:Jr(ot),computeDelay:Yr,cache:"no-store"},Qr=({maxAttempts:e=Go,retryDecider:t,computeDelay:n,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(i,s)=>async function(a){let c,u=s.attemptsCount??0,l;const d=()=>{if(l)return Xi(l,u),l;throw Xi(c,u),c};for(;!(r!=null&&r.aborted)&&u<e;){try{l=await i(a),c=void 0}catch(p){c=p,l=void 0}u=(s.attemptsCount??0)>u?s.attemptsCount??0:u+1,s.attemptsCount=u;const{isCredentialsExpiredError:h,retryable:f}=await t(l,c,s);if(f){if(s.isCredentialsExpired=!!h,!(r!=null&&r.aborted)&&u<e){const p=n(u);await gl(p,r)}continue}else return d()}if(r!=null&&r.aborted)throw new Error("Request aborted.");return d()}},gl=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let n,r;const i=new Promise(s=>{r=s,n=setTimeout(s,e)});return t==null||t.addEventListener("abort",function s(o){clearTimeout(n),t==null||t.removeEventListener("abort",s),r()}),i},Xi=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},Sr=Rc,ml=()=>e=>async function(n){return n.headers[Ji]||(n.headers[Ji]=Sr()),e(n)},yl=({maxAttempts:e=Go})=>(t,n)=>async function(i){const s=n.attemptsCount??0;return i.headers[al]=`attempt=${s+1}; max=${e}`,t(i)},Xr=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(i){if(t.trim().length===0)return await n(i);{const s=e.toLowerCase();return i.headers[s]=i.headers[s]?`${i.headers[s]} ${t}`:t,await n(i)}},tn=(e,t)=>(n,r)=>{const i={};let s=o=>e(o,r);for(let o=t.length-1;o>=0;o--){const a=t[o];s=a(r)(s,i)}return s(n)},ar=e=>{let t;return()=>(t||(t=e()),t)},El=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),Zr=async({url:e,method:t,headers:n,body:r},{abortSignal:i,cache:s,withCrossDomainCredentials:o})=>{var d;let a;try{a=await fetch(e,{method:t,headers:n,body:El(t)?r:void 0,signal:i,cache:s,credentials:o?"include":"same-origin"})}catch(h){throw h instanceof TypeError?new re({name:Ye.NetworkError,message:"A network error has occurred.",underlyingError:h}):h}const c={};(d=a.headers)==null||d.forEach((h,f)=>{c[f.toLowerCase()]=h});const u={statusCode:a.status,headers:c,body:null},l=Object.assign(a.body??{},{text:ar(()=>a.text()),blob:ar(()=>a.blob()),json:ar(()=>a.json())});return{...u,body:l}},Yo=tn(Zr,[Xr,ml,Qr,yl]),vl=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},Jo=tn(Yo,[vl]),Qo=e=>(t,n)=>{const r=Sl(e),i=JSON.stringify(t);return Il(n,r,i)},Sl=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),Il=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),Zi=e=>Ee(Jo,Qo("GetCredentialsForIdentity"),wl,{...zo,...e,userAgentValue:St()}),wl=async e=>{if(e.statusCode>=300)throw await ot(e);const t=await en(e);return{IdentityId:t.IdentityId,Credentials:Tl(t.Credentials),$metadata:jn(e)}},Tl=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),bl=e=>Ee(Jo,Qo("GetId"),Al,{...zo,...e,userAgentValue:St()}),Al=async e=>{if(e.statusCode>=300)throw await ot(e);return{IdentityId:(await en(e)).IdentityId,$metadata:jn(e)}},Xo={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Nl={partitions:[Xo,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Zo=e=>{const{partitions:t}=Nl;for(const{regions:n,outputs:r,regionRegex:i}of t){const s=new RegExp(i);if(n.includes(e)||s.test(e))return r.dnsSuffix}return Xo.outputs.dnsSuffix},Pe=URL,ea=URLSearchParams,Cl=({region:e})=>({url:new Pe(`https://${Wo}.${e}.${Zo(e)}`)});class Ut extends re{constructor(){super({name:Ye.PlatformNotSupported,message:"Function not supported on current platform"})}}class ta{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new Ut;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new Ut;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new Ut;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new Ut;this.storage.clear()}}class na{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const ra=new X("CoreStorageUtils"),xl=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{ra.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new na},ia=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return ra.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new na}};class Pl extends ta{constructor(){super(xl())}}class Rl extends ta{constructor(){super(ia())}}class _l{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new Ut;return this._storage}setItem(t,n){this.storage.setItem(t,n)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class kl extends _l{constructor(){super(ia())}}/*! js-cookie v3.0.5 | MIT */function hn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var Ol={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Ir(e,t){function n(i,s,o){if(!(typeof document>"u")){o=hn({},t,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in o)o[c]&&(a+="; "+c,o[c]!==!0&&(a+="="+o[c].split(";")[0]));return document.cookie=i+"="+e.write(s,i)+a}}function r(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},a=0;a<s.length;a++){var c=s[a].split("="),u=c.slice(1).join("=");try{var l=decodeURIComponent(c[0]);if(o[l]=e.read(u,l),i===l)break}catch{}}return i?o[i]:o}}return Object.create({set:n,get:r,remove:function(i,s){n(i,"",hn({},s,{expires:-1}))},withAttributes:function(i){return Ir(this.converter,hn({},this.attributes,i))},withConverter:function(i){return Ir(hn({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var fn=Ir(Ol,{path:"/"});class Dl{constructor(t={}){const{path:n,domain:r,expires:i,sameSite:s,secure:o}=t;if(this.domain=r,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?i:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?o:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!s||!["strict","lax","none"].includes(s))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(s==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=s}}async setItem(t,n){fn.set(t,n,this.getData())}async getItem(t){return fn.get(t)??null}async removeItem(t){fn.remove(t,this.getData())}async clear(){const t=fn.get(),n=Object.keys(t).map(r=>this.removeItem(r));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const nn=new Pl;new Rl;const Me=new kl,sa=e=>Object.keys(e).map(t=>t.toLowerCase()).sort().join(";"),Ll="X-Amz-Date",Ml="X-Amz-Security-Token",Ul="authorization",Fl="host",ql=Ll.toLowerCase(),$l=Ml.toLowerCase(),oa="aws4_request",aa="AWS4-HMAC-SHA256",Bl="AWS4",Kl="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",Vl="UNSIGNED-PAYLOAD",jl=(e,t,n)=>`${e}/${t}/${n}/${oa}`,Hl=e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}},Gl=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:r,uriEscapePath:i=!0})=>{const{accessKeyId:s,secretAccessKey:o,sessionToken:a}=e,{longDate:c,shortDate:u}=Hl(t),l=jl(u,n,r);return{accessKeyId:s,credentialScope:l,longDate:c,secretAccessKey:o,sessionToken:a,shortDate:u,signingRegion:n,signingService:r,uriEscapePath:i}},Ft=(e,t)=>{const n=new Gt(e??void 0);return n.update(t),n.digestSync()},wr=(e,t)=>{const n=Ft(e,t);return eu(n)},Wl=e=>Object.entries(e).map(([t,n])=>({key:t.toLowerCase(),value:(n==null?void 0:n.trim().replace(/\s+/g," "))??""})).sort((t,n)=>t.key<n.key?-1:1).map(t=>`${t.key}:${t.value}
`).join(""),zl=e=>Array.from(e).sort(([t,n],[r,i])=>t===r?n<i?-1:1:t<r?-1:1).map(([t,n])=>`${es(t)}=${es(n)}`).join("&"),es=e=>encodeURIComponent(e).replace(/[!'()*]/g,Yl),Yl=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,Jl=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",Ql=e=>e==null?Kl:Xl(e)?wr(null,e):Vl,Xl=e=>typeof e=="string"||ArrayBuffer.isView(e)||Zl(e),Zl=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]",ed=({body:e,headers:t,method:n,url:r},i=!0)=>[n,Jl(r.pathname,i),zl(r.searchParams),Wl(t),sa(t),Ql(e)].join(`
`),td=(e,t,n,r)=>{const i=`${Bl}${e}`,s=Ft(i,t),o=Ft(s,n),a=Ft(o,r);return Ft(a,oa)},nd=(e,t,n)=>[aa,e,t,n].join(`
`),rd=(e,{credentialScope:t,longDate:n,secretAccessKey:r,shortDate:i,signingRegion:s,signingService:o,uriEscapePath:a})=>{const c=ed(e,a),u=wr(null,c),l=nd(n,t,u);return wr(td(r,i,s,o),l)},ca=(e,t)=>{const n=Gl(t),{accessKeyId:r,credentialScope:i,longDate:s,sessionToken:o}=n,a={...e.headers};a[Fl]=e.url.host,a[ql]=s,o&&(a[$l]=o);const c={...e,headers:a},u=rd(c,n),l=`Credential=${r}/${i}`,d=`SignedHeaders=${sa(a)}`,h=`Signature=${u}`;return a[Ul]=`${aa} ${l}, ${d}, ${h}`,c},ua=e=>new Date(Date.now()+e),id=5*60*1e3,sd=(e,t)=>Math.abs(ua(t).getTime()-e)>=id,od=(e,t)=>sd(e,t)?e-Date.now():t,ad=({credentials:e,region:t,service:n,uriEscapePath:r=!0})=>{let i;return(s,o)=>async function(c){i=i??0;const u={credentials:typeof e=="function"?await e({forceRefresh:!!(o!=null&&o.isCredentialsExpired)}):e,signingDate:ua(i),signingRegion:t,signingService:n,uriEscapePath:r},l=await ca(c,u),d=await s(l),h=cd(d);return h&&(i=od(Date.parse(h),i)),d}},cd=({headers:e}={})=>(e==null?void 0:e.date)??(e==null?void 0:e.Date)??(e==null?void 0:e["x-amz-date"]);class ud extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}const ld=(e,t,n=jo,r)=>vc(e,t,Ho(n)),dd=e=>{let t;return async(...n)=>t||(t=new Promise((r,i)=>{e(...n).then(s=>{r(s)}).catch(s=>{i(s)}).finally(()=>{t=void 0})}),t)};function ts({expiresAt:e,clockDrift:t,tolerance:n=5e3}){return Date.now()+t+n>e}const hd=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:r="",architecture:i="",fullVersionList:s=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),o=s.map(c=>`${c.brand}/${c.version}`).join(";");return[t,n,i,r,t,o].filter(c=>c).join(" ")||navigator.userAgent};class On extends re{get response(){return this._response?fd(this._response):void 0}constructor(t){super(t),this.constructor=On,Object.setPrototypeOf(this,On.prototype),t.response&&(this._response=t.response)}}const fd=e=>({...e,headers:{...e.headers}});function pd(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const pt={convert(e,t={urlSafe:!1,skipPadding:!1}){const n=typeof e=="string"?e:pd(e);let r=mc()(n);return t.urlSafe&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(r=r.replace(/=/g,"")),r}};function gd(){return gc().getRandomValues(new Uint32Array(1))[0]}function md(e){const{words:t}=e,{sigBytes:n}=e,r=[];for(let i=0;i<n;i++){const s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((s&15).toString(16))}return r.join("")}class ei{constructor(t,n){this.words=[];let r=t;r=this.words=r||[],n!==void 0?this.sigBytes=n:this.sigBytes=r.length*4}random(t){const n=[];for(let r=0;r<t;r+=4)n.push(gd());return new ei(n,t)}toString(){return md(this)}}var P;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"})(P||(P={}));const la={[P.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[P.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[P.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[P.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[P.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[P.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[P.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[P.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[P.EmptySignInPassword]:{message:"password is required to signIn"},[P.EmptySignInUsername]:{message:"username is required to signIn"},[P.EmptySignUpPassword]:{message:"password is required to signUp"},[P.EmptySignUpUsername]:{message:"username is required to signUp"},[P.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[P.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[P.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[P.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[P.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var ns;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(ns||(ns={}));var gt;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(gt||(gt={}));class C extends re{constructor(t){super(t),this.constructor=C,Object.setPrototypeOf(this,C.prototype)}}function Y(e,t){const{message:n,recoverySuggestion:r}=la[t];if(!e)throw new C({name:t,message:n,recoverySuggestion:r})}function Z(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new C({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function Tr(e){if(!e||!e.includes(":"))throw new C({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function rs(e){return Object.entries(e).map(([t,n])=>({Name:t,Value:n}))}var is;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(is||(is={}));var ss;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ss||(ss={}));var os;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(os||(os={}));var as;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(as||(as={}));var cs;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(cs||(cs={}));var us;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(us||(us={}));var ls;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ls||(ls={}));var ds;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ds||(ds={}));var hs;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(hs||(hs={}));var fs;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(fs||(fs={}));var ps;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(ps||(ps={}));var gs;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(gs||(gs={}));var ms;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ms||(ms={}));var ys;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(ys||(ys={}));var Dn;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Dn||(Dn={}));var Es;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(Es||(Es={}));var vs;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(vs||(vs={}));var Ss;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ss||(Ss={}));var br;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(br||(br={}));var Is;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Is||(Is={}));var ws;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ws||(ws={}));var Ts;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ts||(Ts={}));var bs;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(bs||(bs={}));var As;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(As||(As={}));const Hn="UserUnAuthenticatedException",yd="UserAlreadyAuthenticatedException",Ed="DeviceMetadataNotFoundException",vd="InvalidRedirectException",Sd="InvalidAppSchemeException",Id="InvalidPreferredRedirectUrlException",wd=new C({name:vd,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new C({name:Sd,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new C({name:Id,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const Td="InvalidOriginException",bd=new C({name:Td,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),Ad="OAuthSignOutException",Nd="TokenRefreshException",Cd="UnexpectedSignInInterruptionException";function xd(e){if(!e||!e.accessToken)throw new C({name:Hn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function Pd(e){if(!e||!e.idToken)throw new C({name:Hn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Rd=new C({name:Nd,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),_d=new C({name:Hn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function da(e){if(Dd(e))throw Rd;if(!Od(e))throw _d}function ha(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new C({name:Ed,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const kd={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function fa(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function Od(e){return fa(e)&&(e==null?void 0:e.refreshToken)}function Dd(e){return fa(e)&&!(e!=null&&e.refreshToken)}const Ld=async e=>{var a,c;const t=(a=e.getConfig().Auth)==null?void 0:a.Cognito;M(t);const n=await e.Auth.getTokens({forceRefresh:!1});xd(n);const{"cognito:username":r,sub:i}=((c=n.idToken)==null?void 0:c.payload)??{},s={username:r,userId:i},o=Md(n);return o&&(s.signInDetails=o),s};function Md(e){return e==null?void 0:e.signInDetails}const Kt=async()=>Ld(K),ve=(e,t)=>St({category:kn.Auth,action:e,...t}),_e=e=>(t,n)=>{const r=Ud(e),i=JSON.stringify(t);return Fd(n,r,i)},Ud=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),Fd=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function Te(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new C({name:Ye.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const Ke=()=>async e=>{if(e.statusCode>=300){const t=await ot(e);throw Te(t),new C({name:t.name,message:t.message,metadata:t.$metadata})}return en(e)},qd=()=>(e,t)=>async function(r){return r.headers["cache-control"]="no-store",e(r)},ke=tn(Yo,[qd]),pa="cognito-idp",Oe={service:pa,retryDecider:Jr(ot),computeDelay:Yr,userAgentValue:St(),cache:"no-store"},It=e=>Ee(ke,_e("InitiateAuth"),Ke(),{...Oe,...e}),Gn=e=>Ee(ke,_e("RespondToAuthChallenge"),Ke(),{...Oe,...e}),$d=e=>Ee(ke,_e("AssociateSoftwareToken"),Ke(),{...Oe,...e}),Bd=({region:e})=>({url:new Pe(`https://${pa}.${e}.${Zo(e)}`)}),ee=({endpointOverride:e})=>t=>e?{url:new Pe(e)}:Bd(t);function le({username:e,userPoolId:t,userPoolClientId:n}){if(typeof window>"u")return;const r=window.AmazonCognitoAdvancedSecurityData;if(typeof r>"u")return;const i=r.getData(e,t,n);return i?{EncodedData:i}:{}}const Kd=async({tokens:e,authConfig:t,username:n})=>{var m;M(t==null?void 0:t.Cognito);const{userPoolId:r,userPoolClientId:i,userPoolEndpoint:s}=t.Cognito,o=Z(r);da(e);const a=e.refreshToken,c={REFRESH_TOKEN:a};(m=e.deviceMetadata)!=null&&m.deviceKey&&(c.DEVICE_KEY=e.deviceMetadata.deviceKey);const u=le({username:n,userPoolId:r,userPoolClientId:i}),l=It({endpointResolver:ee({endpointOverride:s})}),{AuthenticationResult:d}=await l({region:o},{ClientId:i,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:c,UserContextData:u}),h=nt((d==null?void 0:d.AccessToken)??""),f=d!=null&&d.IdToken?nt(d.IdToken):void 0,{iat:p}=h.payload;if(!p)throw new C({name:"iatNotFoundException",message:"iat not found in access token"});const g=p*1e3-new Date().getTime();return{accessToken:h,idToken:f,clockDrift:g,refreshToken:a,username:n}},Vd=dd(Kd),jd={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var Ln;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(Ln||(Ln={}));const Hd={[Ln.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},Gd=Fr(Hd),Ns="CognitoIdentityServiceProvider";class Wd{getKeyValueStorage(){if(!this.keyValueStorage)throw new C({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new C({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const r=nt(n),i=await this.getKeyValueStorage().getItem(t.idToken),s=i?nt(i):void 0,o=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,a=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(a),u=await this.getKeyValueStorage().getItem(t.signInDetails),l={accessToken:r,idToken:s,refreshToken:o,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return u&&(l.signInDetails=JSON.parse(u)),l}catch{return null}}async storeTokens(t){Gd(t!==void 0,Ln.InvalidAuthTokens);const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const r=await this.getAuthKeys();await this.getKeyValueStorage().setItem(r.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(r.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(r.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(r.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(r.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(r.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(r.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(r.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(r.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(r.signInDetails),await this.getKeyValueStorage().setItem(r.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),r=await this.getKeyValueStorage().getItem(n.deviceKey),i=await this.getKeyValueStorage().getItem(n.deviceGroupKey),s=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return s&&i&&r?{deviceKey:r,deviceGroupKey:i,randomPassword:s}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){var r;M((r=this.authConfig)==null?void 0:r.Cognito);const n=t??await this.getLastAuthUser();return zd(Ns,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){var n;M((n=this.authConfig)==null?void 0:n.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${Ns}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:n}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t);return n&&JSON.parse(n)}}const zd=(e,t)=>ti(jd)(`${e}`,t);function ti(e){const t=Object.values({...e});return(n,r)=>t.reduce((i,s)=>({...i,[s]:`${n}.${r}.${s}`}),{})}const Cs="amplify-signin-with-hostedUI",Ae="CognitoIdentityServiceProvider";class ga{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){M(this.cognitoConfig);const t=Ne(Ae,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){M(this.cognitoConfig);const t=Ne(Ae,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(Cs),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){M(this.cognitoConfig);const t=Ne(Ae,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){M(this.cognitoConfig);const n=Ne(Ae,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){M(this.cognitoConfig);const t=Ne(Ae,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){M(this.cognitoConfig);const n=Ne(Ae,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){M(this.cognitoConfig);const t=Ne(Ae,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){M(this.cognitoConfig);const n=Ne(Ae,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var s;M(this.cognitoConfig);const t=Ne(Ae,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(Cs),[r,i]=((s=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:s.split(","))??[];return{isOAuthSignIn:r==="true"||n==="true",preferPrivateSession:i==="true"}}async storeOAuthSignIn(t,n=!1){M(this.cognitoConfig);const r=Ne(Ae,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(r.oauthSignIn,`${t},${n}`)}}const Ne=(e,t)=>ti(kd)(e,t),xs=new ga(nn);class Yd{constructor(){this.waitForInflightOAuth=Ko()?async()=>{if(await xs.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){xs.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new C({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new C({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){var o,a,c,u,l;let n;try{M((o=this.authConfig)==null?void 0:o.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const r=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const i=!!(n!=null&&n.idToken)&&ts({expiresAt:(((c=(a=n.idToken)==null?void 0:a.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:n.clockDrift??0}),s=ts({expiresAt:(((l=(u=n.accessToken)==null?void 0:u.payload)==null?void 0:l.exp)??0)*1e3,clockDrift:n.clockDrift??0});return(t!=null&&t.forceRefresh||i||s)&&(n=await this.refreshTokens({tokens:n,username:r}),n===null)?null:{accessToken:n==null?void 0:n.accessToken,idToken:n==null?void 0:n.idToken,signInDetails:n==null?void 0:n.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:r}=t,i=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return i.signInDetails=r,await this.setTokens({tokens:i}),Qe.dispatch("auth",{event:"tokenRefresh"},"Auth",Je),i}catch(r){return this.handleErrors(r)}}handleErrors(t){if(Te(t),t.name!==Ye.NetworkError&&this.clearTokens(),Qe.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",Je),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class Jd{constructor(){this.authTokenStore=new Wd,this.authTokenStore.setKeyValueStorage(nn),this.tokenOrchestrator=new Yd,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(Vd)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const qt=new Jd,{tokenOrchestrator:ye}=qt;async function wt(e){if(e.AccessToken){const t=nt(e.AccessToken),n=(t.payload.iat||0)*1e3,r=new Date().getTime(),i=n>0?n-r:0;let s,o,a;e.RefreshToken&&(o=e.RefreshToken),e.IdToken&&(s=nt(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(a=e.NewDeviceMetadata);const c={accessToken:t,idToken:s,refreshToken:o,clockDrift:i,deviceMetadata:a,username:e.username};e!=null&&e.signInDetails&&(c.signInDetails=e.signInDetails),await ye.setTokens({tokens:c})}else throw new re({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const Qd="Unable to get user session following successful sign-in.",Tt=async()=>{try{Qe.dispatch("auth",{event:"signedIn",data:await Kt()},"Auth",Je)}catch(e){throw e.name===Hn?new C({name:Cd,message:Qd,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function ma(){return{active:!1}}const Xd=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return ma();default:return e}},Zd=e=>{let t=e(ma(),{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},He=Zd(Xd),eh=3*60*1e3,pn="CognitoSignInState",Ue={username:`${pn}.username`,challengeName:`${pn}.challengeName`,signInSession:`${pn}.signInSession`,expiry:`${pn}.expiry`},th=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return gn({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return gn(t.value),{...t.value};case"SET_CHALLENGE_NAME":return gn({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return gn({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return rh();case"RESET_STATE":return ya(),ni();default:return e}},nh=e=>{const t=Number(e),n=Date.now();return t<=n},Re=()=>{Xe.dispatch({type:"RESET_STATE"})},ya=()=>{for(const e of Object.values(Ue))Me.removeItem(e)},ni=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),rh=()=>{const e=Me.getItem(Ue.expiry);if(!e||nh(e))return ya(),ni();const t=Me.getItem(Ue.username)??void 0,n=Me.getItem(Ue.challengeName)??void 0,r=Me.getItem(Ue.signInSession)??void 0;return{username:t,challengeName:n,signInSession:r}},ih=e=>{let t=e(ni(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},Xe=ih(th);function bt(e){Xe.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const gn=({challengeName:e,signInSession:t,username:n})=>{n&&Me.setItem(Ue.username,n),e&&Me.setItem(Ue.challengeName,e),t&&(Me.setItem(Ue.signInSession,t),Me.setItem(Ue.expiry,String(Date.now()+eh)))};class Fe extends re{constructor(t){super(t),this.constructor=Fe,Object.setPrototypeOf(this,Fe.prototype)}}var W;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(W||(W={}));const Ps="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",cr="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",Rs="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",Mn={[W.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:Ps},[W.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:Rs},[W.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:Rs},[W.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:Ps},[W.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[W.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[W.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:cr},[W.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:cr},[W.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:cr},[W.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},ri=Fr(Mn,Fe),sh=e=>{if(e instanceof Fe)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:n}=Mn[W.PasskeyAuthenticationCanceled];return new Fe({name:W.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return oh(e)},oh=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:n}=Mn[W.PasskeyOperationAborted];return new Fe({name:W.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:n}=Mn[W.RelyingPartyMismatch];return new Fe({name:W.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new Fe({name:Ye.Unknown,message:"An unknown error has occurred.",underlyingError:e})},ah=()=>Ko()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",Dt=e=>pt.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),_s=e=>Uint8Array.from(qr.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,ch=e=>{const t=_s(e.challenge),n=(e.allowCredentials||[]).map(r=>({...r,id:_s(r.id)}));return{...e,challenge:t,allowCredentials:n}},uh=e=>{const t={clientDataJSON:Dt(e.response.clientDataJSON),authenticatorData:Dt(e.response.authenticatorData),signature:Dt(e.response.signature)};e.response.userHandle&&(t.userHandle=Dt(e.response.userHandle));const n={id:e.id,rawId:Dt(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n};function lh(e){ri(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,W.PasskeyRetrievalFailed)}const dh=async e=>{try{const t=ah();ri(t,W.PasskeyNotSupported);const n=ch(e),r=await navigator.credentials.get({publicKey:n});return lh(r),uh(r)}catch(t){throw sh(t)}},hh=e=>Ee(ke,_e("ConfirmDevice"),Ke(),{...Oe,...e}),Sn={convert(e){return new TextEncoder().encode(e)}};function T(e,t){e!=null&&this.fromString(e,t)}function se(){return new T(null,null)}let ze;const fh=0xdeadbeefcafe,ks=(fh&16777215)===15715070;function ph(e,t,n,r,i,s){for(;--s>=0;){const o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=o&67108863}return i}function gh(e,t,n,r,i,s){const o=t&32767,a=t>>15;for(;--s>=0;){let c=this[e]&32767;const u=this[e++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+n[r]+(i&1073741823),i=(c>>>30)+(l>>>15)+a*u+(i>>>30),n[r++]=c&1073741823}return i}function mh(e,t,n,r,i,s){const o=t&16383,a=t>>14;for(;--s>=0;){let c=this[e]&16383;const u=this[e++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+n[r]+i,i=(c>>28)+(l>>14)+a*u,n[r++]=c&268435455}return i}const Os=typeof navigator<"u";Os&&ks&&navigator.appName==="Microsoft Internet Explorer"?(T.prototype.am=gh,ze=30):Os&&ks&&navigator.appName!=="Netscape"?(T.prototype.am=ph,ze=26):(T.prototype.am=mh,ze=28);T.prototype.DB=ze;T.prototype.DM=(1<<ze)-1;T.prototype.DV=1<<ze;const ii=52;T.prototype.FV=Math.pow(2,ii);T.prototype.F1=ii-ze;T.prototype.F2=2*ze-ii;const yh="0123456789abcdefghijklmnopqrstuvwxyz",Wn=[];let At,me;At=48;for(me=0;me<=9;++me)Wn[At++]=me;At=97;for(me=10;me<36;++me)Wn[At++]=me;At=65;for(me=10;me<36;++me)Wn[At++]=me;function Ds(e){return yh.charAt(e)}function Eh(e,t){const n=Wn[e.charCodeAt(t)];return n??-1}function vh(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function Sh(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function si(e){const t=se();return t.fromInt(e),t}function Ih(e,t){let n;if(t===16)n=4;else if(t===8)n=3;else if(t===2)n=1;else if(t===32)n=5;else if(t===4)n=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let r=e.length,i=!1,s=0;for(;--r>=0;){const o=Eh(e,r);if(o<0){e.charAt(r)==="-"&&(i=!0);continue}i=!1,s===0?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=n,s>=this.DB&&(s-=this.DB)}this.clamp(),i&&T.ZERO.subTo(this,this)}function wh(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function Th(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const n=(1<<t)-1;let r,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(i=!0,s=Ds(r));o>=0;)a<t?(r=(this[o]&(1<<a)-1)<<t-a,r|=this[--o]>>(a+=this.DB-t)):(r=this[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(i=!0),i&&(s+=Ds(r));return i?s:"0"}function bh(){const e=se();return T.ZERO.subTo(this,e),e}function Ah(){return this.s<0?this.negate():this}function Nh(e){let t=this.s-e.s;if(t!=0)return t;let n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this[n]-e[n])!=0)return t;return 0}function oi(e){let t=1,n;return(n=e>>>16)!==0&&(e=n,t+=16),(n=e>>8)!==0&&(e=n,t+=8),(n=e>>4)!==0&&(e=n,t+=4),(n=e>>2)!==0&&(e=n,t+=2),(n=e>>1)!==0&&(e=n,t+=1),t}function Ch(){return this.t<=0?0:this.DB*(this.t-1)+oi(this[this.t-1]^this.s&this.DM)}function xh(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function Ph(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function Rh(e,t){const n=e%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(e/this.DB);let o=this.s<<n&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>r|o,o=(this[a]&i)<<n;for(a=s-1;a>=0;--a)t[a]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function _h(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}const r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(let o=n+1;o<this.t;++o)t[o-n-1]|=(this[o]&s)<<i,t[o-n]=this[o]>>r;r>0&&(t[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function kh(e,t){let n=0,r=0;const i=Math.min(e.t,this.t);for(;n<i;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()}function Oh(e,t){const n=this.abs(),r=e.abs();let i=n.t;for(t.t=i+r.t;--i>=0;)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&T.ZERO.subTo(t,t)}function Dh(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function Lh(e,t,n){const r=e.abs();if(r.t<=0)return;const i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n===null&&(n=se());const s=se(),o=this.s,a=e.s,c=this.DB-oi(r[r.t-1]);c>0?(r.lShiftTo(c,s),i.lShiftTo(c,n)):(r.copyTo(s),i.copyTo(n));const u=s.t,l=s[u-1];if(l===0)return;const d=l*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),h=this.FV/d,f=(1<<this.F1)/d,p=1<<this.F2;let g=n.t,m=g-u;const E=t===null?se():t;for(s.dlShiftTo(m,E),n.compareTo(E)>=0&&(n[n.t++]=1,n.subTo(E,n)),T.ONE.dlShiftTo(u,E),E.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--m>=0;){let S=n[--g]===l?this.DM:Math.floor(n[g]*h+(n[g-1]+p)*f);if((n[g]+=s.am(0,S,n,m,0,u))<S)for(s.dlShiftTo(m,E),n.subTo(E,n);n[g]<--S;)n.subTo(E,n)}t!==null&&(n.drShiftTo(u,t),o!==a&&T.ZERO.subTo(t,t)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),o<0&&T.ZERO.subTo(n,n)}function Mh(e){const t=se();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(T.ZERO)>0&&e.subTo(t,t),t}function Uh(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Fh(e){return this.compareTo(e)===0}function qh(e,t){let n=0,r=0;const i=Math.min(e.t,this.t);for(;n<i;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()}function $h(e){const t=se();return this.addTo(e,t),t}function Bh(e){const t=se();return this.subTo(e,t),t}function Kh(e){const t=se();return this.multiplyTo(e,t),t}function Vh(e){const t=se();return this.divRemTo(e,t,null),t}function Nt(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function jh(e){const t=se();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(T.ZERO)>0&&this.m.subTo(t,t),t}function Hh(e){const t=se();return e.copyTo(t),this.reduce(t),t}function Gh(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=e[t]&32767;const r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Wh(e,t){e.squareTo(t),this.reduce(t)}function zh(e,t,n){e.multiplyTo(t,n),this.reduce(n)}Nt.prototype.convert=jh;Nt.prototype.revert=Hh;Nt.prototype.reduce=Gh;Nt.prototype.mulTo=zh;Nt.prototype.sqrTo=Wh;function Yh(e,t,n){let r=e.bitLength(),i,s=si(1);const o=new Nt(t);if(r<=0)return s;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6;const a=[];let c=3;const u=i-1,l=(1<<i)-1;if(a[1]=o.convert(this),i>1){const E=se();for(o.sqrTo(a[1],E);c<=l;)a[c]=se(),o.mulTo(E,a[c-2],a[c]),c+=2}let d=e.t-1,h,f=!0,p=se(),g;for(r=oi(e[d])-1;d>=0;){for(r>=u?h=e[d]>>r-u&l:(h=(e[d]&(1<<r+1)-1)<<u-r,d>0&&(h|=e[d-1]>>this.DB+r-u)),c=i;(h&1)===0;)h>>=1,--c;if((r-=c)<0&&(r+=this.DB,--d),f)a[h].copyTo(s),f=!1;else{for(;c>1;)o.sqrTo(s,p),o.sqrTo(p,s),c-=2;c>0?o.sqrTo(s,p):(g=s,s=p,p=g),o.mulTo(p,a[h],s)}for(;d>=0&&(e[d]&1<<r)===0;)o.sqrTo(s,p),g=s,s=p,p=g,--r<0&&(r=this.DB-1,--d)}const m=o.revert(s);return n(null,m),m}T.prototype.copyTo=vh;T.prototype.fromInt=Sh;T.prototype.fromString=Ih;T.prototype.clamp=wh;T.prototype.dlShiftTo=xh;T.prototype.drShiftTo=Ph;T.prototype.lShiftTo=Rh;T.prototype.rShiftTo=_h;T.prototype.subTo=kh;T.prototype.multiplyTo=Oh;T.prototype.squareTo=Dh;T.prototype.divRemTo=Lh;T.prototype.invDigit=Uh;T.prototype.addTo=qh;T.prototype.toString=Th;T.prototype.negate=bh;T.prototype.abs=Ah;T.prototype.compareTo=Nh;T.prototype.bitLength=Ch;T.prototype.mod=Mh;T.prototype.equals=Fh;T.prototype.add=$h;T.prototype.subtract=Bh;T.prototype.multiply=Kh;T.prototype.divide=Vh;T.prototype.modPow=Yh;T.ZERO=si(0);T.ONE=si(1);const Jh=async({a:e,g:t,k:n,x:r,B:i,N:s,U:o})=>new Promise((a,c)=>{t.modPow(r,s,(u,l)=>{if(u){c(u);return}i.subtract(n.multiply(l)).modPow(e.add(o.multiply(r)),s,(d,h)=>{if(d){c(d);return}a(h.mod(s))})})}),Qh="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",Ea={},Ar={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Ea[e]=t,Ar[t]=e}const mt=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const r=e.slice(n,n+2).toLowerCase();if(r in Ar)t[n/2]=Ar[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t},ai=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Ea[e[n]];return t},Nr=e=>{const t=new Gt;t.update(e);const n=t.digestSync(),r=ai(n);return new Array(64-r.length).join("0")+r},In=e=>Nr(mt(e)),Xh=/^[89a-f]/i,De=e=>{if(!(e instanceof T))throw new Error("Not a BigInteger");const t=e.compareTo(T.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=Xh.test(n)?`00${n}`:n,t){const r=n.split("").map(s=>{const o=~parseInt(s,16)&15;return"0123456789ABCDEF".charAt(o)}).join("");n=new T(r,16).add(T.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},Zh=({A:e,B:t})=>{const n=new T(In(De(e)+De(t)),16);if(n.equals(T.ZERO))throw new Error("U cannot be zero.");return n},ef=(e,t,n)=>{const r=new Gt(t);r.update(e);const i=r.digestSync(),s=new Gt(i);return s.update(n),s.digestSync().slice(0,16)},ci=e=>{const t=new ei().random(e).toString();return mt(t)},tf=()=>pt.convert(ci(40));class nf{constructor({userPoolName:t,a:n,g:r,A:i,N:s}){this.encoder=Sn,this.userPoolName=t,this.a=n,this.g=r,this.A=i,this.N=s,this.k=new T(In(`${De(s)}${De(r)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new C({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new C({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new C({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,n){this.randomPassword=tf();const r=`${t}${n}:${this.randomPassword}`,i=Nr(r),s=ai(ci(16));return this.saltToHashDevices=De(new T(s,16)),new Promise((o,a)=>{this.g.modPow(new T(In(this.saltToHashDevices+i),16),this.N,(c,u)=>{if(c){a(c);return}this.verifierDevices=De(u),o()})})}async getPasswordAuthenticationKey({username:t,password:n,serverBValue:r,salt:i}){if(r.mod(this.N).equals(T.ZERO))throw new Error("B cannot be zero.");const s=Zh({A:this.A,B:r}),o=`${this.userPoolName}${t}:${n}`,a=Nr(o),c=new T(In(De(i)+a),16),u=await Jh({a:this.a,g:this.g,k:this.k,x:c,B:r,N:this.N,U:s}),l=this.encoder.convert("Caldera Derived Key"),d=this.encoder.convert(""),h=new Uint8Array(l.byteLength+d.byteLength);return h.set(l,0),h.set(d,l.byteLength),ef(mt(De(u)),mt(De(s)),h)}}const rf=async({a:e,g:t,N:n})=>new Promise((r,i)=>{t.modPow(e,n,(s,o)=>{if(s){i(s);return}if(o.mod(n).equals(T.ZERO)){i(new Error("Illegal parameter. A mod N cannot be 0."));return}r(o)})}),zn=async e=>{const t=new T(Qh,16),n=new T("2",16),r=sf(),i=await rf({a:r,g:n,N:t});return new nf({userPoolName:e,a:r,g:n,A:i,N:t})},sf=()=>{const e=ai(ci(128));return new T(e,16)};async function Ct({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:r}){if(!n)return;const i=e.split("_")[1]||"",s=await zn(i),o=n==null?void 0:n.DeviceKey,a=n==null?void 0:n.DeviceGroupKey;try{await s.generateHashDevice(a??"",o??"")}catch{return}const c={Salt:pt.convert(mt(s.getSaltToHashDevices())),PasswordVerifier:pt.convert(mt(s.getVerifierDevices()))},u=s.getRandomPassword();try{return await hh({endpointResolver:ee({endpointOverride:t})})({region:Z(e)},{AccessToken:r,DeviceName:await hd(),DeviceKey:n==null?void 0:n.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:o,deviceGroupKey:a,randomPassword:u}}catch{return}}async function of(e){var f;const t=(f=K.getConfig().Auth)==null?void 0:f.Cognito;M(t);const{username:n,signInSession:r,signInDetails:i,challengeName:s}=Xe.getState();if(s!=="WEB_AUTHN"||!n)throw new C({name:gt.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:o}=e;ri(!!o,W.InvalidPasskeyAuthenticationOptions);const a=await dh(JSON.parse(o)),c=Gn({endpointResolver:ee({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:u,ChallengeParameters:l,AuthenticationResult:d,Session:h}=await c({region:Z(t.userPoolId),userAgentValue:ve(oe.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(a)},ClientId:t.userPoolClientId,Session:r});if(bt({signInSession:h,username:n,challengeName:u,signInDetails:i}),d)return await wt({...d,username:n,NewDeviceMetadata:await Ct({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:i}),Xe.dispatch({type:"RESET_STATE"}),await Tt(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(u==="WEB_AUTHN")throw new C({name:gt.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:u,challengeParameters:l}}const af=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],cf=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],va=()=>{const e=new Date,t=cf[e.getUTCDay()],n=af[e.getUTCMonth()],r=e.getUTCDate();let i=e.getUTCHours();i<10&&(i=`0${i}`);let s=e.getUTCMinutes();s<10&&(s=`0${s}`);let o=e.getUTCSeconds();o<10&&(o=`0${o}`);const a=e.getUTCFullYear();return`${t} ${n} ${r} ${i}:${s}:${o} UTC ${a}`},Sa=({userPoolName:e,username:t,challengeParameters:n,dateNow:r,hkdf:i})=>{const s=Sn.convert(e),o=Sn.convert(t),a=uf(n.SECRET_BLOCK),c=Sn.convert(r),u=new Uint8Array(s.byteLength+o.byteLength+a.byteLength+c.byteLength);u.set(s,0),u.set(o,s.byteLength),u.set(a,s.byteLength+o.byteLength),u.set(c,s.byteLength+o.byteLength+a.byteLength);const l=new Gt(i);l.update(u);const d=l.digestSync();return pt.convert(d)},uf=e=>{const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=qr.convert(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i};async function ui({username:e,config:t,clientMetadata:n,session:r,tokenOrchestrator:i}){const{userPoolId:s,userPoolEndpoint:o}=t,a=t.userPoolClientId,c=await(i==null?void 0:i.getDeviceMetadata(e));ha(c);const u=await zn(c.deviceGroupKey),l={USERNAME:e,SRP_A:u.A.toString(16),DEVICE_KEY:c.deviceKey},d={ChallengeName:"DEVICE_SRP_AUTH",ClientId:a,ChallengeResponses:l,ClientMetadata:n,Session:r},h=Gn({endpointResolver:ee({endpointOverride:o})}),{ChallengeParameters:f,Session:p}=await h({region:Z(s)},d);return lf(e,f,n,p,u,t,i)}async function lf(e,t,n,r,i,{userPoolId:s,userPoolClientId:o,userPoolEndpoint:a},c){const u=await(c==null?void 0:c.getDeviceMetadata(e));ha(u);const l=new T(t==null?void 0:t.SRP_B,16),d=new T(t==null?void 0:t.SALT,16),{deviceKey:h}=u,{deviceGroupKey:f}=u,p=await i.getPasswordAuthenticationKey({username:u.deviceKey,password:u.randomPassword,serverBValue:l,salt:d}),g=va(),m={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:g,PASSWORD_CLAIM_SIGNATURE:Sa({username:h,userPoolName:f,challengeParameters:t,dateNow:g,hkdf:p}),DEVICE_KEY:h},E=le({username:e,userPoolId:s,userPoolClientId:o}),S={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:o,ChallengeResponses:m,Session:r,ClientMetadata:n,UserContextData:E};return Gn({endpointResolver:ee({endpointOverride:a})})({region:Z(s)},S)}async function Ia(e,t,n,r,i,s,o){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=s,l=(a==null?void 0:a.split("_")[1])||"",d=new T(t==null?void 0:t.SRP_B,16),h=new T(t==null?void 0:t.SALT,16),f=t==null?void 0:t.USER_ID_FOR_SRP;if(!f)throw new C({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const p=await i.getPasswordAuthenticationKey({username:f,password:e,serverBValue:d,salt:h}),g=va(),m={USERNAME:f,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:g,PASSWORD_CLAIM_SIGNATURE:Sa({username:f,userPoolName:l,challengeParameters:t,dateNow:g,hkdf:p})},E=await o.getDeviceMetadata(f);E&&E.deviceKey&&(m.DEVICE_KEY=E.deviceKey);const S=le({username:f,userPoolId:a,userPoolClientId:c}),w={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:m,ClientMetadata:n,Session:r,ClientId:c,UserContextData:S},v=await Gn({endpointResolver:ee({endpointOverride:u})})({region:Z(a)},w);return v.ChallengeName==="DEVICE_SRP_AUTH"?ui({username:f,config:s,clientMetadata:n,session:v.Session,tokenOrchestrator:o}):v}async function Yn(e,t,n,r){try{return await e(...t)}catch(i){if(i instanceof C&&i.name==="ResourceNotFoundException"&&i.message.includes("Device does not exist."))return await r.clearDeviceMetadata(n),e(...t);throw i}}function rn(e){const{dispatch:t}=Xe;t({type:"SET_USERNAME",value:e})}async function wa({username:e,password:t,clientMetadata:n,config:r,tokenOrchestrator:i,authFlow:s,preferredChallenge:o}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=r,l=(a==null?void 0:a.split("_")[1])||"",d=await zn(l),h={USERNAME:e,SRP_A:d.A.toString(16)};s==="USER_AUTH"&&o&&(h.PREFERRED_CHALLENGE=o);const f=le({username:e,userPoolId:a,userPoolClientId:c}),p={AuthFlow:s,AuthParameters:h,ClientMetadata:n,ClientId:c,UserContextData:f},m=await It({endpointResolver:ee({endpointOverride:u})})({region:Z(a),userAgentValue:ve(oe.SignIn)},p),{ChallengeParameters:E,Session:S}=m,w=(E==null?void 0:E.USERNAME)??e;return rn(w),m.ChallengeName==="PASSWORD_VERIFIER"?Yn(Ia,[t,E,n,S,d,r,i],w,i):m}const Ls="userAttributes.";function df(e){return"isSignedIn"in e&&"nextStep"in e}async function hf(e,t,n,r,i){var g,m;const{userPoolClientId:s,userPoolId:o,userPoolEndpoint:a}=r,c={USERNAME:e,PASSWORD:t},u=await i.getDeviceMetadata(e);u&&u.deviceKey&&(c.DEVICE_KEY=u.deviceKey);const l=le({username:e,userPoolId:o,userPoolClientId:s}),d={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:n,ClientId:s,UserContextData:l},f=await It({endpointResolver:ee({endpointOverride:a})})({region:Z(o),userAgentValue:ve(oe.SignIn)},d),p=((g=f.ChallengeParameters)==null?void 0:g.USERNAME)??((m=f.ChallengeParameters)==null?void 0:m.USER_ID_FOR_SRP)??e;return rn(p),f.ChallengeName==="DEVICE_SRP_AUTH"?ui({username:p,config:r,clientMetadata:n,session:f.Session,tokenOrchestrator:i}):f}async function ff(e,t,n,r,i){return wa({username:e,password:t,clientMetadata:n,config:r,tokenOrchestrator:i,authFlow:"USER_SRP_AUTH"})}async function pf(e,t,n,r){var p;const{userPoolClientId:i,userPoolId:s,userPoolEndpoint:o}=n,a={USERNAME:e},c=await r.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);const u=le({username:e,userPoolId:s,userPoolClientId:i}),l={AuthFlow:"CUSTOM_AUTH",AuthParameters:a,ClientMetadata:t,ClientId:i,UserContextData:u},h=await It({endpointResolver:ee({endpointOverride:o})})({region:Z(s),userAgentValue:ve(oe.SignIn)},l),f=((p=h.ChallengeParameters)==null?void 0:p.USERNAME)??e;return rn(f),h.ChallengeName==="DEVICE_SRP_AUTH"?ui({username:f,config:n,clientMetadata:t,session:h.Session,tokenOrchestrator:r}):h}async function gf(e,t,n,r,i){M(r);const{userPoolId:s,userPoolClientId:o,userPoolEndpoint:a}=r,c=(s==null?void 0:s.split("_")[1])||"",u=await zn(c),l={USERNAME:e,SRP_A:u.A.toString(16),CHALLENGE_NAME:"SRP_A"},d=le({username:e,userPoolId:s,userPoolClientId:o}),h={AuthFlow:"CUSTOM_AUTH",AuthParameters:l,ClientMetadata:n,ClientId:o,UserContextData:d},f=It({endpointResolver:ee({endpointOverride:a})}),{ChallengeParameters:p,Session:g}=await f({region:Z(s),userAgentValue:ve(oe.SignIn)},h),m=(p==null?void 0:p.USERNAME)??e;return rn(m),Yn(Ia,[t,p,n,g,u,r,i],m,i)}async function xt(e){var s;const{challengeName:t,challengeParameters:n,availableChallenges:r}=e,i=(s=K.getConfig().Auth)==null?void 0:s.Cognito;switch(M(i),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:o,username:a}=Xe.getState(),c=Ms(Us(n.MFAS_CAN_SETUP))||[],u=vf(c),l=u.includes("TOTP"),d=u.includes("EMAIL");if(l&&d)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:u}};if(d)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(l){const h=$d({endpointResolver:ee({endpointOverride:i.userPoolEndpoint})}),{Session:f,SecretCode:p}=await h({region:Z(i.userPoolId)},{Session:o});return Xe.dispatch({type:"SET_SIGN_IN_SESSION",value:f}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:mf(p,a)}}}throw new C({name:gt.SignInException,message:`Cannot initiate MFA setup from available types: ${c}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:yf(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:Ms(Us(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const o=await of(n);return df(o)?o:xt(o)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:r}}}throw new C({name:gt.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function mf(e,t){return{sharedSecret:e,getSetupUri:(n,r)=>{const i=`otpauth://totp/${n}:${r??t}?secret=${e}&issuer=${n}`;return new Pe(i)}}}function sn(e){if(e===Dn.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===Dn.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function yf(e){return e?JSON.parse(e).map(n=>n.includes(Ls)?n.replace(Ls,""):n):[]}function Ef(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function Ms(e){if(e)return e.map(Ef).filter(Boolean)}function Us(e){return e?JSON.parse(e):[]}function vf(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function Sf(){let e;try{e=await Kt()}catch{}if(e&&e.userId&&e.username)throw new C({name:yd,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function on(e){return Xe.getState().username??e}async function If(e){var a;const t=(a=K.getConfig().Auth)==null?void 0:a.Cognito;M(t);const{username:n,password:r,options:i}=e,s={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},o=i==null?void 0:i.clientMetadata;Y(!!n,P.EmptySignInUsername),Y(!r,P.CustomAuthSignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await Yn(pf,[n,o,t,ye],n,ye),h=on(n);return bt({signInSession:d,username:h,challengeName:c,signInDetails:s}),l?(await wt({username:h,...l,NewDeviceMetadata:await Ct({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:s}),Re(),await Tt(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):xt({challengeName:c,challengeParameters:u})}catch(c){Re(),Te(c);const u=sn(c.name);if(u)return u;throw c}}async function wf(e){var a;const{username:t,password:n,options:r}=e,i={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},s=(a=K.getConfig().Auth)==null?void 0:a.Cognito;M(s);const o=r==null?void 0:r.clientMetadata;Y(!!t,P.EmptySignInUsername),Y(!!n,P.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await gf(t,n,o,s,ye),h=on(t);return bt({signInSession:d,username:h,challengeName:c,signInDetails:i}),l?(await wt({username:h,...l,NewDeviceMetadata:await Ct({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:i}),Re(),await Tt(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):xt({challengeName:c,challengeParameters:u})}catch(c){Re(),Te(c);const u=sn(c.name);if(u)return u;throw c}}function qe(e=!0){He.dispatch({type:"RESET"})}async function Fs(e){var o,a;const{username:t,password:n}=e,r=(o=K.getConfig().Auth)==null?void 0:o.Cognito,i={loginId:t,authFlowType:"USER_SRP_AUTH"};M(r);const s=(a=e.options)==null?void 0:a.clientMetadata;Y(!!t,P.EmptySignInUsername),Y(!!n,P.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await ff(t,n,s,r,ye),h=on(t);return bt({signInSession:d,username:h,challengeName:c,signInDetails:i}),l?(await wt({username:h,...l,NewDeviceMetadata:await Ct({userPoolId:r.userPoolId,userPoolEndpoint:r.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:i}),Re(),await Tt(),qe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):xt({challengeName:c,challengeParameters:u})}catch(c){Re(),qe(),Te(c);const u=sn(c.name);if(u)return u;throw c}}async function Tf(e){var a;const{username:t,password:n,options:r}=e,i=(a=K.getConfig().Auth)==null?void 0:a.Cognito,s={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};M(i);const o=r==null?void 0:r.clientMetadata;Y(!!t,P.EmptySignInUsername),Y(!!n,P.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await Yn(hf,[t,n,o,i,ye],t,ye),h=on(t);return bt({signInSession:d,username:h,challengeName:c,signInDetails:s}),l?(await wt({...l,username:h,NewDeviceMetadata:await Ct({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:s}),Re(),await Tt(),qe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):xt({challengeName:c,challengeParameters:u})}catch(c){Re(),qe(),Te(c);const u=sn(c.name);if(u)return u;throw c}}async function bf({username:e,clientMetadata:t,config:n,tokenOrchestrator:r,preferredChallenge:i,password:s,session:o}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=n,l=le({username:e,userPoolId:a,userPoolClientId:c}),d={USERNAME:e};if(i){if(i==="PASSWORD_SRP")return Y(!!s,P.EmptySignInPassword),wa({username:e,password:s,clientMetadata:t,config:n,tokenOrchestrator:r,authFlow:"USER_AUTH",preferredChallenge:i});i==="PASSWORD"&&(Y(!!s,P.EmptySignInPassword),d.PASSWORD=s),d.PREFERRED_CHALLENGE=i}const h={AuthFlow:"USER_AUTH",AuthParameters:d,ClientMetadata:t,ClientId:c,UserContextData:l};o&&(h.Session=o);const p=await It({endpointResolver:ee({endpointOverride:u})})({region:Z(a),userAgentValue:ve(oe.SignIn)},h);return rn(e),p}async function Af(e){var c;const{username:t,password:n,options:r}=e,i=(c=K.getConfig().Auth)==null?void 0:c.Cognito,s={loginId:t,authFlowType:"USER_AUTH"};M(i);const o=r==null?void 0:r.clientMetadata,a=r==null?void 0:r.preferredChallenge;Y(!!t,P.EmptySignInUsername);try{const u={username:t,config:i,tokenOrchestrator:ye,clientMetadata:o,preferredChallenge:a,password:n},l=He.getState();l.active&&l.username===t&&(u.session=l.session);const d=await bf(u),h=on(t);return bt({signInSession:d.Session,username:h,challengeName:d.ChallengeName,signInDetails:s}),d.AuthenticationResult?(await wt({username:h,...d.AuthenticationResult,NewDeviceMetadata:await Ct({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:d.AuthenticationResult.NewDeviceMetadata,accessToken:d.AuthenticationResult.AccessToken}),signInDetails:s}),Re(),await Tt(),qe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):xt({challengeName:d.ChallengeName,challengeParameters:d.ChallengeParameters,availableChallenges:"AvailableChallenges"in d?d.AvailableChallenges:void 0})}catch(u){Re(),qe(),Te(u);const l=sn(u.name);if(l)return l;throw u}}async function Nf(e){var n;qe(!1);const t=(n=e.options)==null?void 0:n.authFlowType;switch(await Sf(),t){case"USER_SRP_AUTH":return Fs(e);case"USER_PASSWORD_AUTH":return Tf(e);case"CUSTOM_WITHOUT_SRP":return If(e);case"CUSTOM_WITH_SRP":return wf(e);case"USER_AUTH":return Af(e);default:return Fs(e)}}const Cf=3*60*1e3;function xf(e){const t=_n.listen("auth-internal",async({payload:r})=>{switch(r.event){case"confirmSignUp":{const i=r.data;i!=null&&i.isSignUpComplete&&(_n.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),n=setTimeout(()=>{t(),clearTimeout(n),qe()},Cf)}const Pf=()=>async e=>{if(e.statusCode>=300){const t=await ot(e);if(Te(t),t.name===br.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const n=P.EmptySignUpPassword,{message:r,recoverySuggestion:i}=la[n];throw new C({name:n,message:r,recoverySuggestion:i})}throw new C({name:t.name,message:t.message})}return en(e)},Rf=e=>Ee(ke,_e("SignUp"),Pf(),{...Oe,...e});async function _f(e){var A;const{username:t,password:n,options:r}=e,i=(A=K.getConfig().Auth)==null?void 0:A.Cognito,s=(i==null?void 0:i.signUpVerificationMethod)??"code",{clientMetadata:o,validationData:a,autoSignIn:c}=e.options??{};M(i),Y(!!t,P.EmptySignUpUsername);const u=typeof c!="boolean"?c:void 0;u==null||u.authFlowType;const{userPoolId:l,userPoolClientId:d,userPoolEndpoint:h}=i,f=Rf({endpointResolver:ee({endpointOverride:h})}),p={Username:t,Password:void 0,UserAttributes:(r==null?void 0:r.userAttributes)&&rs(r==null?void 0:r.userAttributes),ClientMetadata:o,ValidationData:a&&rs(a),ClientId:d,UserContextData:le({username:t,userPoolId:l,userPoolClientId:d})};n&&(p.Password=n);const{UserSub:g,CodeDeliveryDetails:m,UserConfirmed:E,Session:S}=await f({region:Z(l),userAgentValue:ve(oe.SignUp)},p);(u||c===!0)&&(He.dispatch({type:"START"}),He.dispatch({type:"SET_USERNAME",value:t}),He.dispatch({type:"SET_SESSION",value:S}));const w={destination:m==null?void 0:m.Destination,deliveryMedium:m==null?void 0:m.DeliveryMedium,attributeName:m==null?void 0:m.AttributeName},I=!!E,v=He.getState().active;if(I)return v?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:g}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:g};if(v){if(s==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:w},userId:g};xf()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:w},userId:g}}const kf=e=>Ee(ke,_e("ForgotPassword"),Ke(),{...Oe,...e});async function Of(e){var d,h;const{username:t}=e;Y(!!t,P.EmptyResetPasswordUsername);const n=(d=K.getConfig().Auth)==null?void 0:d.Cognito;M(n);const{userPoolClientId:r,userPoolId:i,userPoolEndpoint:s}=n,o=(h=e.options)==null?void 0:h.clientMetadata,a=le({username:t,userPoolId:i,userPoolClientId:r}),l=(await kf({endpointResolver:ee({endpointOverride:s})})({region:Z(i),userAgentValue:ve(oe.ResetPassword)},{Username:t,ClientMetadata:o,ClientId:r,UserContextData:a})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:l==null?void 0:l.DeliveryMedium,destination:l==null?void 0:l.Destination,attributeName:l==null?void 0:l.AttributeName}}}}const Df=e=>Ee(ke,_e("ConfirmForgotPassword"),Ke(),{...Oe,...e});async function Lf(e){var d,h;const t=(d=K.getConfig().Auth)==null?void 0:d.Cognito;M(t);const{userPoolClientId:n,userPoolId:r,userPoolEndpoint:i}=t,{username:s,newPassword:o}=e;Y(!!s,P.EmptyConfirmResetPasswordUsername),Y(!!o,P.EmptyConfirmResetPasswordNewPassword);const a=e.confirmationCode;Y(!!a,P.EmptyConfirmResetPasswordConfirmationCode);const c=(h=e.options)==null?void 0:h.clientMetadata,u=le({username:s,userPoolId:r,userPoolClientId:n});await Df({endpointResolver:ee({endpointOverride:i})})({region:Z(t.userPoolId),userAgentValue:ve(oe.ConfirmResetPassword)},{Username:s,ConfirmationCode:a,Password:o,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:u})}const Mf=e=>Ee(ke,_e("ResendConfirmationCode"),Ke(),{...Oe,...e});async function Uf(e){var f,p;const{username:t}=e;Y(!!t,P.EmptySignUpUsername);const n=(f=K.getConfig().Auth)==null?void 0:f.Cognito;M(n);const{userPoolClientId:r,userPoolId:i,userPoolEndpoint:s}=n,o=(p=e.options)==null?void 0:p.clientMetadata,a=le({username:t,userPoolId:i,userPoolClientId:r}),c=Mf({endpointResolver:ee({endpointOverride:s})}),{CodeDeliveryDetails:u}=await c({region:Z(n.userPoolId),userAgentValue:ve(oe.ResendSignUpCode)},{Username:t,ClientMetadata:o,ClientId:n.userPoolClientId,UserContextData:a}),{DeliveryMedium:l,AttributeName:d,Destination:h}={...u};return{destination:h,deliveryMedium:l,attributeName:d||void 0}}const Ff=e=>Ee(ke,_e("ConfirmSignUp"),Ke(),{...Oe,...e});async function qf(e){var h;const{username:t,confirmationCode:n,options:r}=e,i=(h=K.getConfig().Auth)==null?void 0:h.Cognito;M(i);const{userPoolId:s,userPoolClientId:o,userPoolEndpoint:a}=i,c=r==null?void 0:r.clientMetadata;Y(!!t,P.EmptyConfirmSignUpUsername),Y(!!n,P.EmptyConfirmSignUpCode);const u=le({username:t,userPoolId:s,userPoolClientId:o}),l=Ff({endpointResolver:ee({endpointOverride:a})}),{Session:d}=await l({region:Z(i.userPoolId),userAgentValue:ve(oe.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:c,ForceAliasCreation:r==null?void 0:r.forceAliasCreation,ClientId:i.userPoolClientId,UserContextData:u});return new Promise((f,p)=>{try{const g={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},m=He.getState();if(!m.active||m.username!==t){f(g),qe();return}He.dispatch({type:"SET_SESSION",value:d});const E=_n.listen("auth-internal",({payload:S})=>{switch(S.event){case"autoSignIn":f({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),E()}});_n.dispatch("auth-internal",{event:"confirmSignUp",data:g})}catch(g){p(g)}})}function $f(e,t){{const n=(e==null?void 0:e.find(Bf))??(e==null?void 0:e.find(Kf)),r=(e==null?void 0:e.find(jf))??(e==null?void 0:e.find(Vf));if(n)return n;throw r?bd:wd}}const Bf=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),Kf=e=>e.includes(String(window.location.hostname)),Vf=e=>e.startsWith("http://"),jf=e=>e.startsWith("https://"),Hf=async e=>{window!=null&&window.location&&(window.location.href=e.replace("http://","https://"))},Gf=async e=>{await e.clearOAuthData(),ye.clearTokens(),await Vo(),Qe.dispatch("auth",{event:"signedOut"},"Auth",Je)},Wf=async(e,t=!1,n)=>{mo(e);const{loginWith:r,userPoolClientId:i}=e,{domain:s,redirectSignOut:o}=r.oauth,a=$f(o),c=`https://${s}/logout?${Object.entries({client_id:i,logout_uri:encodeURIComponent(a)}).map(([u,l])=>`${u}=${l}`).join("&")}`;return Hf(c)},zf=async(e,t,n,r)=>{const{isOAuthSignIn:i}=await t.loadOAuthSignIn(),s=await n.getOAuthMetadata();if(await Gf(t),i||s!=null&&s.oauthSignIn)return Wf(e,!1)},Yf=e=>Ee(ke,_e("RevokeToken"),Ke(),{...Oe,...e}),Jf=new X("Auth");async function Qf(e){var r;const t=(r=K.getConfig().Auth)==null?void 0:r.Cognito;M(t),await Xf(t);let n;try{mo(t),n=!0}catch{n=!1}if(n){const i=new ga(nn);i.setAuthConfig(t);const{type:s}=await zf(t,i,ye)??{};if(s==="error")throw new C({name:Ad,message:"An error occurred when attempting to log out from OAuth provider."})}else ye.clearTokens(),await Vo(),Qe.dispatch("auth",{event:"signedOut"},"Auth",Je)}async function Xf(e){try{const{userPoolEndpoint:t,userPoolId:n,userPoolClientId:r}=e,i=await ye.getTokenStore().loadTokens();da(i),Zf(i.accessToken)&&await Yf({endpointResolver:ee({endpointOverride:t})})({region:Z(n),userAgentValue:ve(oe.SignOut)},{ClientId:r,Token:i.refreshToken})}catch{Jf.debug("Client signOut error caught but will proceed with token removal")}}const Zf=e=>{var t;return!!((t=e==null?void 0:e.payload)!=null&&t.origin_jti)},ep={identityId:"identityId"},tp=new X("DefaultIdentityIdStore");class Ta{setAuthConfig(t){En(t.Cognito),this.authConfig=t,this._authKeys=np("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;En((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const n=await this.keyValueStorage.getItem(this._authKeys.identityId);return n?(this._hasGuestIdentityId=!0,{id:n,type:"guest"}):null}}catch(n){return tp.log("Error getting stored IdentityId.",n),null}}async storeIdentityId(t){var n;En((n=this.authConfig)==null?void 0:n.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const np=(e,t)=>ti(ep)(`com.amplify.${e}`,t),Cr=({endpointOverride:e})=>t=>e?{url:new Pe(e)}:Cl(t);function ba(e){const t=nt(e).payload.iss,n={};if(!t)throw new C({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const r=t.replace(/(^\w+:|^)\/\//,"");return n[r]=e,n}async function rp({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});const r=await n.loadIdentityId();if(r)return r.id;const i=e!=null&&e.idToken?ba(e.idToken.toString()):{},s=await ip(i,t);return n.storeIdentityId({id:s,type:e?"primary":"guest"}),s}async function ip(e,t){const n=t==null?void 0:t.identityPoolId,r=Tr(n),i=bl({endpointResolver:Cr({endpointOverride:t.identityPoolEndpoint})});let s;try{s=(await i({region:r},{IdentityPoolId:n,Logins:e})).IdentityId}catch(o){throw Te(o),new C(o)}if(!s)throw new C({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return s}const mn=new X("CognitoCredentialsProvider"),qs=50*60*1e3;class Aa{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){mn.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){mn.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:r}=t,{authConfig:i}=t;try{En(i==null?void 0:i.Cognito)}catch{return}if(!n&&!i.Cognito.allowGuestAccess)return;const{forceRefresh:s}=t,o=this.hasTokenChanged(r),a=await rp({tokens:r,authConfig:i.Cognito,identityIdStore:this._identityIdStore});return(s||o)&&this.clearCredentials(),n?(Pd(r),this.credsForOIDCTokens(i.Cognito,r,a)):this.getGuestCredentials(a,i.Cognito)}async getGuestCredentials(t,n){var o,a;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return mn.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const r=Tr(n.identityPoolId),i=Zi({endpointResolver:Cr({endpointOverride:n.identityPoolEndpoint})});let s;try{s=await i({region:r},{IdentityId:t})}catch(c){throw Te(c),new C(c)}if((o=s==null?void 0:s.Credentials)!=null&&o.AccessKeyId&&((a=s==null?void 0:s.Credentials)!=null&&a.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+qs;const c={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:t};return s.IdentityId&&(c.identityId=s.IdentityId,this._identityIdStore.storeIdentityId({id:s.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!1},c}else throw new C({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,r){var c,u,l;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return mn.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const i=n.idToken?ba(n.idToken.toString()):{},s=Tr(t.identityPoolId),o=Zi({endpointResolver:Cr({endpointOverride:t.identityPoolEndpoint})});let a;try{a=await o({region:s},{IdentityId:r,Logins:i})}catch(d){throw Te(d),new C(d)}if((c=a==null?void 0:a.Credentials)!=null&&c.AccessKeyId&&((u=a==null?void 0:a.Credentials)!=null&&u.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+qs;const d={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:r};return a.IdentityId&&(d.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...d,isAuthenticatedCreds:!0,associatedIdToken:(l=n.idToken)==null?void 0:l.toString()},d}else throw new C({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var n,r;return!!t&&!!((n=this._credentialsAndIdentityId)!=null&&n.associatedIdToken)&&((r=t.idToken)==null?void 0:r.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const sp=new Aa(new Ta(nn)),op={configure(e,t){const n=So(e),r=new Dl({sameSite:"lax"}),i=t!=null&&t.ssr?r:nn,s=t!=null&&t.ssr?new Aa(new Ta(r)):sp;if(!n.Auth){K.configure(n,t);return}if(t!=null&&t.Auth){K.configure(n,t);return}if(!K.libraryOptions.Auth){qt.setAuthConfig(n.Auth),qt.setKeyValueStorage(i),K.configure(n,{...t,Auth:{tokenProvider:qt,credentialsProvider:s}});return}if(t){const o=K.libraryOptions.Auth;t.ssr!==void 0&&(qt.setKeyValueStorage(i),o.credentialsProvider=s),K.configure(n,{Auth:o,...t});return}K.configure(n)},getConfig(){return K.getConfig()}};function wn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wn=function(n){return typeof n}:wn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},wn(e)}function ap(e){return wn(e)=="object"&&e!==null}var Na=typeof Symbol=="function"&&Symbol.toStringTag!=null?Symbol.toStringTag:"@@toStringTag";function xr(e,t){for(var n=/\r\n|[\n\r]/g,r=1,i=t+1,s;(s=n.exec(e.body))&&s.index<t;)r+=1,i=t+1-(s.index+s[0].length);return{line:r,column:i}}function cp(e){return Ca(e.source,xr(e.source,e.start))}function Ca(e,t){var n=e.locationOffset.column-1,r=Tn(n)+e.body,i=t.line-1,s=e.locationOffset.line-1,o=t.line+s,a=t.line===1?n:0,c=t.column+a,u="".concat(e.name,":").concat(o,":").concat(c,`
`),l=r.split(/\r\n|[\n\r]/g),d=l[i];if(d.length>120){for(var h=Math.floor(c/80),f=c%80,p=[],g=0;g<d.length;g+=80)p.push(d.slice(g,g+80));return u+$s([["".concat(o),p[0]]].concat(p.slice(1,h+1).map(function(m){return["",m]}),[[" ",Tn(f-1)+"^"],["",p[h+1]]]))}return u+$s([["".concat(o-1),l[i-1]],["".concat(o),d],["",Tn(c-1)+"^"],["".concat(o+1),l[i+1]]])}function $s(e){var t=e.filter(function(r){r[0];var i=r[1];return i!==void 0}),n=Math.max.apply(Math,t.map(function(r){var i=r[0];return i.length}));return t.map(function(r){var i=r[0],s=r[1];return up(n,i)+(s?" | "+s:" |")}).join(`
`)}function Tn(e){return Array(e+1).join(" ")}function up(e,t){return Tn(e-t.length)+t}function bn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bn=function(n){return typeof n}:bn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},bn(e)}function Bs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function lp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bs(Object(n),!0).forEach(function(r){dp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bs(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pp(e,t,n){return t&&fp(e.prototype,t),e}function gp(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}function mp(e){var t=Pa();return function(){var r=Yt(e),i;if(t){var s=Yt(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return xa(this,i)}}function xa(e,t){return t&&(bn(t)==="object"||typeof t=="function")?t:$t(e)}function $t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pr(e){var t=typeof Map=="function"?new Map:void 0;return Pr=function(r){if(r===null||!yp(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return An(r,arguments,Yt(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),zt(i,r)},Pr(e)}function An(e,t,n){return Pa()?An=Reflect.construct:An=function(i,s,o){var a=[null];a.push.apply(a,s);var c=Function.bind.apply(i,a),u=new c;return o&&zt(u,o.prototype),u},An.apply(null,arguments)}function Pa(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function yp(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function zt(e,t){return zt=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},zt(e,t)}function Yt(e){return Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Yt(e)}var Vt=function(e){gp(n,e);var t=mp(n);function n(r,i,s,o,a,c,u){var l,d,h,f;hp(this,n),f=t.call(this,r),f.name="GraphQLError",f.originalError=c??void 0,f.nodes=Ks(Array.isArray(i)?i:i?[i]:void 0);for(var p=[],g=0,m=(E=f.nodes)!==null&&E!==void 0?E:[];g<m.length;g++){var E,S=m[g],w=S.loc;w!=null&&p.push(w)}p=Ks(p),f.source=s??((l=p)===null||l===void 0?void 0:l[0].source),f.positions=o??((d=p)===null||d===void 0?void 0:d.map(function(v){return v.start})),f.locations=o&&s?o.map(function(v){return xr(s,v)}):(h=p)===null||h===void 0?void 0:h.map(function(v){return xr(v.source,v.start)}),f.path=a??void 0;var I=c==null?void 0:c.extensions;return u==null&&ap(I)?f.extensions=lp({},I):f.extensions=u??{},Object.defineProperties($t(f),{message:{enumerable:!0},locations:{enumerable:f.locations!=null},path:{enumerable:f.path!=null},extensions:{enumerable:f.extensions!=null&&Object.keys(f.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),c!=null&&c.stack?(Object.defineProperty($t(f),"stack",{value:c.stack,writable:!0,configurable:!0}),xa(f)):(Error.captureStackTrace?Error.captureStackTrace($t(f),n):Object.defineProperty($t(f),"stack",{value:Error().stack,writable:!0,configurable:!0}),f)}return pp(n,[{key:"toString",value:function(){return Ep(this)}},{key:Na,get:function(){return"Object"}}]),n}(Pr(Error));function Ks(e){return e===void 0||e.length===0?void 0:e}function Ep(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var i=r[n];i.loc&&(t+=`

`+cp(i.loc))}else if(e.source&&e.locations)for(var s=0,o=e.locations;s<o.length;s++){var a=o[s];t+=`

`+Ca(e.source,a)}return t}function ue(e,t,n){return new Vt("Syntax Error: ".concat(n),void 0,e,[t])}var N=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});function vp(e,t){var n=!!e;if(!n)throw new Error("Unexpected invariant triggered.")}var Rr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):void 0;function Ra(e){var t=e.prototype.toJSON;typeof t=="function"||vp(0),e.prototype.inspect=t,Rr&&(e.prototype[Rr]=t)}var _a=function(){function e(n,r,i){this.start=n.start,this.end=r.end,this.startToken=n,this.endToken=r,this.source=i}var t=e.prototype;return t.toJSON=function(){return{start:this.start,end:this.end}},e}();Ra(_a);var H=function(){function e(n,r,i,s,o,a,c){this.kind=n,this.start=r,this.end=i,this.line=s,this.column=o,this.value=c,this.prev=a,this.next=null}var t=e.prototype;return t.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();Ra(H);function Vs(e){return e!=null&&typeof e.kind=="string"}var y=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function Nn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Nn=function(n){return typeof n}:Nn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Nn(e)}var Sp=10,ka=2;function Oa(e){return Jn(e,[])}function Jn(e,t){switch(Nn(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return e===null?"null":Ip(e,t);default:return String(e)}}function Ip(e,t){if(t.indexOf(e)!==-1)return"[Circular]";var n=[].concat(t,[e]),r=bp(e);if(r!==void 0){var i=r.call(e);if(i!==e)return typeof i=="string"?i:Jn(i,n)}else if(Array.isArray(e))return Tp(e,n);return wp(e,n)}function wp(e,t){var n=Object.keys(e);if(n.length===0)return"{}";if(t.length>ka)return"["+Ap(e)+"]";var r=n.map(function(i){var s=Jn(e[i],t);return i+": "+s});return"{ "+r.join(", ")+" }"}function Tp(e,t){if(e.length===0)return"[]";if(t.length>ka)return"[Array]";for(var n=Math.min(Sp,e.length),r=e.length-n,i=[],s=0;s<n;++s)i.push(Jn(e[s],t));return r===1?i.push("... 1 more item"):r>1&&i.push("... ".concat(r," more items")),"["+i.join(", ")+"]"}function bp(e){var t=e[String(Rr)];if(typeof t=="function")return t;if(typeof e.inspect=="function")return e.inspect}function Ap(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if(t==="Object"&&typeof e.constructor=="function"){var n=e.constructor.name;if(typeof n=="string"&&n!=="")return n}return t}function ur(e,t){var n=!!e;if(!n)throw new Error(t)}const Np=function(t,n){return t instanceof n};function Cp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xp(e,t,n){return t&&Cp(e.prototype,t),e}var Da=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"GraphQL request",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{line:1,column:1};typeof t=="string"||ur(0,"Body must be a string. Received: ".concat(Oa(t),".")),this.body=t,this.name=n,this.locationOffset=r,this.locationOffset.line>0||ur(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||ur(0,"column in locationOffset is 1-indexed and must be positive.")}return xp(e,[{key:Na,get:function(){return"Source"}}]),e}();function Pp(e){return Np(e,Da)}var Rp=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function _p(e){var t=e.split(/\r\n|[\n\r]/g),n=kp(e);if(n!==0)for(var r=1;r<t.length;r++)t[r]=t[r].slice(n);for(var i=0;i<t.length&&js(t[i]);)++i;for(var s=t.length;s>i&&js(t[s-1]);)--s;return t.slice(i,s).join(`
`)}function js(e){for(var t=0;t<e.length;++t)if(e[t]!==" "&&e[t]!=="	")return!1;return!0}function kp(e){for(var t,n=!0,r=!0,i=0,s=null,o=0;o<e.length;++o)switch(e.charCodeAt(o)){case 13:e.charCodeAt(o+1)===10&&++o;case 10:n=!1,r=!0,i=0;break;case 9:case 32:++i;break;default:r&&!n&&(s===null||i<s)&&(s=i),r=!1}return(t=s)!==null&&t!==void 0?t:0}function Op(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=e.indexOf(`
`)===-1,i=e[0]===" "||e[0]==="	",s=e[e.length-1]==='"',o=e[e.length-1]==="\\",a=!r||s||o||n,c="";return a&&!(r&&i)&&(c+=`
`+t),c+=t?e.replace(/\n/g,`
`+t):e,a&&(c+=`
`),'"""'+c.replace(/"""/g,'\\"""')+'"""'}var Dp=function(){function e(n){var r=new H(y.SOF,0,0,0,0,null);this.source=n,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){this.lastToken=this.token;var r=this.token=this.lookahead();return r},t.lookahead=function(){var r=this.token;if(r.kind!==y.EOF)do{var i;r=(i=r.next)!==null&&i!==void 0?i:r.next=Mp(this,r)}while(r.kind===y.COMMENT);return r},e}();function Lp(e){return e===y.BANG||e===y.DOLLAR||e===y.AMP||e===y.PAREN_L||e===y.PAREN_R||e===y.SPREAD||e===y.COLON||e===y.EQUALS||e===y.AT||e===y.BRACKET_L||e===y.BRACKET_R||e===y.BRACE_L||e===y.PIPE||e===y.BRACE_R}function rt(e){return isNaN(e)?y.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function Mp(e,t){for(var n=e.source,r=n.body,i=r.length,s=t.end;s<i;){var o=r.charCodeAt(s),a=e.line,c=1+s-e.lineStart;switch(o){case 65279:case 9:case 32:case 44:++s;continue;case 10:++s,++e.line,e.lineStart=s;continue;case 13:r.charCodeAt(s+1)===10?s+=2:++s,++e.line,e.lineStart=s;continue;case 33:return new H(y.BANG,s,s+1,a,c,t);case 35:return Fp(n,s,a,c,t);case 36:return new H(y.DOLLAR,s,s+1,a,c,t);case 38:return new H(y.AMP,s,s+1,a,c,t);case 40:return new H(y.PAREN_L,s,s+1,a,c,t);case 41:return new H(y.PAREN_R,s,s+1,a,c,t);case 46:if(r.charCodeAt(s+1)===46&&r.charCodeAt(s+2)===46)return new H(y.SPREAD,s,s+3,a,c,t);break;case 58:return new H(y.COLON,s,s+1,a,c,t);case 61:return new H(y.EQUALS,s,s+1,a,c,t);case 64:return new H(y.AT,s,s+1,a,c,t);case 91:return new H(y.BRACKET_L,s,s+1,a,c,t);case 93:return new H(y.BRACKET_R,s,s+1,a,c,t);case 123:return new H(y.BRACE_L,s,s+1,a,c,t);case 124:return new H(y.PIPE,s,s+1,a,c,t);case 125:return new H(y.BRACE_R,s,s+1,a,c,t);case 34:return r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34?Bp(n,s,a,c,t,e):$p(n,s,a,c,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return qp(n,s,o,a,c,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return Vp(n,s,a,c,t)}throw ue(n,s,Up(o))}var u=e.line,l=1+s-e.lineStart;return new H(y.EOF,i,i,u,l,t)}function Up(e){return e<32&&e!==9&&e!==10&&e!==13?"Cannot contain the invalid character ".concat(rt(e),"."):e===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:"Cannot parse the unexpected character ".concat(rt(e),".")}function Fp(e,t,n,r,i){var s=e.body,o,a=t;do o=s.charCodeAt(++a);while(!isNaN(o)&&(o>31||o===9));return new H(y.COMMENT,t,a,n,r,i,s.slice(t+1,a))}function qp(e,t,n,r,i,s){var o=e.body,a=n,c=t,u=!1;if(a===45&&(a=o.charCodeAt(++c)),a===48){if(a=o.charCodeAt(++c),a>=48&&a<=57)throw ue(e,c,"Invalid number, unexpected digit after 0: ".concat(rt(a),"."))}else c=lr(e,c,a),a=o.charCodeAt(c);if(a===46&&(u=!0,a=o.charCodeAt(++c),c=lr(e,c,a),a=o.charCodeAt(c)),(a===69||a===101)&&(u=!0,a=o.charCodeAt(++c),(a===43||a===45)&&(a=o.charCodeAt(++c)),c=lr(e,c,a),a=o.charCodeAt(c)),a===46||jp(a))throw ue(e,c,"Invalid number, expected digit but got: ".concat(rt(a),"."));return new H(u?y.FLOAT:y.INT,t,c,r,i,s,o.slice(t,c))}function lr(e,t,n){var r=e.body,i=t,s=n;if(s>=48&&s<=57){do s=r.charCodeAt(++i);while(s>=48&&s<=57);return i}throw ue(e,i,"Invalid number, expected digit but got: ".concat(rt(s),"."))}function $p(e,t,n,r,i){for(var s=e.body,o=t+1,a=o,c=0,u="";o<s.length&&!isNaN(c=s.charCodeAt(o))&&c!==10&&c!==13;){if(c===34)return u+=s.slice(a,o),new H(y.STRING,t,o+1,n,r,i,u);if(c<32&&c!==9)throw ue(e,o,"Invalid character within String: ".concat(rt(c),"."));if(++o,c===92){switch(u+=s.slice(a,o-1),c=s.charCodeAt(o),c){case 34:u+='"';break;case 47:u+="/";break;case 92:u+="\\";break;case 98:u+="\b";break;case 102:u+="\f";break;case 110:u+=`
`;break;case 114:u+="\r";break;case 116:u+="	";break;case 117:{var l=Kp(s.charCodeAt(o+1),s.charCodeAt(o+2),s.charCodeAt(o+3),s.charCodeAt(o+4));if(l<0){var d=s.slice(o+1,o+5);throw ue(e,o,"Invalid character escape sequence: \\u".concat(d,"."))}u+=String.fromCharCode(l),o+=4;break}default:throw ue(e,o,"Invalid character escape sequence: \\".concat(String.fromCharCode(c),"."))}++o,a=o}}throw ue(e,o,"Unterminated string.")}function Bp(e,t,n,r,i,s){for(var o=e.body,a=t+3,c=a,u=0,l="";a<o.length&&!isNaN(u=o.charCodeAt(a));){if(u===34&&o.charCodeAt(a+1)===34&&o.charCodeAt(a+2)===34)return l+=o.slice(c,a),new H(y.BLOCK_STRING,t,a+3,n,r,i,_p(l));if(u<32&&u!==9&&u!==10&&u!==13)throw ue(e,a,"Invalid character within String: ".concat(rt(u),"."));u===10?(++a,++s.line,s.lineStart=a):u===13?(o.charCodeAt(a+1)===10?a+=2:++a,++s.line,s.lineStart=a):u===92&&o.charCodeAt(a+1)===34&&o.charCodeAt(a+2)===34&&o.charCodeAt(a+3)===34?(l+=o.slice(c,a)+'"""',a+=4,c=a):++a}throw ue(e,a,"Unterminated string.")}function Kp(e,t,n,r){return yn(e)<<12|yn(t)<<8|yn(n)<<4|yn(r)}function yn(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function Vp(e,t,n,r,i){for(var s=e.body,o=s.length,a=t+1,c=0;a!==o&&!isNaN(c=s.charCodeAt(a))&&(c===95||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122);)++a;return new H(y.NAME,t,a,n,r,i,s.slice(t,a))}function jp(e){return e===95||e>=65&&e<=90||e>=97&&e<=122}function dr(e,t){var n=new Hp(e,t);return n.parseDocument()}var Hp=function(){function e(n,r){var i=Pp(n)?n:new Da(n);this._lexer=new Dp(i),this._options=r}var t=e.prototype;return t.parseName=function(){var r=this.expectToken(y.NAME);return{kind:N.NAME,value:r.value,loc:this.loc(r)}},t.parseDocument=function(){var r=this._lexer.token;return{kind:N.DOCUMENT,definitions:this.many(y.SOF,this.parseDefinition,y.EOF),loc:this.loc(r)}},t.parseDefinition=function(){if(this.peek(y.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(y.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var r=this._lexer.token;if(this.peek(y.BRACE_L))return{kind:N.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(r)};var i=this.parseOperationType(),s;return this.peek(y.NAME)&&(s=this.parseName()),{kind:N.OPERATION_DEFINITION,operation:i,name:s,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(r)}},t.parseOperationType=function(){var r=this.expectToken(y.NAME);switch(r.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(r)},t.parseVariableDefinitions=function(){return this.optionalMany(y.PAREN_L,this.parseVariableDefinition,y.PAREN_R)},t.parseVariableDefinition=function(){var r=this._lexer.token;return{kind:N.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(y.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(y.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(r)}},t.parseVariable=function(){var r=this._lexer.token;return this.expectToken(y.DOLLAR),{kind:N.VARIABLE,name:this.parseName(),loc:this.loc(r)}},t.parseSelectionSet=function(){var r=this._lexer.token;return{kind:N.SELECTION_SET,selections:this.many(y.BRACE_L,this.parseSelection,y.BRACE_R),loc:this.loc(r)}},t.parseSelection=function(){return this.peek(y.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var r=this._lexer.token,i=this.parseName(),s,o;return this.expectOptionalToken(y.COLON)?(s=i,o=this.parseName()):o=i,{kind:N.FIELD,alias:s,name:o,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(y.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(r)}},t.parseArguments=function(r){var i=r?this.parseConstArgument:this.parseArgument;return this.optionalMany(y.PAREN_L,i,y.PAREN_R)},t.parseArgument=function(){var r=this._lexer.token,i=this.parseName();return this.expectToken(y.COLON),{kind:N.ARGUMENT,name:i,value:this.parseValueLiteral(!1),loc:this.loc(r)}},t.parseConstArgument=function(){var r=this._lexer.token;return{kind:N.ARGUMENT,name:this.parseName(),value:(this.expectToken(y.COLON),this.parseValueLiteral(!0)),loc:this.loc(r)}},t.parseFragment=function(){var r=this._lexer.token;this.expectToken(y.SPREAD);var i=this.expectOptionalKeyword("on");return!i&&this.peek(y.NAME)?{kind:N.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(r)}:{kind:N.INLINE_FRAGMENT,typeCondition:i?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(r)}},t.parseFragmentDefinition=function(){var r,i=this._lexer.token;return this.expectKeyword("fragment"),((r=this._options)===null||r===void 0?void 0:r.experimentalFragmentVariables)===!0?{kind:N.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(i)}:{kind:N.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(i)}},t.parseFragmentName=function(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(r){var i=this._lexer.token;switch(i.kind){case y.BRACKET_L:return this.parseList(r);case y.BRACE_L:return this.parseObject(r);case y.INT:return this._lexer.advance(),{kind:N.INT,value:i.value,loc:this.loc(i)};case y.FLOAT:return this._lexer.advance(),{kind:N.FLOAT,value:i.value,loc:this.loc(i)};case y.STRING:case y.BLOCK_STRING:return this.parseStringLiteral();case y.NAME:switch(this._lexer.advance(),i.value){case"true":return{kind:N.BOOLEAN,value:!0,loc:this.loc(i)};case"false":return{kind:N.BOOLEAN,value:!1,loc:this.loc(i)};case"null":return{kind:N.NULL,loc:this.loc(i)};default:return{kind:N.ENUM,value:i.value,loc:this.loc(i)}}case y.DOLLAR:if(!r)return this.parseVariable();break}throw this.unexpected()},t.parseStringLiteral=function(){var r=this._lexer.token;return this._lexer.advance(),{kind:N.STRING,value:r.value,block:r.kind===y.BLOCK_STRING,loc:this.loc(r)}},t.parseList=function(r){var i=this,s=this._lexer.token,o=function(){return i.parseValueLiteral(r)};return{kind:N.LIST,values:this.any(y.BRACKET_L,o,y.BRACKET_R),loc:this.loc(s)}},t.parseObject=function(r){var i=this,s=this._lexer.token,o=function(){return i.parseObjectField(r)};return{kind:N.OBJECT,fields:this.any(y.BRACE_L,o,y.BRACE_R),loc:this.loc(s)}},t.parseObjectField=function(r){var i=this._lexer.token,s=this.parseName();return this.expectToken(y.COLON),{kind:N.OBJECT_FIELD,name:s,value:this.parseValueLiteral(r),loc:this.loc(i)}},t.parseDirectives=function(r){for(var i=[];this.peek(y.AT);)i.push(this.parseDirective(r));return i},t.parseDirective=function(r){var i=this._lexer.token;return this.expectToken(y.AT),{kind:N.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(r),loc:this.loc(i)}},t.parseTypeReference=function(){var r=this._lexer.token,i;return this.expectOptionalToken(y.BRACKET_L)?(i=this.parseTypeReference(),this.expectToken(y.BRACKET_R),i={kind:N.LIST_TYPE,type:i,loc:this.loc(r)}):i=this.parseNamedType(),this.expectOptionalToken(y.BANG)?{kind:N.NON_NULL_TYPE,type:i,loc:this.loc(r)}:i},t.parseNamedType=function(){var r=this._lexer.token;return{kind:N.NAMED_TYPE,name:this.parseName(),loc:this.loc(r)}},t.parseTypeSystemDefinition=function(){var r=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(r.kind===y.NAME)switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(r)},t.peekDescription=function(){return this.peek(y.STRING)||this.peek(y.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("schema");var s=this.parseDirectives(!0),o=this.many(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);return{kind:N.SCHEMA_DEFINITION,description:i,directives:s,operationTypes:o,loc:this.loc(r)}},t.parseOperationTypeDefinition=function(){var r=this._lexer.token,i=this.parseOperationType();this.expectToken(y.COLON);var s=this.parseNamedType();return{kind:N.OPERATION_TYPE_DEFINITION,operation:i,type:s,loc:this.loc(r)}},t.parseScalarTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("scalar");var s=this.parseName(),o=this.parseDirectives(!0);return{kind:N.SCALAR_TYPE_DEFINITION,description:i,name:s,directives:o,loc:this.loc(r)}},t.parseObjectTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("type");var s=this.parseName(),o=this.parseImplementsInterfaces(),a=this.parseDirectives(!0),c=this.parseFieldsDefinition();return{kind:N.OBJECT_TYPE_DEFINITION,description:i,name:s,interfaces:o,directives:a,fields:c,loc:this.loc(r)}},t.parseImplementsInterfaces=function(){var r;if(!this.expectOptionalKeyword("implements"))return[];if(((r=this._options)===null||r===void 0?void 0:r.allowLegacySDLImplementsInterfaces)===!0){var i=[];this.expectOptionalToken(y.AMP);do i.push(this.parseNamedType());while(this.expectOptionalToken(y.AMP)||this.peek(y.NAME));return i}return this.delimitedMany(y.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var r;return((r=this._options)===null||r===void 0?void 0:r.allowLegacySDLEmptyFields)===!0&&this.peek(y.BRACE_L)&&this._lexer.lookahead().kind===y.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(y.BRACE_L,this.parseFieldDefinition,y.BRACE_R)},t.parseFieldDefinition=function(){var r=this._lexer.token,i=this.parseDescription(),s=this.parseName(),o=this.parseArgumentDefs();this.expectToken(y.COLON);var a=this.parseTypeReference(),c=this.parseDirectives(!0);return{kind:N.FIELD_DEFINITION,description:i,name:s,arguments:o,type:a,directives:c,loc:this.loc(r)}},t.parseArgumentDefs=function(){return this.optionalMany(y.PAREN_L,this.parseInputValueDef,y.PAREN_R)},t.parseInputValueDef=function(){var r=this._lexer.token,i=this.parseDescription(),s=this.parseName();this.expectToken(y.COLON);var o=this.parseTypeReference(),a;this.expectOptionalToken(y.EQUALS)&&(a=this.parseValueLiteral(!0));var c=this.parseDirectives(!0);return{kind:N.INPUT_VALUE_DEFINITION,description:i,name:s,type:o,defaultValue:a,directives:c,loc:this.loc(r)}},t.parseInterfaceTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("interface");var s=this.parseName(),o=this.parseImplementsInterfaces(),a=this.parseDirectives(!0),c=this.parseFieldsDefinition();return{kind:N.INTERFACE_TYPE_DEFINITION,description:i,name:s,interfaces:o,directives:a,fields:c,loc:this.loc(r)}},t.parseUnionTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("union");var s=this.parseName(),o=this.parseDirectives(!0),a=this.parseUnionMemberTypes();return{kind:N.UNION_TYPE_DEFINITION,description:i,name:s,directives:o,types:a,loc:this.loc(r)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(y.EQUALS)?this.delimitedMany(y.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("enum");var s=this.parseName(),o=this.parseDirectives(!0),a=this.parseEnumValuesDefinition();return{kind:N.ENUM_TYPE_DEFINITION,description:i,name:s,directives:o,values:a,loc:this.loc(r)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(y.BRACE_L,this.parseEnumValueDefinition,y.BRACE_R)},t.parseEnumValueDefinition=function(){var r=this._lexer.token,i=this.parseDescription(),s=this.parseName(),o=this.parseDirectives(!0);return{kind:N.ENUM_VALUE_DEFINITION,description:i,name:s,directives:o,loc:this.loc(r)}},t.parseInputObjectTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("input");var s=this.parseName(),o=this.parseDirectives(!0),a=this.parseInputFieldsDefinition();return{kind:N.INPUT_OBJECT_TYPE_DEFINITION,description:i,name:s,directives:o,fields:a,loc:this.loc(r)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(y.BRACE_L,this.parseInputValueDef,y.BRACE_R)},t.parseTypeSystemExtension=function(){var r=this._lexer.lookahead();if(r.kind===y.NAME)switch(r.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(r)},t.parseSchemaExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var i=this.parseDirectives(!0),s=this.optionalMany(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);if(i.length===0&&s.length===0)throw this.unexpected();return{kind:N.SCHEMA_EXTENSION,directives:i,operationTypes:s,loc:this.loc(r)}},t.parseScalarTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var i=this.parseName(),s=this.parseDirectives(!0);if(s.length===0)throw this.unexpected();return{kind:N.SCALAR_TYPE_EXTENSION,name:i,directives:s,loc:this.loc(r)}},t.parseObjectTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var i=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),a=this.parseFieldsDefinition();if(s.length===0&&o.length===0&&a.length===0)throw this.unexpected();return{kind:N.OBJECT_TYPE_EXTENSION,name:i,interfaces:s,directives:o,fields:a,loc:this.loc(r)}},t.parseInterfaceTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var i=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),a=this.parseFieldsDefinition();if(s.length===0&&o.length===0&&a.length===0)throw this.unexpected();return{kind:N.INTERFACE_TYPE_EXTENSION,name:i,interfaces:s,directives:o,fields:a,loc:this.loc(r)}},t.parseUnionTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var i=this.parseName(),s=this.parseDirectives(!0),o=this.parseUnionMemberTypes();if(s.length===0&&o.length===0)throw this.unexpected();return{kind:N.UNION_TYPE_EXTENSION,name:i,directives:s,types:o,loc:this.loc(r)}},t.parseEnumTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var i=this.parseName(),s=this.parseDirectives(!0),o=this.parseEnumValuesDefinition();if(s.length===0&&o.length===0)throw this.unexpected();return{kind:N.ENUM_TYPE_EXTENSION,name:i,directives:s,values:o,loc:this.loc(r)}},t.parseInputObjectTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var i=this.parseName(),s=this.parseDirectives(!0),o=this.parseInputFieldsDefinition();if(s.length===0&&o.length===0)throw this.unexpected();return{kind:N.INPUT_OBJECT_TYPE_EXTENSION,name:i,directives:s,fields:o,loc:this.loc(r)}},t.parseDirectiveDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("directive"),this.expectToken(y.AT);var s=this.parseName(),o=this.parseArgumentDefs(),a=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var c=this.parseDirectiveLocations();return{kind:N.DIRECTIVE_DEFINITION,description:i,name:s,arguments:o,repeatable:a,locations:c,loc:this.loc(r)}},t.parseDirectiveLocations=function(){return this.delimitedMany(y.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var r=this._lexer.token,i=this.parseName();if(Rp[i.value]!==void 0)return i;throw this.unexpected(r)},t.loc=function(r){var i;if(((i=this._options)===null||i===void 0?void 0:i.noLocation)!==!0)return new _a(r,this._lexer.lastToken,this._lexer.source)},t.peek=function(r){return this._lexer.token.kind===r},t.expectToken=function(r){var i=this._lexer.token;if(i.kind===r)return this._lexer.advance(),i;throw ue(this._lexer.source,i.start,"Expected ".concat(La(r),", found ").concat(hr(i),"."))},t.expectOptionalToken=function(r){var i=this._lexer.token;if(i.kind===r)return this._lexer.advance(),i},t.expectKeyword=function(r){var i=this._lexer.token;if(i.kind===y.NAME&&i.value===r)this._lexer.advance();else throw ue(this._lexer.source,i.start,'Expected "'.concat(r,'", found ').concat(hr(i),"."))},t.expectOptionalKeyword=function(r){var i=this._lexer.token;return i.kind===y.NAME&&i.value===r?(this._lexer.advance(),!0):!1},t.unexpected=function(r){var i=r??this._lexer.token;return ue(this._lexer.source,i.start,"Unexpected ".concat(hr(i),"."))},t.any=function(r,i,s){this.expectToken(r);for(var o=[];!this.expectOptionalToken(s);)o.push(i.call(this));return o},t.optionalMany=function(r,i,s){if(this.expectOptionalToken(r)){var o=[];do o.push(i.call(this));while(!this.expectOptionalToken(s));return o}return[]},t.many=function(r,i,s){this.expectToken(r);var o=[];do o.push(i.call(this));while(!this.expectOptionalToken(s));return o},t.delimitedMany=function(r,i){this.expectOptionalToken(r);var s=[];do s.push(i.call(this));while(this.expectOptionalToken(r));return s},e}();function hr(e){var t=e.value;return La(e.kind)+(t!=null?' "'.concat(t,'"'):"")}function La(e){return Lp(e)?'"'.concat(e,'"'):e}var Gp={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Wp=Object.freeze({});function zp(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gp,r=void 0,i=Array.isArray(e),s=[e],o=-1,a=[],c=void 0,u=void 0,l=void 0,d=[],h=[],f=e;do{o++;var p=o===s.length,g=p&&a.length!==0;if(p){if(u=h.length===0?void 0:d[d.length-1],c=l,l=h.pop(),g){if(i)c=c.slice();else{for(var m={},E=0,S=Object.keys(c);E<S.length;E++){var w=S[E];m[w]=c[w]}c=m}for(var I=0,v=0;v<a.length;v++){var A=a[v][0],_=a[v][1];i&&(A-=I),i&&_===null?(c.splice(A,1),I++):c[A]=_}}o=r.index,s=r.keys,a=r.edits,i=r.inArray,r=r.prev}else{if(u=l?i?o:s[o]:void 0,c=l?l[u]:f,c==null)continue;l&&d.push(u)}var O=void 0;if(!Array.isArray(c)){if(!Vs(c))throw new Error("Invalid AST Node: ".concat(Oa(c),"."));var D=Yp(t,c.kind,p);if(D){if(O=D.call(t,c,u,l,d,h),O===Wp)break;if(O===!1){if(!p){d.pop();continue}}else if(O!==void 0&&(a.push([u,O]),!p))if(Vs(O))c=O;else{d.pop();continue}}}if(O===void 0&&g&&a.push([u,c]),p)d.pop();else{var $;r={inArray:i,index:o,keys:s,edits:a,prev:r},i=Array.isArray(c),s=i?c:($=n[c.kind])!==null&&$!==void 0?$:[],o=-1,a=[],l&&h.push(l),l=c}}while(r!==void 0);return a.length!==0&&(f=a[a.length-1][1]),f}function Yp(e,t,n){var r=e[t];if(r){if(!n&&typeof r=="function")return r;var i=n?r.leave:r.enter;if(typeof i=="function")return i}else{var s=n?e.leave:e.enter;if(s){if(typeof s=="function")return s;var o=s[t];if(typeof o=="function")return o}}}function Lt(e){return zp(e,{leave:Qp})}var Jp=80,Qp={Name:function(t){return t.value},Variable:function(t){return"$"+t.name},Document:function(t){return b(t.definitions,`

`)+`
`},OperationDefinition:function(t){var n=t.operation,r=t.name,i=V("(",b(t.variableDefinitions,", "),")"),s=b(t.directives," "),o=t.selectionSet;return!r&&!s&&!i&&n==="query"?o:b([n,b([r,i]),s,o]," ")},VariableDefinition:function(t){var n=t.variable,r=t.type,i=t.defaultValue,s=t.directives;return n+": "+r+V(" = ",i)+V(" ",b(s," "))},SelectionSet:function(t){var n=t.selections;return Ie(n)},Field:function(t){var n=t.alias,r=t.name,i=t.arguments,s=t.directives,o=t.selectionSet,a=V("",n,": ")+r,c=a+V("(",b(i,", "),")");return c.length>Jp&&(c=a+V(`(
`,Cn(b(i,`
`)),`
)`)),b([c,b(s," "),o]," ")},Argument:function(t){var n=t.name,r=t.value;return n+": "+r},FragmentSpread:function(t){var n=t.name,r=t.directives;return"..."+n+V(" ",b(r," "))},InlineFragment:function(t){var n=t.typeCondition,r=t.directives,i=t.selectionSet;return b(["...",V("on ",n),b(r," "),i]," ")},FragmentDefinition:function(t){var n=t.name,r=t.typeCondition,i=t.variableDefinitions,s=t.directives,o=t.selectionSet;return"fragment ".concat(n).concat(V("(",b(i,", "),")")," ")+"on ".concat(r," ").concat(V("",b(s," ")," "))+o},IntValue:function(t){var n=t.value;return n},FloatValue:function(t){var n=t.value;return n},StringValue:function(t,n){var r=t.value,i=t.block;return i?Op(r,n==="description"?"":"  "):JSON.stringify(r)},BooleanValue:function(t){var n=t.value;return n?"true":"false"},NullValue:function(){return"null"},EnumValue:function(t){var n=t.value;return n},ListValue:function(t){var n=t.values;return"["+b(n,", ")+"]"},ObjectValue:function(t){var n=t.fields;return"{"+b(n,", ")+"}"},ObjectField:function(t){var n=t.name,r=t.value;return n+": "+r},Directive:function(t){var n=t.name,r=t.arguments;return"@"+n+V("(",b(r,", "),")")},NamedType:function(t){var n=t.name;return n},ListType:function(t){var n=t.type;return"["+n+"]"},NonNullType:function(t){var n=t.type;return n+"!"},SchemaDefinition:Se(function(e){var t=e.directives,n=e.operationTypes;return b(["schema",b(t," "),Ie(n)]," ")}),OperationTypeDefinition:function(t){var n=t.operation,r=t.type;return n+": "+r},ScalarTypeDefinition:Se(function(e){var t=e.name,n=e.directives;return b(["scalar",t,b(n," ")]," ")}),ObjectTypeDefinition:Se(function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return b(["type",t,V("implements ",b(n," & ")),b(r," "),Ie(i)]," ")}),FieldDefinition:Se(function(e){var t=e.name,n=e.arguments,r=e.type,i=e.directives;return t+(Hs(n)?V(`(
`,Cn(b(n,`
`)),`
)`):V("(",b(n,", "),")"))+": "+r+V(" ",b(i," "))}),InputValueDefinition:Se(function(e){var t=e.name,n=e.type,r=e.defaultValue,i=e.directives;return b([t+": "+n,V("= ",r),b(i," ")]," ")}),InterfaceTypeDefinition:Se(function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return b(["interface",t,V("implements ",b(n," & ")),b(r," "),Ie(i)]," ")}),UnionTypeDefinition:Se(function(e){var t=e.name,n=e.directives,r=e.types;return b(["union",t,b(n," "),r&&r.length!==0?"= "+b(r," | "):""]," ")}),EnumTypeDefinition:Se(function(e){var t=e.name,n=e.directives,r=e.values;return b(["enum",t,b(n," "),Ie(r)]," ")}),EnumValueDefinition:Se(function(e){var t=e.name,n=e.directives;return b([t,b(n," ")]," ")}),InputObjectTypeDefinition:Se(function(e){var t=e.name,n=e.directives,r=e.fields;return b(["input",t,b(n," "),Ie(r)]," ")}),DirectiveDefinition:Se(function(e){var t=e.name,n=e.arguments,r=e.repeatable,i=e.locations;return"directive @"+t+(Hs(n)?V(`(
`,Cn(b(n,`
`)),`
)`):V("(",b(n,", "),")"))+(r?" repeatable":"")+" on "+b(i," | ")}),SchemaExtension:function(t){var n=t.directives,r=t.operationTypes;return b(["extend schema",b(n," "),Ie(r)]," ")},ScalarTypeExtension:function(t){var n=t.name,r=t.directives;return b(["extend scalar",n,b(r," ")]," ")},ObjectTypeExtension:function(t){var n=t.name,r=t.interfaces,i=t.directives,s=t.fields;return b(["extend type",n,V("implements ",b(r," & ")),b(i," "),Ie(s)]," ")},InterfaceTypeExtension:function(t){var n=t.name,r=t.interfaces,i=t.directives,s=t.fields;return b(["extend interface",n,V("implements ",b(r," & ")),b(i," "),Ie(s)]," ")},UnionTypeExtension:function(t){var n=t.name,r=t.directives,i=t.types;return b(["extend union",n,b(r," "),i&&i.length!==0?"= "+b(i," | "):""]," ")},EnumTypeExtension:function(t){var n=t.name,r=t.directives,i=t.values;return b(["extend enum",n,b(r," "),Ie(i)]," ")},InputObjectTypeExtension:function(t){var n=t.name,r=t.directives,i=t.fields;return b(["extend input",n,b(r," "),Ie(i)]," ")}};function Se(e){return function(t){return b([t.description,e(t)],`
`)}}function b(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(t=e==null?void 0:e.filter(function(r){return r}).join(n))!==null&&t!==void 0?t:""}function Ie(e){return V(`{
`,Cn(b(e,`
`)),`
}`)}function V(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return t!=null&&t!==""?e+t+n:""}function Cn(e){return V("  ",e.replace(/\n/g,`
  `))}function Xp(e){return e.indexOf(`
`)!==-1}function Hs(e){return e!=null&&e.some(Xp)}class Jt extends On{constructor(t){super(t),this.constructor=Jt,Object.setPrototypeOf(this,Jt.prototype)}}class Qt extends Jt{constructor(t={}){super({name:"CanceledError",message:"Request is canceled by user",...t}),this.constructor=Qt,Object.setPrototypeOf(this,Qt.prototype)}}const Zp=e=>!!e&&e instanceof Qt;var _r;(function(e){e.InvalidApiName="InvalidApiName"})(_r||(_r={}));_r.InvalidApiName+"";const Ma=async e=>{var n;if(!e)return;const t=await ot(eg(e));if(t){const r=await((n=e.body)==null?void 0:n.text());return tg(t,{statusCode:e.statusCode,headers:e.headers,body:r})}},eg=e=>{let t;const n=new Proxy(e.body,{get(i,s,o){return s==="json"?async()=>{t||(t=i.text());try{return JSON.parse(await t)}catch{return{}}}:s==="text"?async()=>(t||(t=i.text()),t):Reflect.get(i,s,o)}});return new Proxy(e,{get(i,s,o){return s==="body"?n:Reflect.get(i,s,o)}})},tg=(e,t)=>{const n=new Jt({name:e==null?void 0:e.name,message:e.message,underlyingError:e,response:t});return Object.assign(n,{$metadata:e.$metadata})},kr=new X("RestApis");function ng(e,t){const n=c=>!!t,r=new AbortController,i=r.signal,s=t==null?void 0:t.signal;let o;const a=async()=>{try{const c=await(n(e)?e():e(i));if(c.statusCode>=300)throw await Ma(c);return c}catch(c){const u=s??i,l=o??u.reason;if(c.name==="AbortError"||(u==null?void 0:u.aborted)===!0){const d=new Qt({...l&&{message:l},underlyingError:c,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw kr.debug(c),d}throw kr.debug(c),c}};if(n())return a();{const c=u=>{i.aborted!==!0&&(r.abort(u),u&&i.reason!==u&&(o=u))};return{response:a(),cancel:c}}}const Gs="execute-api",rg="us-east-1",ig=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,sg=(e,t)=>{const{service:n=Gs,region:r=rg}={},{hostname:i}=e,[,s,o]=ig.exec(i)??[];return s===Gs?{service:s,region:o??r}:s==="appsync-api"?{service:"appsync",region:o??r}:{service:n,region:r}},og=({headers:e},t)=>!e.authorization&&!e["x-api-key"]&&!!t,ag=(e,t)=>{const n={};for(const r in e)n[r.toLowerCase()]=e[r];return t&&(n["content-type"]="application/json; charset=UTF-8",t instanceof FormData&&delete n["content-type"]),n},cg=tn(Zr,[Xr,Qr,ad]),ug=tn(Zr,[Xr,Qr]),lg=async(e,t,n,r)=>{var S,w,I;const{url:i,method:s,headers:o,body:a,withCredentials:c,abortSignal:u,retryStrategy:l}=t,d=a?a instanceof FormData?a:JSON.stringify(a??""):void 0,h=ag(o,a),f={url:i,headers:h,method:s,body:d},p={retryDecider:dg(l??((I=(w=(S=e==null?void 0:e.libraryOptions)==null?void 0:S.API)==null?void 0:w.REST)==null?void 0:I.retryStrategy)),computeDelay:Yr,withCrossDomainCredentials:c,abortSignal:u},g=n(f,r);let m;const E=await hg(e);if(g&&E){const v=sg(i),A=(r==null?void 0:r.service)??v.service,_=(r==null?void 0:r.region)??v.region;m=await cg(f,{...p,credentials:E,region:_,service:A})}else m=await ug(f,{...p});return{statusCode:m.statusCode,headers:m.headers,body:m.body}},dg=e=>(e==null?void 0:e.strategy)==="no-retry"?()=>Promise.resolve({retryable:!1}):Jr(Ma),hg=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch{kr.debug("No credentials available, the request will be unsigned.")}return null},li=new WeakMap,fg=(e,{url:t,options:n,abortController:r})=>{const i=r??new AbortController,o=ng(async()=>lg(e,{url:t,method:"POST",...n,abortSignal:i.signal,retryStrategy:{strategy:"jittered-exponential-backoff"}},og,n==null?void 0:n.signingServiceInfo),i).finally(()=>{li.delete(o)});return o},pg=(e,t)=>{const n=li.get(e);return n?(n.abort(t),t&&n.signal.reason!==t&&(n.signal.reason=t),!0):!1},gg=(e,t)=>{li.set(e,t)},mg=5e3,yg=[400,401,403],Eg=["BadRequestException","UnauthorizedException"],vg="ConnectionStateChange";var pe;(function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error",e.EVENT_SUBSCRIBE="subscribe",e.EVENT_PUBLISH="publish",e.EVENT_SUBSCRIBE_ACK="subscribe_success",e.EVENT_PUBLISH_ACK="publish_success",e.EVENT_STOP="unsubscribe",e.EVENT_COMPLETE="unsubscribe_success"})(pe||(pe={}));var Le;(function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"})(Le||(Le={}));var ie;(function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"})(ie||(ie={}));const Sg={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},Ws=15e3,Ig=15e3,wg=5*60*1e3,Tg=5*1e3,bg=65*1e3,Ag=5*1e3,Ng=60*1e3;var we;(function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"})(we||(we={}));var Q;(function(e){e.Connected="Connected",e.ConnectedPendingNetwork="ConnectedPendingNetwork",e.ConnectionDisrupted="ConnectionDisrupted",e.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",e.Connecting="Connecting",e.ConnectedPendingDisconnect="ConnectedPendingDisconnect",e.Disconnected="Disconnected",e.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive"})(Q||(Q={}));const zs=()=>new dt().networkMonitor(),fe={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class Cg{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=zs().subscribe(({online:t})=>{var n;this.record(t?fe.ONLINE:fe.OFFLINE),(n=this._initialNetworkStateSubscription)==null||n.unsubscribe()}),this._linkedConnectionStateObservable=new ae(t=>{t.next(this._linkedConnectionState),this._linkedConnectionStateObserver=t})}enableNetworkMonitoring(){var t;(t=this._initialNetworkStateSubscription)==null||t.unsubscribe(),this._networkMonitoringSubscription===void 0&&(this._networkMonitoringSubscription=zs().subscribe(({online:n})=>{this.record(n?fe.ONLINE:fe.OFFLINE)}))}disableNetworkMonitoring(){var t;(t=this._networkMonitoringSubscription)==null||t.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let t;return this._linkedConnectionStateObservable.pipe(Wr(n=>this.connectionStatesTranslator(n))).pipe(tl(n=>{const r=n!==t;return t=n,r}))}record(t){var r;t.intendedConnectionState==="connected"?this.enableNetworkMonitoring():t.intendedConnectionState==="disconnected"&&this.disableNetworkMonitoring();const n={...this._linkedConnectionState,...t};this._linkedConnectionState={...n},(r=this._linkedConnectionStateObserver)==null||r.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState:t,networkState:n,intendedConnectionState:r,keepAliveState:i}){return t==="connected"&&n==="disconnected"?Q.ConnectedPendingNetwork:t==="connected"&&r==="disconnected"?Q.ConnectedPendingDisconnect:t==="disconnected"&&r==="connected"&&n==="disconnected"?Q.ConnectionDisruptedPendingNetwork:t==="disconnected"&&r==="connected"?Q.ConnectionDisrupted:t==="connected"&&i==="unhealthy"?Q.ConnectedPendingKeepAlive:t==="connecting"?Q.Connecting:t==="disconnected"?Q.Disconnected:Q.Connected}}var yt;(function(e){e.START_RECONNECT="START_RECONNECT",e.HALT_RECONNECT="HALT_RECONNECT"})(yt||(yt={}));class xg{constructor(){this.reconnectObservers=[]}addObserver(t){this.reconnectObservers.push(t)}record(t){t===yt.START_RECONNECT&&this.reconnectSetTimeoutId===void 0&&this.reconnectIntervalId===void 0&&(this.reconnectSetTimeoutId=setTimeout(()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval(()=>{this._triggerReconnect()},Ng)},Ag)),t===yt.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach(t=>{var n;(n=t.complete)==null||n.call(t)})}_triggerReconnect(){this.reconnectObservers.forEach(t=>{var n;(n=t.next)==null||n.call(t)})}}const Ys="wss://",Pg=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i,Rg=/^https:\/\/\w{26}\.\w+-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/event$/i,Js="/realtime",_g=e=>e.match(Pg)===null,kg=e=>e.match(Rg)!==null,Og=e=>{let t=e??"";return kg(t)?t=t.concat(Js).replace("ddpg-api","grt-gamma").replace("appsync-api","appsync-realtime-api"):_g(t)?t=t.concat(Js):t=t.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta").replace("ddpg-api","grt-gamma"),t=t.replace("https://",Ys).replace("http://",Ys),new Pe(t)},Dg=e=>{if(!e)return{};if("Authorization"in e){const{Authorization:t,...n}=e;return n}return e},Lg=e=>{const t=Dg(e),n=new ea;return Object.entries(t).forEach(([r,i])=>{n.append(r,i)}),n},Mg=(e,t)=>{const n=Og(e),r=new ea(n.search);for(const[i,s]of t.entries())r.append(i,s);return n.search=r.toString(),n.toString()},fr=async e=>{const{appSyncGraphqlEndpoint:t,query:n,libraryConfigHeaders:r=()=>({}),additionalHeaders:i={},authToken:s}=e;let o={};const a=await r();return typeof i=="function"?o=await i({url:t||"",queryString:n||""}):o=i,s&&(o={...o,Authorization:s}),{additionalCustomHeaders:o,libraryConfigHeaders:a}},Qs=new X("AWSAppSyncRealTimeProvider Auth"),Xs=async({host:e})=>{var n,r;const t=await zr();return{Authorization:(r=(n=t==null?void 0:t.tokens)==null?void 0:n.accessToken)==null?void 0:r.toString(),host:e}},Ug=async({apiKey:e,host:t})=>{const r=new Date().toISOString().replace(/[:-]|\.\d{3}/g,"");return{host:t,"x-amz-date":r,"x-api-key":e}},Fg=async({payload:e,canonicalUri:t,appSyncGraphqlEndpoint:n,region:r})=>{const i={region:r,service:"appsync"},s=(await zr()).credentials,o={url:`${n}${t}`,data:e,method:"POST",headers:{...Sg}};return ca({headers:o.headers,method:o.method,url:new Pe(o.url),body:o.data},{credentials:s,signingRegion:i.region,signingService:i.service}).headers},Zs=async({host:e,additionalCustomHeaders:t})=>{if(!(t!=null&&t.Authorization))throw new Error("No auth token specified");return{Authorization:t.Authorization,host:e}},Ua=async({apiKey:e,authenticationType:t,canonicalUri:n,appSyncGraphqlEndpoint:r,region:i,additionalCustomHeaders:s,payload:o})=>{const a={apiKey:Ug,iam:Fg,oidc:Xs,userPool:Xs,lambda:Zs,none:Zs};if(!t||!a[t]){Qs.debug(`Authentication type ${t} not supported`);return}else{const c=a[t],u=r?new Pe(r).host:void 0,l=t==="apiKey"?e:void 0;return Qs.debug(`Authenticating with ${JSON.stringify(t)}`),await c({payload:o,canonicalUri:n,appSyncGraphqlEndpoint:r,apiKey:l,region:i,host:u,additionalCustomHeaders:s})}},eo=e=>{Qe.dispatch("api",e,"PubSub",Je)};class qg{constructor(t){this.subscriptionObserverMap=new Map,this.allowNoSubscriptions=!1,this.socketStatus=ie.CLOSED,this.keepAliveTimestamp=Date.now(),this.promiseArray=[],this.connectionStateMonitor=new Cg,this.reconnectionMonitor=new xg,this._establishConnection=async(n,r)=>{this.logger.debug(`Establishing WebSocket connection to ${n}`);try{await this._openConnection(n,r),await this._initiateHandshake()}catch(i){const{errorType:s,errorCode:o}=i;throw yg.includes(o)||Eg.includes(s)?new ud(s):s?new Error(s):i}},this.logger=new X(t.providerName),this.wsProtocolName=t.wsProtocolName,this.wsConnectUri=t.connectUri,this.connectionStateMonitorSubscription=this._startConnectionStateMonitoring()}close(){return this.socketStatus=ie.CLOSED,this.connectionStateMonitor.record(fe.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close(),new Promise((t,n)=>{this.awsRealTimeSocket?(this.awsRealTimeSocket.onclose=r=>{this._closeSocket(),this.subscriptionObserverMap=new Map,this.awsRealTimeSocket=void 0,t()},this.awsRealTimeSocket.onerror=r=>{n(r)},this.awsRealTimeSocket.close()):t()})}subscribe(t,n){return new ae(r=>{if(!(t!=null&&t.appSyncGraphqlEndpoint)){r.error({errors:[{...new Vt("Subscribe only available for AWS AppSync endpoint")}]}),r.complete();return}let i=!1;const s=Sr(),o=()=>{i||(i=!0,this._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:r,subscriptionId:s,customUserAgentDetails:n}).catch(c=>{this.logger.debug(`${we.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${c}`),this._closeSocket()}).finally(()=>{i=!1}))},a=new ae(c=>{this.reconnectionMonitor.addObserver(c)}).subscribe(()=>{o()});return o(),async()=>{await this._cleanupSubscription(s,a)}})}async connect(t){this.socketStatus!==ie.READY&&await this._connectWebSocket(t)}async publish(t,n){if(this.socketStatus!==ie.READY)throw new Error("Subscription has not been initialized");return this._publishMessage(t,n)}async _connectWebSocket(t){const{apiKey:n,appSyncGraphqlEndpoint:r,authenticationType:i,region:s}=t,{additionalCustomHeaders:o}=await fr(t);this.connectionStateMonitor.record(fe.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey:n,appSyncGraphqlEndpoint:r,authenticationType:i,region:s,additionalCustomHeaders:o})}async _publishMessage(t,n){const r=Sr(),{additionalCustomHeaders:i,libraryConfigHeaders:s}=await fr(t),o=await this._prepareSubscriptionPayload({options:t,subscriptionId:r,customUserAgentDetails:n,additionalCustomHeaders:i,libraryConfigHeaders:s,publish:!0});return new Promise((a,c)=>{if(this.awsRealTimeSocket){const u=f=>{const p=JSON.parse(f.data);if(p.id===r&&p.type==="publish_success"&&(this.awsRealTimeSocket&&this.awsRealTimeSocket.removeEventListener("message",u),h(),a()),p.errors&&p.errors.length>0){const g=p.errors.map(m=>m.errorType);h(),c(new Error(`Publish errors: ${g.join(", ")}`))}},l=f=>{h(),c(new Error(`WebSocket error: ${f}`))},d=()=>{h(),c(new Error("WebSocket is closed"))},h=()=>{var f,p,g;(f=this.awsRealTimeSocket)==null||f.removeEventListener("message",u),(p=this.awsRealTimeSocket)==null||p.removeEventListener("error",l),(g=this.awsRealTimeSocket)==null||g.removeEventListener("close",d)};this.awsRealTimeSocket.addEventListener("message",u),this.awsRealTimeSocket.addEventListener("error",l),this.awsRealTimeSocket.addEventListener("close",d),this.awsRealTimeSocket.send(o)}else c(new Error("WebSocket is not connected"))})}async _cleanupSubscription(t,n){n==null||n.unsubscribe();try{await this._waitForSubscriptionToBeConnected(t);const{subscriptionState:r}=this.subscriptionObserverMap.get(t)||{};if(!r)return;if(r===Le.CONNECTED)this._sendUnsubscriptionMessage(t);else throw new Error("Subscription never connected")}catch(r){this.logger.debug(`Error while unsubscribing ${r}`)}finally{this._removeSubscriptionObserver(t)}}_startConnectionStateMonitoring(){return this.connectionStateMonitor.connectionStateObservable.subscribe(t=>{eo({event:vg,data:{provider:this,connectionState:t},message:`Connection state is ${t}`}),this.connectionState=t,t===Q.ConnectionDisrupted&&this.reconnectionMonitor.record(yt.START_RECONNECT),[Q.Connected,Q.ConnectedPendingDisconnect,Q.ConnectedPendingKeepAlive,Q.ConnectedPendingNetwork,Q.ConnectionDisruptedPendingNetwork,Q.Disconnected].includes(t)&&this.reconnectionMonitor.record(yt.HALT_RECONNECT)})}async _startSubscriptionWithAWSAppSyncRealTime({options:t,observer:n,subscriptionId:r,customUserAgentDetails:i}){const{query:s,variables:o}=t;this.subscriptionObserverMap.set(r,{observer:n,query:s??"",variables:o??{},subscriptionState:Le.PENDING,startAckTimeoutId:void 0});const{additionalCustomHeaders:a,libraryConfigHeaders:c}=await fr(t),u=await this._prepareSubscriptionPayload({options:t,subscriptionId:r,customUserAgentDetails:i,additionalCustomHeaders:a,libraryConfigHeaders:c});try{await this._connectWebSocket(t)}catch(h){this._logStartSubscriptionError(r,n,h);return}const{subscriptionFailedCallback:l,subscriptionReadyCallback:d}=this.subscriptionObserverMap.get(r)??{};this.subscriptionObserverMap.set(r,{observer:n,subscriptionState:Le.PENDING,query:s??"",variables:o??{},subscriptionReadyCallback:d,subscriptionFailedCallback:l,startAckTimeoutId:setTimeout(()=>{this._timeoutStartSubscriptionAck(r)},Ig)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(u)}_logStartSubscriptionError(t,n,r){this.logger.debug({err:r});const i=String(r.message??"");if(this._closeSocket(),this.connectionState!==Q.ConnectionDisruptedPendingNetwork){yo(r)?n.error({errors:[{...new Vt(`${we.CONNECTION_FAILED}: ${i}`)}]}):this.logger.debug(`${we.CONNECTION_FAILED}: ${i}`);const{subscriptionFailedCallback:s}=this.subscriptionObserverMap.get(t)||{};typeof s=="function"&&s()}}async _waitForSubscriptionToBeConnected(t){const n=this.subscriptionObserverMap.get(t);if(n){const{subscriptionState:r}=n;if(r===Le.PENDING)return new Promise((i,s)=>{const{observer:o,subscriptionState:a,variables:c,query:u}=n;this.subscriptionObserverMap.set(t,{observer:o,subscriptionState:a,variables:c,query:u,subscriptionReadyCallback:i,subscriptionFailedCallback:s})})}}_sendUnsubscriptionMessage(t){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===ie.READY){const n=this._unsubscribeMessage(t),r=JSON.stringify(n);this.awsRealTimeSocket.send(r)}}catch(n){this.logger.debug({err:n})}}_removeSubscriptionObserver(t){this.subscriptionObserverMap.delete(t),this.allowNoSubscriptions||setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0)){if(!this.awsRealTimeSocket){this.socketStatus=ie.CLOSED;return}if(this.connectionStateMonitor.record(fe.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{this.logger.debug("closing WebSocket...");const t=this.awsRealTimeSocket;t.onclose=null,t.onerror=null,t.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=ie.CLOSED,this._closeSocket()}}}maintainKeepAlive(){this.keepAliveTimestamp=Date.now()}keepAliveHeartbeat(t){const n=Date.now();n-this.keepAliveTimestamp>bg?this.connectionStateMonitor.record(fe.KEEP_ALIVE_MISSED):this.connectionStateMonitor.record(fe.KEEP_ALIVE),n-this.keepAliveTimestamp>t&&this._errorDisconnect(we.TIMEOUT_DISCONNECT)}_handleIncomingSubscriptionMessage(t){if(typeof t.data!="string")return;const[n,r]=this._handleSubscriptionData(t);if(n){this.maintainKeepAlive();return}const{type:i,id:s,payload:o}=r,{observer:a=null,query:c="",variables:u={},startAckTimeoutId:l,subscriptionReadyCallback:d,subscriptionFailedCallback:h}=this.subscriptionObserverMap.get(s)||{};if(i===pe.GQL_START_ACK||i===pe.EVENT_SUBSCRIBE_ACK){this.logger.debug(`subscription ready for ${JSON.stringify({query:c,variables:u})}`),typeof d=="function"&&d(),l&&clearTimeout(l),eo({event:we.SUBSCRIPTION_ACK,data:{query:c,variables:u},message:"Connection established for subscription"});const f=Le.CONNECTED;a&&this.subscriptionObserverMap.set(s,{observer:a,query:c,variables:u,startAckTimeoutId:void 0,subscriptionState:f,subscriptionReadyCallback:d,subscriptionFailedCallback:h}),this.connectionStateMonitor.record(fe.CONNECTION_ESTABLISHED);return}if(i===pe.GQL_CONNECTION_KEEP_ALIVE){this.maintainKeepAlive();return}if(i===pe.GQL_ERROR){const f=Le.FAILED;a&&(this.subscriptionObserverMap.set(s,{observer:a,query:c,variables:u,startAckTimeoutId:l,subscriptionReadyCallback:d,subscriptionFailedCallback:h,subscriptionState:f}),this.logger.debug(`${we.CONNECTION_FAILED}: ${JSON.stringify(o??r)}`),a.error({errors:[{...new Vt(`${we.CONNECTION_FAILED}: ${JSON.stringify(o??r)}`)}]}),l&&clearTimeout(l),typeof h=="function"&&h())}}_errorDisconnect(t){this.logger.debug(`Disconnect error: ${t}`),this.awsRealTimeSocket&&(this._closeSocket(),this.awsRealTimeSocket.close()),this.socketStatus=ie.CLOSED}_closeSocket(){this.keepAliveHeartbeatIntervalId&&(clearInterval(this.keepAliveHeartbeatIntervalId),this.keepAliveHeartbeatIntervalId=void 0),this.connectionStateMonitor.record(fe.CLOSED)}_timeoutStartSubscriptionAck(t){const n=this.subscriptionObserverMap.get(t);if(n){const{observer:r,query:i,variables:s}=n;if(!r)return;this.subscriptionObserverMap.set(t,{observer:r,query:i,variables:s,subscriptionState:Le.FAILED}),this._closeSocket(),this.logger.debug("timeoutStartSubscription",JSON.stringify({query:i,variables:s}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint:t,authenticationType:n,apiKey:r,region:i,additionalCustomHeaders:s}){if(this.socketStatus!==ie.READY)return new Promise(async(o,a)=>{if(this.promiseArray.push({res:o,rej:a}),this.socketStatus===ie.CLOSED)try{this.socketStatus=ie.CONNECTING;const u=await Ua({authenticationType:n,payload:"{}",canonicalUri:this.wsConnectUri,apiKey:r,appSyncGraphqlEndpoint:t,region:i,additionalCustomHeaders:s}),l=u?JSON.stringify(u):"",h=`header-${pt.convert(l,{urlSafe:!0,skipPadding:!0})}`,f=Lg(s),p=Mg(t,f);await this._establishRetryableConnection(p,h),this.promiseArray.forEach(({res:g})=>{this.logger.debug("Notifying connection successful"),g()}),this.socketStatus=ie.READY,this.promiseArray=[]}catch(c){this.logger.debug("Connection exited with",c),this.promiseArray.forEach(({rej:u})=>{u(c)}),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=ie.CLOSED}})}async _establishRetryableConnection(t,n){this.logger.debug("Establishing retryable connection"),await ld(this._establishConnection.bind(this),[t,n],mg)}async _openConnection(t,n){return new Promise((r,i)=>{const s=this._getNewWebSocket(t,[this.wsProtocolName,n]);s.onerror=()=>{this.logger.debug("WebSocket connection error")},s.onclose=()=>{this._closeSocket(),i(new Error("Connection handshake error"))},s.onopen=()=>{this.awsRealTimeSocket=s,r()}})}_getNewWebSocket(t,n){return new WebSocket(t,n)}async _initiateHandshake(){return new Promise((t,n)=>{if(!this.awsRealTimeSocket){n(new Error("awsRealTimeSocket undefined"));return}let r=!1;this.awsRealTimeSocket.onerror=o=>{this.logger.debug(`WebSocket error ${JSON.stringify(o)}`)},this.awsRealTimeSocket.onclose=o=>{this.logger.debug(`WebSocket closed ${o.reason}`),this._closeSocket(),n(new Error(JSON.stringify(o)))},this.awsRealTimeSocket.onmessage=o=>{if(typeof o.data!="string")return;this.logger.debug(`subscription message from AWS AppSyncRealTime: ${o.data} `);const a=JSON.parse(o.data),{type:c}=a,u=this._extractConnectionTimeout(a);if(c===pe.GQL_CONNECTION_ACK){r=!0,this._registerWebsocketHandlers(u),t("Connected to AWS AppSyncRealTime");return}if(c===pe.GQL_CONNECTION_ERROR){const{errorType:l,errorCode:d}=this._extractErrorCodeAndType(a);n({errorType:l,errorCode:d})}};const i={type:pe.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(i));const s=o=>{o||(this.connectionStateMonitor.record(fe.CONNECTION_FAILED),n(new Error(`Connection timeout: ack from AWSAppSyncRealTime was not received after ${Ws} ms`)))};setTimeout(()=>{s(r)},Ws)})}_registerWebsocketHandlers(t){this.awsRealTimeSocket&&(this.keepAliveHeartbeatIntervalId=setInterval(()=>{this.keepAliveHeartbeat(t)},Tg),this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=n=>{this.logger.debug(n),this._errorDisconnect(we.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=n=>{this.logger.debug(`WebSocket closed ${n.reason}`),this._closeSocket(),this._errorDisconnect(we.CONNECTION_CLOSED)})}}const to="AWSAppSyncRealTimeProvider",$g="graphql-ws",Bg="/connect";class Kg extends qg{constructor(){super({providerName:to,wsProtocolName:$g,connectUri:Bg})}getProviderName(){return to}subscribe(t,n){return super.subscribe(t,n)}async _prepareSubscriptionPayload({options:t,subscriptionId:n,customUserAgentDetails:r,additionalCustomHeaders:i,libraryConfigHeaders:s}){const{appSyncGraphqlEndpoint:o,authenticationType:a,query:c,variables:u,apiKey:l,region:d}=t,f=JSON.stringify({query:c,variables:u}),p={...await Ua({apiKey:l,appSyncGraphqlEndpoint:o,authenticationType:a,payload:f,canonicalUri:"",region:d,additionalCustomHeaders:i}),...s,...i,[fc]:St(r)},g={id:n,payload:{data:f,extensions:{authorization:{...p}}},type:pe.GQL_START};return JSON.stringify(g)}_handleSubscriptionData(t){this.logger.debug(`subscription message from AWS AppSync RealTime: ${t.data}`);const{id:n="",payload:r,type:i}=JSON.parse(String(t.data)),{observer:s=null,query:o="",variables:a={}}=this.subscriptionObserverMap.get(n)||{};return this.logger.debug({id:n,observer:s,query:o,variables:a}),i===pe.DATA&&r&&r.data?(s?s.next(r):this.logger.debug(`observer not found for id: ${n}`),[!0,{id:n,type:i,payload:r}]):[!1,{id:n,type:i,payload:r}]}_unsubscribeMessage(t){return{id:t,type:pe.GQL_STOP}}_extractConnectionTimeout(t){const{payload:{connectionTimeoutMs:n=wg}={}}=t;return n}_extractErrorCodeAndType(t){const{payload:{errors:[{errorType:n="",errorCode:r=0}={}]=[]}={}}=t;return{errorCode:r,errorType:n}}}class xe extends re{constructor(t){super(t),this.constructor=xe,Object.setPrototypeOf(this,xe.prototype)}}var ht;(function(e){e.NoAuthSession="NoAuthSession",e.NoRegion="NoRegion",e.NoCustomEndpoint="NoCustomEndpoint"})(ht||(ht={}));const Vg={[ht.NoAuthSession]:{message:"Auth session should not be empty."},[ht.NoRegion]:{message:"Missing region."},[ht.NoCustomEndpoint]:{message:"Custom endpoint region is present without custom endpoint."}};function jg(e,t){const{message:n,recoverySuggestion:r}=Vg[t];if(!e)throw new xe({name:t,message:n,recoverySuggestion:r})}const Hg=new X("GraphQLAPI resolveConfig"),no=e=>{var c,u;const t=e.getConfig();(c=t.API)!=null&&c.GraphQL||Hg.warn("The API configuration is missing. This is likely due to Amplify.configure() not being called prior to generateClient().");const{apiKey:n,customEndpoint:r,customEndpointRegion:i,defaultAuthMode:s,endpoint:o,region:a}=((u=t.API)==null?void 0:u.GraphQL)??{};return jg(!(!r&&i),ht.NoCustomEndpoint),{apiKey:n,customEndpoint:r,customEndpointRegion:i,defaultAuthMode:s,endpoint:o,region:a}},ro=e=>{var r,i,s,o,a,c;const t=(s=(i=(r=e.libraryOptions)==null?void 0:r.API)==null?void 0:i.GraphQL)==null?void 0:s.headers,n=(c=(a=(o=e.libraryOptions)==null?void 0:o.API)==null?void 0:a.GraphQL)==null?void 0:c.withCredentials;return{headers:t,withCredentials:n}};function io(e){return e.errors&&Array.isArray(e.errors)&&e.errors.forEach(t=>{Gg(t)&&(t.message="Unauthorized",t.recoverySuggestion=`If you're calling an Amplify-generated API, make sure to set the "authMode" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')`)}),e}function Gg(e){var t,n,r,i;return!!((n=(t=e==null?void 0:e.originalError)==null?void 0:t.name)!=null&&n.startsWith("UnauthorizedException")||(r=e.message)!=null&&r.startsWith("Connection failed:")&&((i=e.message)!=null&&i.includes("Permission denied")))}var it;(function(e){e.NO_API_KEY="No api-key configured",e.NO_CURRENT_USER="No current user",e.NO_CREDENTIALS="No credentials",e.NO_FEDERATED_JWT="No federated jwt",e.NO_AUTH_TOKEN="No auth token specified"})(it||(it={}));const Fa=Symbol("amplify"),xn=Symbol("authMode"),qa=Symbol("authToken"),Or=Symbol("apiKey"),$a=Symbol("headers"),Pn=Symbol("endpoint");function di(e){const t=e;return{amplify:t[Fa],apiKey:t[Or],authMode:t[xn],authToken:t[qa],endpoint:t[Pn],headers:t[$a]}}const Wg={name:"NoApiKey",message:it.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},zg={name:"NoCredentials",message:it.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},Yg={name:"NoValidAuthTokens",message:it.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},Jg={name:"NoSignedUser",message:it.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},Qg={name:"NoAuthorizationHeader",message:it.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'},Xg={name:"NoEndpoint",message:"No GraphQL endpoint configured in `Amplify.configure()`.",recoverySuggestion:"Review if the GraphQL API endpoint is set in the `Amplify.configure()` function."},so=e=>({data:{},errors:[new Vt(e.message,null,null,null,null,e)]});function Zg(e){if(!e)return!1;const t=e;return Array.isArray(t.errors)&&t.errors.length>0}async function em(e,t,n,r={}){var s;let i={};switch(t){case"apiKey":if(!n)throw new xe(Wg);i={"X-Api-Key":n};break;case"iam":{if((await e.Auth.fetchAuthSession()).credentials===void 0)throw new xe(zg);break}case"oidc":case"userPool":{let o;try{o=(s=(await e.Auth.fetchAuthSession()).tokens)==null?void 0:s.accessToken.toString()}catch(a){throw new xe({...Jg,underlyingError:a})}if(!o)throw new xe(Yg);i={Authorization:o};break}case"lambda":if(typeof r=="object"&&!r.Authorization)throw new xe(Qg);i={Authorization:r.Authorization};break}return i}const tm="x-amz-user-agent",nm=e=>typeof e!="function";class rm{constructor(){this.appSyncRealTime=new Map,this._api={post:fg,cancelREST:pg,isCancelErrorREST:Zp,updateRequestToBeCancellable:gg}}getModuleName(){return"InternalGraphQLAPI"}getGraphqlOperationType(t){const r=dr(t).definitions,[{operation:i}]=r;return i}graphql(t,{query:n,variables:r={},authMode:i,authToken:s,endpoint:o,apiKey:a},c,u){const l=dr(typeof n=="string"?n:Lt(n)),[d={}]=l.definitions.filter(p=>p.kind==="OperationDefinition"),{operation:h}=d,f=c||{};switch(h){case"query":case"mutation":{const p=new AbortController;let g;return nm(t)?g=this._graphql(t,{query:l,variables:r,authMode:i,apiKey:a,endpoint:o},f,p,u,s):g=t(async E=>await this._graphql(E,{query:l,variables:r,authMode:i,apiKey:a,endpoint:o},f,p,u,s)),this._api.updateRequestToBeCancellable(g,p),g}case"subscription":return this._graphqlSubscribe(t,{query:l,variables:r,authMode:i,apiKey:a,endpoint:o},f,u,s);default:throw new Error(`invalid operation type: ${h}`)}}async _graphql(t,{query:n,variables:r,authMode:i,endpoint:s,apiKey:o},a={},c,u,l){const{apiKey:d,region:h,endpoint:f,customEndpoint:p,customEndpointRegion:g,defaultAuthMode:m}=no(t),E=i||m||"iam",S=E==="identityPool"?"iam":E,{headers:w,withCredentials:I}=ro(t);let v;if(typeof a=="function"){const k={method:"POST",url:new Pe(s||p||f||"").toString(),queryString:Lt(n)};v=await a(k)}else v=a;l&&(v={...v,Authorization:l});const A=await em(t,S,o??d,v),_={...!p&&A,...p&&(g?A:{})||{},...w&&await w({query:Lt(n),variables:r}),...v,...!p&&{[tm]:St(u)}},O={query:Lt(n),variables:r||null};let D;p&&!g||S!=="oidc"&&S!=="userPool"&&S!=="iam"&&S!=="lambda"?D=void 0:D={service:g?"execute-api":"appsync",region:g||h};const $=s||p||f;if(!$)throw so(new xe(Xg));let j;try{const{body:k}=await this._api.post(t,{url:new Pe($),options:{headers:_,body:O,signingServiceInfo:D,withCredentials:I},abortController:c});j=await k.json()}catch(k){if(this.isCancelError(k))throw k;j=so(k)}if(Zg(j))throw io(j);return j}isCancelError(t){return this._api.isCancelErrorREST(t)}cancel(t,n){return this._api.cancelREST(t,n)}_graphqlSubscribe(t,{query:n,variables:r,authMode:i,apiKey:s,endpoint:o},a={},c,u){const l=no(t),d=i||(l==null?void 0:l.defaultAuthMode)||"iam",h=d==="identityPool"?"iam":d,{headers:f}=ro(t),p=o??(l==null?void 0:l.endpoint),g=p??"none",m=this.appSyncRealTime.get(g)??new Kg;return this.appSyncRealTime.set(g,m),m.subscribe({query:Lt(n),variables:r,appSyncGraphqlEndpoint:p,region:l==null?void 0:l.region,authenticationType:h,apiKey:s??(l==null?void 0:l.apiKey),additionalHeaders:a,authToken:u,libraryConfigHeaders:f},c).pipe(Bo(E=>{throw E.errors?io(E):E}))}}function Qn(e){const t=new Set;for(const n of e.attributes||[])if(im(n))for(const r of n.properties.rules)r.allow==="owner"?t.add(r.ownerField||"owner"):r.allow==="groups"&&r.groupsField!==void 0&&t.add(r.groupsField);return Array.from(t)}function im(e){var t,n;return(e==null?void 0:e.type)==="auth"&&typeof(e==null?void 0:e.properties)=="object"&&Array.isArray((t=e==null?void 0:e.properties)==null?void 0:t.rules)?((n=e==null?void 0:e.properties)==null?void 0:n.rules).every(r=>!!r.allow):!1}function Rn(e){return`${e[0].toUpperCase()}${e.slice(1)}`}function Ge(e){let t,n;const r=new Promise((i,s)=>{t=i,n=s});return e(r).then(i=>{t(i)}).catch(i=>{n(i)}),r}const Un=new WeakMap;function We(e,t){return Un.set(t,e),e.finally(()=>{Un.delete(t)})}function sm(e){const t=e.cancel.bind(e);e.cancel=function(n,r){const i=new Set;let s=n;for(;s&&Un.has(s);){if(i.has(s))throw new Error("A cycle was detected in the modeled graphql cancellation chain. This is a bug. Please report it!");i.add(s),s=Un.get(s)}return t(s,r)}}const ct={HAS_ONE:"HAS_ONE",HAS_MANY:"HAS_MANY",BELONGS_TO:"BELONGS_TO"},oo={ID:"ID",String:"String",AWSDate:"String",AWSTime:"String",AWSDateTime:"String",AWSTimestamp:"Int",AWSEmail:"String",AWSPhone:"String",AWSURL:"String",AWSIPAddress:"String",AWSJSON:"String",Boolean:"Boolean",Int:"Int",Float:"Float"},Fn=e=>e.length===1?e[0]:e.reduce((t,n,r)=>r===0?n:t+Rn(n),""),$e=(e,t,n)=>{var i;if(!n)return null;const r={};for(const[s,o]of Object.entries(n)){const a=t?(i=e.models[t])==null?void 0:i.fields[s]:void 0,c={fieldDef:a,value:o};om(c)?r[s]=c.value.items.map(u=>$e(e,c.fieldDef.type.model,u)):am(a)?r[s]=$e(e,a.type.model,o):r[s]=o}return r};function om(e){var t,n;return typeof((t=e.fieldDef)==null?void 0:t.type)=="object"&&"model"in e.fieldDef.type&&typeof e.fieldDef.type.model=="string"&&e.fieldDef.isArray&&Array.isArray((n=e.value)==null?void 0:n.items)}function am(e){return typeof(e==null?void 0:e.type)=="object"&&"model"in e.type&&typeof e.type.model=="string"}function Be(e,t,n,r,i,s,o=!1){const a=r.models[t],c=a.fields,u=Object.entries(c).filter(([l,d])=>{var h;return((h=d==null?void 0:d.type)==null?void 0:h.model)!==void 0}).map(([l])=>l);return n.map(l=>{var h,f,p,g,m;if(l==null)return l;const d={};for(const E of u){const S=c[E],I=(S==null?void 0:S.type).model,v=r.models[I],A=v.primaryKeyInfo.primaryKeyFieldName,_=v.primaryKeyInfo.sortKeyFieldNames,O=(h=S.association)==null?void 0:h.connectionType;let D=[];S.association&&"associatedWith"in S.association&&(D=S.association.associatedWith);const $=[];switch(S.association&&"targetNames"in S.association&&$.push(...S.association.targetNames),O){case ct.BELONGS_TO:{const j=_.reduce((k,x)=>(l[x]&&(k[x]=l[x]),k),{});if(((f=e.models[I])==null?void 0:f.get)===void 0)break;o?d[E]=(k,x)=>l[$[0]]?e.models[I].get(k,{[A]:l[$[0]],...j},{authMode:(x==null?void 0:x.authMode)||i,authToken:(x==null?void 0:x.authToken)||s}):{data:null}:d[E]=k=>l[$[0]]?e.models[I].get({[A]:l[$[0]],...j},{authMode:(k==null?void 0:k.authMode)||i,authToken:(k==null?void 0:k.authToken)||s}):{data:null};break}case ct.HAS_ONE:case ct.HAS_MANY:{const j=O===ct.HAS_ONE?R=>({data:(R==null?void 0:R.data.shift())||null,errors:R.errors,extensions:R.extensions}):R=>R,k=a.primaryKeyInfo.primaryKeyFieldName,x=a.primaryKeyInfo.sortKeyFieldNames,F=v.fields[D[0]];if(F.type.model){let R=[];F.association&&"targetNames"in F.association&&(R=(p=F.association)==null?void 0:p.targetNames);const B=R.map((L,q)=>q===0?{[L]:{eq:l[k]}}:{[L]:{eq:l[x[q-1]]}});if(((g=e.models[I])==null?void 0:g.list)===void 0)break;o?d[E]=(L,q)=>l[k]?Ge(async je=>{const kt=e.models[I].list(L,{filter:{and:B},limit:q==null?void 0:q.limit,nextToken:q==null?void 0:q.nextToken,authMode:(q==null?void 0:q.authMode)||i,authToken:(q==null?void 0:q.authToken)||s}),ir=We(kt,je);return j(await ir)}):[]:d[E]=L=>l[k]?Ge(async q=>{const je=e.models[I].list({filter:{and:B},limit:L==null?void 0:L.limit,nextToken:L==null?void 0:L.nextToken,authMode:(L==null?void 0:L.authMode)||i,authToken:(L==null?void 0:L.authToken)||s}),kt=We(je,q);return j(await kt)}):[];break}const de=D.map((R,B)=>B===0?{[R]:{eq:l[k]}}:{[R]:{eq:l[x[B-1]]}});if(((m=e.models[I])==null?void 0:m.list)===void 0)break;o?d[E]=(R,B)=>l[k]?Ge(async L=>{const q=e.models[I].list(R,{filter:{and:de},limit:B==null?void 0:B.limit,nextToken:B==null?void 0:B.nextToken,authMode:(B==null?void 0:B.authMode)||i,authToken:(B==null?void 0:B.authToken)||s}),je=We(q,L);return j(await je)}):[]:d[E]=R=>l[k]?Ge(async B=>{const L=e.models[I].list({filter:{and:de},limit:R==null?void 0:R.limit,nextToken:R==null?void 0:R.nextToken,authMode:(R==null?void 0:R.authMode)||i,authToken:(R==null?void 0:R.authToken)||s}),q=We(L,B);return j(await q)}):[];break}}}return{...l,...d}})}const Dr={CREATE:{operationPrefix:"create",usePlural:!1},GET:{operationPrefix:"get",usePlural:!1},UPDATE:{operationPrefix:"update",usePlural:!1},DELETE:{operationPrefix:"delete",usePlural:!1},LIST:{operationPrefix:"list",usePlural:!0},INDEX_QUERY:{operationPrefix:"",usePlural:!1},ONCREATE:{operationPrefix:"onCreate",usePlural:!1},ONUPDATE:{operationPrefix:"onUpdate",usePlural:!1},ONDELETE:{operationPrefix:"onDelete",usePlural:!1},OBSERVEQUERY:{operationPrefix:"observeQuery",usePlural:!1}},Lr="*",Xn=(e,t)=>{const{fields:n}=e,r=Object.values(n).map(({type:i,name:s})=>{if(typeof i.enum=="string")return[s,Et];if(typeof i.nonModel=="string")return[s,Xn(t.nonModels[i.nonModel],t)];if(typeof i=="string")return[s,Et]}).filter(i=>i!==void 0);return Object.fromEntries(r)},cm=(e,t)=>{const{fields:n}=e,r=Object.values(n).map(({type:s,name:o})=>{if(typeof s.enum=="string"||typeof s=="string")return[o,Et];if(typeof s.nonModel=="string")return[o,Xn(t.nonModels[s.nonModel],t)]}).filter(s=>s!==void 0),i=Qn(e).map(s=>[s,Et]);return Object.fromEntries(r.concat(i))};function um(e){const{fields:t}=e,n=Object.values(t).map(({type:i,name:s})=>{if(typeof i=="string")return s;if(typeof i=="object"){if(typeof(i==null?void 0:i.enum)=="string")return s;if(typeof(i==null?void 0:i.nonModel)=="string")return`${s}.${Lr}`}}).filter(Boolean),r=Qn(e);return Array.from(new Set(n.concat(r)))}const Et="";function lm(e,t,n){const r=(i,s)=>{var m,E,S,w,I,v;const[o,...a]=i.split("."),c=a[0],u=e.models[s]??e.nonModels[s],l=u==null?void 0:u.fields,d=(E=(m=l==null?void 0:l[o])==null?void 0:m.type)==null?void 0:E.model,h=e.models[d],f=(w=(S=l==null?void 0:l[o])==null?void 0:S.type)==null?void 0:w.nonModel,p=e.nonModels[f],g=h?"model":p?"nonModel":"field";if(g==="nonModel"){let A={};if(!c)throw Error(`${o} must declare a wildcard (*) or a field of custom type ${f}`);return c===Lr?A={[o]:Xn(p,e)}:A={[o]:r(a.join("."),f)},A}else if(g==="model"){let A={};if(!c)throw Error(`${o} must declare a wildcard (*) or a field of model ${d}`);if(c===Lr){const _=e.models[d];A={[o]:cm(_,e)}}else A={[o]:r(a.join("."),d)};return(I=l[o])!=null&&I.isArray&&(A={[o]:{items:A[o]}}),A}else{const A=l==null?void 0:l[o],_=e.nonModels[s],O=(v=_==null?void 0:_.fields)==null?void 0:v[o];if(_){if(!O)throw Error(`${o} is not a field of custom type ${s}`)}else{const D=Qn(u).includes(o);if(!A&&!D)throw Error(`${o} is not a field of model ${s}`)}return{[o]:Et}}};return n.reduce((i,s)=>Ba(r(s,t),i),{})}function qn(e){const t=[];return Object.entries(e).forEach(([n,r])=>{r===Et?t.push(n):typeof r=="object"&&r!==null&&(r!=null&&r.items?t.push(n,"{","items","{",qn(r.items),"}","}"):t.push(n,"{",qn(r),"}"))}),t.join(" ")}function Ba(e,t){const n=r=>r&&typeof r=="object";for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)&&n(t[r])?Ba(e[r],t[r]):t[r]=e[r]);return t}function Ka(e,t,n){const r=e.models[t],i=lm(e,t,n??um(r));return qn(i)}function Zn(e,t,n,r,i){var j,k;const{name:s,pluralName:o,fields:a,primaryKeyInfo:{isCustomPrimaryKey:c,primaryKeyFieldName:u,sortKeyFieldNames:l},attributes:d}=t,h=s.charAt(0).toUpperCase()+s.slice(1),f=o.charAt(0).toUpperCase()+o.slice(1),{operationPrefix:p,usePlural:g}=Dr[n],{selectionSet:m}=r||{};let E,S;if(p)E=`${p}${g?f:h}`;else if(i){const{queryField:x,pk:F,sk:J=[]}=i;E=x;let de={};if(J.length===1){const[R]=J,B=typeof a[R].type=="string"?a[R].type:"String",L=oo[B];de={[R]:`Model${L}KeyConditionInput`}}else if(J.length>1){const R=Fn(J),B=(k=(j=d==null?void 0:d.find(L=>{var q;return((q=L==null?void 0:L.properties)==null?void 0:q.queryField)===x}))==null?void 0:j.properties)==null?void 0:k.name;de={[R]:`Model${Rn(s)}${Rn(B)}CompositeKeyConditionInput`}}S={[F]:`${Object.prototype.hasOwnProperty.call(a[F].type,"enum")?a[F].type.enum:a[F].type}!`,...de}}else throw new Error("Error generating GraphQL Document - invalid operation name");let w,I,v;const A=Ka(e,s,m),_={[u]:`${a[u].type}!`},O={},D=x=>{if(l.length===0)return{};if(x==="get")return l.reduce((F,J)=>{const de=a[J].type;return x==="get"&&(F[J]=`${de}!`),F},{});if(l.length===1){const[F]=l,J=typeof a[F].type=="string"?a[F].type:"String",de=oo[J];return{[F]:`Model${de}KeyConditionInput`}}else return{[Fn(l)]:`Model${Rn(s)}PrimaryCompositeKeyConditionInput`}};switch(c&&(Object.assign(_,D("get")),Object.assign(O,{[u]:`${a[u].type}`,sortDirection:"ModelSortDirection"},D("list"))),n){case"CREATE":case"UPDATE":case"DELETE":v??(v={input:`${p.charAt(0).toLocaleUpperCase()+p.slice(1)}${h}Input!`}),w??(w="mutation");case"GET":v??(v=_),I??(I=A);case"LIST":v??(v={...O,filter:`Model${h}FilterInput`,limit:"Int",nextToken:"String"}),w??(w="query"),I??(I=`items { ${A} } nextToken __typename`);case"INDEX_QUERY":v??(v={...S,filter:`Model${h}FilterInput`,sortDirection:"ModelSortDirection",limit:"Int",nextToken:"String"}),w??(w="query"),I??(I=`items { ${A} } nextToken __typename`);case"ONCREATE":case"ONUPDATE":case"ONDELETE":v??(v={filter:`ModelSubscription${h}FilterInput`}),w??(w="subscription"),I??(I=A);break;case"OBSERVEQUERY":default:throw new Error("Internal error: Attempted to generate graphql document for observeQuery. Please report this error.")}return`${w}${v?`(${Object.entries(v).map(([x,F])=>`$${x}: ${F}`)})`:""} { ${E}${v?`(${Object.keys(v).map(x=>`${x}: $${x}`)})`:""} { ${I} } }`}function er(e,t,n,r,i){const{fields:s,primaryKeyInfo:{isCustomPrimaryKey:o,primaryKeyFieldName:a,sortKeyFieldNames:c}}=e,u=(c==null?void 0:c.length)&&Fn(c);let l={};switch(t){case"CREATE":l={input:n?ao(n,e,r):{}};break;case"UPDATE":l={input:n?Object.fromEntries(Object.entries(ao(n,e,r)).filter(([d])=>s[d]?!s[d].isReadOnly:!Qn(e).includes(d))):{}};break;case"GET":case"DELETE":n&&(l=o?[a,...c].reduce((d,h)=>(d[h]=n[h],d),{}):{[a]:n[a]}),t==="DELETE"&&(l={input:l});break;case"LIST":n!=null&&n.filter&&(l.filter=n.filter),n!=null&&n.sortDirection&&(l.sortDirection=n.sortDirection),n&&n[a]&&(l[a]=n[a]),u&&n&&n[u]&&(l[u]=n[u]),n!=null&&n.nextToken&&(l.nextToken=n.nextToken),n!=null&&n.limit&&(l.limit=n.limit);break;case"INDEX_QUERY":{const{pk:d,sk:h=[]}=i,f=(h==null?void 0:h.length)&&Fn(h);l[d]=n[d],f&&n&&n[f]&&(l[f]=n[f]),n!=null&&n.filter&&(l.filter=n.filter),n!=null&&n.sortDirection&&(l.sortDirection=n.sortDirection),n!=null&&n.nextToken&&(l.nextToken=n.nextToken),n!=null&&n.limit&&(l.limit=n.limit);break}case"ONCREATE":case"ONUPDATE":case"ONDELETE":n!=null&&n.filter&&(l={filter:n.filter});break;case"OBSERVEQUERY":throw new Error("Internal error: Attempted to build variables for observeQuery. Please report this error.");default:{const d=t;throw new Error(`Unhandled operation case: ${d}`)}}return l}function ao(e,t,n){const{fields:r}=t,i={};return Object.entries(e).forEach(([s,o])=>{var u,l;const a=(u=r[s])==null?void 0:u.type,c=a==null?void 0:a.model;if(c){const d=(l=r[s])==null?void 0:l.association,f=n.models[c].primaryKeyInfo;if((d==null?void 0:d.connectionType)===ct.HAS_ONE){const p=d;p.targetNames.forEach((g,m)=>{const E=p.associatedWith[m];i[g]=o[E]})}(d==null?void 0:d.connectionType)===ct.BELONGS_TO&&d.targetNames.forEach((g,m)=>{if(m===0){const E=f.primaryKeyFieldName;i[g]=o[E]}else{const E=f.sortKeyFieldNames[m-1];i[g]=o[E]}})}else i[s]=o}),i}function Pt(e,t,n={}){const r=t(e);return{authMode:n.authMode||r.authMode,authToken:n.authToken||r.authToken}}function Rt(e,t,n){let r=t(e).headers||{};return n&&(r=n),r}function Mr(e){if(e!=null&&e.errors)return{...e,data:[]};throw e}function $n(e){if(e.errors)return{...e,data:null};throw e}const hi=Symbol("INTERNAL_USER_AGENT_OVERRIDE");var be;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnStreamEvent="7",e.Generation="8",e.UpdateConversation="9"})(be||(be={}));const Ve=e=>({category:"ai",action:e});function tr(e){return e?{[hi]:e}:void 0}const dm=e=>{var t;return typeof((t=e==null?void 0:e.token)==null?void 0:t.value)=="symbol"};function nr(e,t,n,r,i,s,o){const a=r.arguments!==void 0;return(...u)=>{const l=u[u.length-1];let d,h;if(i)if(dm(u[0]))d=u[0];else throw new Error(`Invalid first argument passed to ${r.name}. Expected contextSpec`);return a&&(i?h=u[1]:h=u[0]),n==="subscription"?mm(e,t,r,s,h,l,o):gm(e,t,n,r,s,h,l,d,o)}}function ut(e,t){return typeof e[t]=="string"}function hm(e){return e instanceof Object&&"enum"in e}function fm(e){return e instanceof Object&&"input"in e}function pm({type:e,isRequired:t}){const n=t?"!":"";return hm(e)?`${e.enum}${n}`:fm(e)?`${e.input}${n}`:`${e}${n}`}function Va(e){if(e.arguments===void 0)return"";const t=Object.entries(e.arguments).map(([n,r])=>{const i=pm(r),s=r.isArray?`[${i}]${r.isArrayNullable?"":"!"}`:i;return`$${n}: ${s}`}).join(", ");return t.length>0?`(${t})`:""}function ja(e){if(e.arguments===void 0)return"";const t=Object.keys(e.arguments).map(n=>`${n}: $${n}`).join(", ");return t.length>0?`(${t})`:""}function Ha(e,t){if(ut(t,"type")||ut(t.type,"enum"))return"";if(ut(t.type,"nonModel")){const n=e.nonModels[t.type.nonModel];return`{${qn(Xn(n,e))}}`}else return ut(t.type,"model")?`{${Ka(e,t.type.model)}}`:""}function Ga(e,t={}){const n={};if(e.arguments===void 0)return n;for(const r of Object.values(e.arguments))if(typeof t[r.name]<"u")n[r.name]=t[r.name];else if(r.isRequired)throw new Error(`${e.name} requires arguments '${r.name}'`);return n}function gm(e,t,n,r,i,s,o,a,c){return Ge(async u=>{const{name:l}=r,d=Pt(e,i,o),h=Rt(e,i,o==null?void 0:o.headers),f=Va(r),p=ja(r),g=Ha(t,r),m=ut(r.type,"model")?r.type.model:void 0,E=`
    ${n.toLocaleLowerCase()}${f} {
      ${l}${p} ${g}
    }
  `,S=Ga(r,s),w=tr(c);try{const I=a?e.graphql(a,{...d,query:E,variables:S},h):e.graphql({...d,query:E,variables:S,...w},h),v=We(I,u),{data:A,extensions:_}=await v;if(A){const[O]=Object.keys(A),D=Array.isArray(A[O]),$=D?A[O].filter(k=>k):A[O],j=m?Be(e,m,D?$:[$],t,d.authMode,d.authToken,!!a):$;return{data:!D&&Array.isArray(j)?j.shift():j,extensions:_}}else return{data:null,extensions:_}}catch(I){const{data:v,errors:A}=I;if(v&&Object.keys(v).length!==0&&A){const[_]=Object.keys(v),O=Array.isArray(v[_]),D=O?v[_].filter($=>$):v[_];if(D){const $=m?Be(e,m,O?D:[D],t,d.authMode,d.authToken,!!a):D;return{data:!O&&Array.isArray($)?$.shift():$,errors:A}}else return $n(I)}else return $n(I)}})}function mm(e,t,n,r,i,s,o){const a="subscription",{name:c}=n,u=Pt(e,r,s),l=Rt(e,r,s==null?void 0:s.headers),d=Va(n),h=ja(n),f=Ha(t,n),p=ut(n.type,"model")?n.type.model:void 0,g=`
    ${a.toLocaleLowerCase()}${d} {
      ${c}${h} ${f}
    }
  `,m=Ga(n,i),E=tr(o);return e.graphql({...u,query:g,variables:m,...E},l).pipe(Wr(w=>{const[I]=Object.keys(w.data),v=w.data[I],[A]=p?Be(e,p,[v],t,u.authMode,u.authToken):[v];return A}))}const ym={queries:"query",mutations:"mutation",subscriptions:"subscription"};function fi(e,t,n,r){if(!t)return{};const i=t.modelIntrospection;if(!i)return{};const s=i[n];if(!s)return{};const o={},a=r(e).amplify===null;for(const c of Object.values(s))o[c.name]=nr(e,i,ym[n],c,a,r);return o}function Em(e,t,n){return fi(e,t,"mutations",n)}function vm(e,t,n){return fi(e,t,"queries",n)}function Sm(e,t,n){return fi(e,t,"subscriptions",n)}function an(e,t,n,r,i,s=!1,o){return s?(u,l,d)=>co(e,t,n,l,d,r,i,u,o):(u,l)=>co(e,t,n,u,l,r,i,void 0,o)}function co(e,t,n,r,i,s,o,a,c){return Ge(async u=>{const{name:l}=n,d=Zn(t,n,s,i),h=er(n,s,r,t),f=Pt(e,o,i),p=Rt(e,o,i==null?void 0:i.headers),g=tr(c);try{const m=a?e.graphql(a,{...f,query:d,variables:h},p):e.graphql({...f,query:d,variables:h,...g},p),E=We(m,u),{data:S,extensions:w}=await E;if(S){const[I]=Object.keys(S),v=$e(t,l,S[I]);if(v===null)return{data:null,extensions:w};if(i!=null&&i.selectionSet)return{data:v,extensions:w};{const[A]=Be(e,l,[v],t,f.authMode,f.authToken,!!a);return{data:A,extensions:w}}}else return{data:null,extensions:w}}catch(m){const{data:E,errors:S}=m;if(E&&Object.keys(E).length!==0&&S){const[w]=Object.keys(E),I=$e(t,l,E[w]);if(I){if(i!=null&&i.selectionSet)return{data:I,errors:S};{const[v]=Be(e,l,[I],t,f.authMode,f.authToken,!!a);return{data:v,errors:S}}}else return $n(m)}else return $n(m)}})}function pi(e,t,n,r,i=!1,s){return i?(c,u)=>uo(e,t,n,r,u,c,s):c=>uo(e,t,n,r,c,void 0,s)}function uo(e,t,n,r,i,s,o){return Ge(async a=>{var p,g,m,E;const{name:c}=n,u=Zn(t,n,"LIST",i),l=er(n,"LIST",i,t),d=Pt(e,r,i),h=Rt(e,r,i==null?void 0:i.headers),f=tr(o);try{const S=s?e.graphql(s,{...d,query:u,variables:l},h):e.graphql({...d,query:u,variables:l,...f},h),w=We(S,a),{data:I,extensions:v}=await w;if(I!==void 0){const[A]=Object.keys(I);if(I[A].items){const _=I[A].items.map(O=>$e(t,c,O));return i!=null&&i.selectionSet?{data:_,nextToken:I[A].nextToken,extensions:v}:{data:Be(e,c,_,t,d.authMode,d.authToken,!!s),nextToken:I[A].nextToken,extensions:v}}return{data:I[A],nextToken:I[A].nextToken,extensions:v}}}catch(S){const{data:w,errors:I}=S;if(w!=null&&Object.keys(w).length!==0&&I){const[v]=Object.keys(w);if((p=w[v])!=null&&p.items){const A=w[v].items.map(_=>$e(t,c,_));return A?i!=null&&i.selectionSet?{data:A,nextToken:(g=w[v])==null?void 0:g.nextToken,errors:I}:{data:Be(e,c,A,t,d.authMode,d.authToken,!!s),nextToken:(m=w[v])==null?void 0:m.nextToken,errors:I}:{data:w[v],nextToken:(E=w[v])==null?void 0:E.nextToken,errors:I}}else return Mr(S)}else return Mr(S)}})}const Ze={},_t=new Array(64);for(let e=0,t=65,n=90;e+t<=n;e++){const r=String.fromCharCode(e+t);Ze[r]=e,_t[e]=r}for(let e=0,t=97,n=122;e+t<=n;e++){const r=String.fromCharCode(e+t),i=e+26;Ze[r]=i,_t[i]=r}for(let e=0;e<10;e++){Ze[e.toString(10)]=e+52;const t=e.toString(10),n=e+52;Ze[t]=n,_t[n]=t}Ze["+"]=62;_t[62]="+";Ze["/"]=63;_t[63]="/";const ft=6,jt=8,Im=63,Wa=e=>{let t=e.length/4*3;e.slice(-2)==="=="?t-=2:e.slice(-1)==="="&&t--;const n=new ArrayBuffer(t),r=new DataView(n);for(let i=0;i<e.length;i+=4){let s=0,o=0;for(let u=i,l=i+3;u<=l;u++)if(e[u]!=="="){if(!(e[u]in Ze))throw new TypeError(`Invalid character ${e[u]} in base64 string.`);s|=Ze[e[u]]<<(l-u)*ft,o+=ft}else s>>=ft;const a=i/4*3;s>>=o%jt;const c=Math.floor(o/jt);for(let u=0;u<c;u++){const l=(c-u-1)*jt;r.setUint8(a+u,(s&255<<l)>>l)}}return new Uint8Array(n)},wm=e=>new TextEncoder().encode(e);function za(e){let t;typeof e=="string"?t=wm(e):t=e;const n=typeof t=="object"&&typeof t.length=="number",r=typeof t=="object"&&typeof t.byteOffset=="number"&&typeof t.byteLength=="number";if(!n&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let i="";for(let s=0;s<t.length;s+=3){let o=0,a=0;for(let u=s,l=Math.min(s+3,t.length);u<l;u++)o|=t[u]<<(l-u-1)*jt,a+=jt;const c=Math.ceil(a/ft);o<<=c*ft-a;for(let u=1;u<=c;u++){const l=(c-u)*ft;i+=_t[(o&Im<<l)>>l]}i+="==".slice(0,4-c)}return i}const Tm=e=>e.map(t=>t.image?Ya(t):t.document?bm(t):t.toolUse?Nm(t):t.toolResult?Cm(t):Ja(t)),Ya=({image:e})=>({image:{...e,source:{...e.source,bytes:Wa(e.source.bytes)}}}),bm=({document:e})=>({document:{...e,source:{...e.source,bytes:Wa(e.source.bytes)}}}),Am=({json:e})=>({json:JSON.parse(e)}),Nm=({toolUse:e})=>({toolUse:{...e,input:JSON.parse(e.input)}}),Cm=({toolResult:e})=>({toolResult:{toolUseId:e.toolUseId,content:e.content.map(t=>t.image?Ya(t):t.json?Am(t):Ja(t))}}),Ja=e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==null)),Qa=({content:e,createdAt:t,id:n,conversationId:r,role:i})=>({content:Tm(e??[]),conversationId:r,createdAt:t,id:n,role:i}),xm=(e,t,n,r,i)=>async s=>{const o=pi(e,t,r,i,!1,Ve(be.ListMessages)),{data:a,nextToken:c,errors:u}=await o({...s,filter:{conversationId:{eq:n}}});return{data:a.map(l=>Qa(l)),nextToken:c,errors:u}},Pm=({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:r,contentBlockDoneAtIndex:i,contentBlockDeltaIndex:s,contentBlockText:o,contentBlockToolUse:a,stopReason:c,errors:u})=>u?{error:{id:e,conversationId:t,associatedUserMessageId:n,errors:u}}:{next:_m({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:r,contentBlockDoneAtIndex:i,contentBlockDeltaIndex:s,text:o,toolUse:Rm(a),stopReason:c})},Rm=e=>{if(e)return{...e,input:JSON.parse(e.input)}},_m=e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==null)),km=(e,t,n,r,i)=>s=>{const{conversations:o}=t;if(!o)return{};const a=o[r].message.subscribe;return nr(e,t,"subscription",a,!1,i,Ve(be.OnStreamEvent))({conversationId:n}).subscribe(u=>{const{next:l,error:d}=Pm(u);d&&s.error(d),l&&s.next(l)})},Om=e=>JSON.stringify(e),Dm=e=>e.map(t=>t.image?Xa(t):t.document?Mm(t):t.toolResult?Fm(t):t),Lm=({tools:e})=>({tools:Object.entries(e).map(([t,n])=>({toolSpec:{name:t,description:n.description,inputSchema:{json:JSON.stringify(n.inputSchema.json)}}}))}),Xa=({image:e})=>({image:{...e,source:{...e.source,bytes:za(e.source.bytes)}}}),Mm=({document:e})=>({document:{...e,source:{...e.source,bytes:za(e.source.bytes)}}}),Um=({json:e})=>({json:JSON.stringify(e)}),Fm=({toolResult:e})=>({toolResult:{...e,content:e.content.map(t=>t.image?Xa(t):t.json?Um(t):t)}}),qm=(e,t,n,r,i)=>async s=>{const{conversations:o}=t;if(!o)return{};const a=typeof s=="string"?{content:[{text:s}]}:s,{content:c,aiContext:u,toolConfiguration:l}=a,d=o[r].message.send,h=nr(e,t,"mutation",d,!1,i,Ve(be.SendMessage)),{data:f,errors:p}=await h({conversationId:n,content:Dm(c),...u&&{aiContext:Om(u)},...l&&{toolConfiguration:Lm(l)}});return{data:f&&Qa(f),errors:p}},cn=(e,t,n,r,i,s,o,a,c,u)=>{if(!n)throw new Error(`An error occurred converting a ${s} conversation: Missing ID`);return{id:n,createdAt:r,updatedAt:i,metadata:c,name:u,onStreamEvent:km(e,t,n,s,a),sendMessage:qm(e,t,n,s,a),listMessages:xm(e,t,n,o,a)}},$m=(e,t,n,r,i,s)=>async o=>{const{name:a,metadata:c}=o??{},u=JSON.stringify(c),l=an(e,t,r,"CREATE",s,!1,Ve(be.CreateConversation)),{data:d,errors:h}=await l({name:a,metadata:u});return{data:cn(e,t,d==null?void 0:d.id,d==null?void 0:d.createdAt,d==null?void 0:d.updatedAt,n,i,s,d==null?void 0:d.metadata,d==null?void 0:d.name),errors:h}},Bm=(e,t,n,r,i,s)=>async({id:o})=>{const a=an(e,t,r,"GET",s,!1,Ve(be.GetConversation)),{data:c,errors:u}=await a({id:o});return{data:c&&cn(e,t,c.id,c.createdAt,c.updatedAt,n,i,s,c==null?void 0:c.metadata,c==null?void 0:c.name),errors:u}},Km=(e,t,n,r,i,s)=>async o=>{const a=pi(e,t,r,s,!1,Ve(be.ListConversations)),{data:c,nextToken:u,errors:l}=await a(o);return{data:c.map(d=>cn(e,t,d.id,d.createdAt,d.updatedAt,n,i,s,d==null?void 0:d.metadata,d==null?void 0:d.name)),nextToken:u,errors:l}},Vm=(e,t,n,r,i,s)=>async({id:o})=>{const a=an(e,t,r,"DELETE",s,!1,Ve(be.DeleteConversation)),{data:c,errors:u}=await a({id:o});return{data:c&&cn(e,t,c==null?void 0:c.id,c==null?void 0:c.createdAt,c==null?void 0:c.updatedAt,n,i,s,c==null?void 0:c.metadata,c==null?void 0:c.name),errors:u}},jm=(e,t,n,r,i,s)=>async({id:o,metadata:a,name:c})=>{const u=JSON.stringify(a),l=an(e,t,r,"UPDATE",s,!1,Ve(be.UpdateConversation)),{data:d,errors:h}=await l({id:o,metadata:u,name:c});return{data:d&&cn(e,t,d==null?void 0:d.id,d==null?void 0:d.createdAt,d==null?void 0:d.updatedAt,n,i,s,d==null?void 0:d.metadata,d==null?void 0:d.name),errors:h}};function Hm(e,t,n){const r=t==null?void 0:t.modelIntrospection;if(!(r!=null&&r.conversations))return{};const i={};for(const{name:s,conversation:o,message:a,models:c,nonModels:u,enums:l}of Object.values(r.conversations)){const d=c[o.modelName],h=c[a.modelName];if(!d||!h)return{};const f={...r,models:{...r.models,...c},nonModels:{...r.nonModels,...u},enums:{...r.enums,...l}};i[s]={update:jm(e,f,s,d,h,n),create:$m(e,f,s,d,h,n),get:Bm(e,f,s,d,h,n),delete:Vm(e,f,s,d,h,n),list:Km(e,f,s,d,h,n)}}return i}function Gm(e,t,n){const r=t==null?void 0:t.modelIntrospection;if(!(r!=null&&r.generations))return{};const i={};for(const s of Object.values(r.generations))i[s.name]=nr(e,r,"query",s,!1,n,Ve(be.Generation));return i}const Wm=e=>{const t=e.modelIntrospection;if(!t)return{};const n={};for(const[r,i]of Object.entries(t.enums))n[i.name]={values:()=>i.values};return n};function zm(e,t,n,r,i,s=!1){return s?(c,u,l)=>lo(e,t,n,r,i,{...u,...l},c):(c,u)=>lo(e,t,n,r,i,{...c,...u})}function Ym(e,t,n,r,i){const{data:s,extensions:o}=n,[a]=Object.keys(s);if(s[a].items){const c=s[a].items.map(u=>$e(e,t,u));return{data:r?c:i(c),nextToken:s[a].nextToken,extensions:o}}return{data:s[a],nextToken:s[a].nextToken,extensions:o}}function lo(e,t,n,r,i,s,o){return Ge(async a=>{var f,p,g,m;const{name:c}=n,u=Zn(t,n,"INDEX_QUERY",s,r),l=er(n,"INDEX_QUERY",s,t,r),d=Pt(e,i,s),h=E=>Be(e,c,E,t,d.authMode,d.authToken,!!o);try{const E=Rt(e,i,s==null?void 0:s.headers),w=[{...d,query:u,variables:l},E];o!==void 0&&w.unshift(o);const I=e.graphql(...w),A=await We(I,a);if(A.data!==void 0)return Ym(t,c,A,s==null?void 0:s.selectionSet,h)}catch(E){const{data:S,errors:w}=E;if(S!=null&&Object.keys(S).length!==0&&w){const[I]=Object.keys(S);if((f=S[I])!=null&&f.items){const v=(p=S[I])==null?void 0:p.items.map(A=>$e(t,c,A));if(v)return{data:s!=null&&s.selectionSet?v:h(v),nextToken:(g=S[I])==null?void 0:g.nextToken}}return{data:S[I],nextToken:(m=S[I])==null?void 0:m.nextToken}}else return Mr(E)}})}function Jm(e,t,n,r,i){const{name:s}=n;return a=>{const c=Zn(t,n,r,a),u=er(n,r,a,t),l=Pt(e,i,a),d=Rt(e,i,a==null?void 0:a.headers);return e.graphql({...l,query:c,variables:u},d).pipe(Wr(f=>{const[p]=Object.keys(f.data),g=f.data[p],m=$e(t,s,g);if(m===null)return null;if(a!=null&&a.selectionSet)return m;{const[E]=Be(e,s,[m],t,l.authMode,l.authToken);return E}}))}}function Qm(e){const{primaryKeyFieldName:t,sortKeyFieldNames:n}=e.primaryKeyInfo;return[t,...n]}function Xm(e,t,n){const r=Object.fromEntries(n.map(i=>[i,e[i]]));for(let i=0;i<t.length;i++)if(Object.keys(r).every(s=>r[s]===t[i][s]))return i;return-1}function Zm(e,t){const{name:n}=t;return i=>new ae(s=>{const o=[],a=[];let c=(...p)=>a.push(...p);const u=e[n].onCreate(i).subscribe({next(p){c({item:p,type:"create"})},error(p){s.error({type:"onCreate",error:p})}}),l=e[n].onUpdate(i).subscribe({next(p){c({item:p,type:"update"})},error(p){s.error({type:"onUpdate",error:p})}}),d=e[n].onDelete(i).subscribe({next(p){c({item:p,type:"delete"})},error(p){s.error({type:"onDelete",error:p})}});function h(p){for(const g of p){const m=Xm(g.item,o,f);switch(g.type){case"create":m<0&&o.push(g.item);break;case"update":m>=0&&(o[m]=g.item);break;case"delete":m>=0&&o.splice(m,1);break;default:console.error("Unrecognized message in observeQuery.",g)}}s.next({items:o,isSynced:!0})}const f=Qm(t);return(async()=>{let p=!0,g=null;for(;!s.closed&&(p||g);){p=!1;const{data:m,errors:E,nextToken:S}=await e[n].list({...i,nextToken:g});g=S,o.push(...m);const w=a.length===0&&g==null;if(s.next({items:o,isSynced:w}),Array.isArray(E))for(const I of E)s.error(I)}a.length>0&&h(a),c=(...m)=>(h(m),o.length)})(),()=>{u.unsubscribe(),l.unsubscribe(),d.unsubscribe()}})}const ey=e=>{var t,n,r;return e.type==="key"&&((t=e.properties)==null?void 0:t.name)&&((n=e.properties)==null?void 0:n.queryField)&&((r=e.properties)==null?void 0:r.fields.length)>0},ty=e=>{var n;return((n=e.attributes)==null?void 0:n.filter(ey).map(r=>{const i=r.properties.queryField,[s,...o]=r.properties.fields;return{queryField:i,pk:s,sk:o}}))||[]},ny=(e,t)=>{var a;const n=(a=e.models[t].attributes)==null?void 0:a.find(c=>c.type==="model"),r={queries:["list","get","observeQuery"],mutations:["create","update","delete"],subscriptions:["onCreate","onUpdate","onDelete"]},i=[];if(!n)return Dr;if(n.properties)for(const[c,u]of Object.entries(n.properties))c in r&&(u===null?i.push(...r[c]):u instanceof Object&&i.push(...Object.keys(u)));i.includes("list")&&i.push("observeQuery");const s=i.map(c=>c.toUpperCase());return Object.fromEntries(Object.entries(Dr).filter(([c])=>!s.includes(c)))};function ry(e,t,n){const r={},i=t.modelIntrospection;if(!i)return{};const s=["ONCREATE","ONUPDATE","ONDELETE"];for(const o of Object.values(i.models)){const{name:a}=o;r[a]={};const c=ny(i,a);Object.entries(c).forEach(([l,{operationPrefix:d}])=>{const h=l;h==="LIST"?r[a][d]=pi(e,i,o,n):s.includes(h)?r[a][d]=Jm(e,i,o,h,n):h==="OBSERVEQUERY"?r[a][d]=Zm(r,o):r[a][d]=an(e,i,o,h,n)});const u=ty(o);for(const l of u)r[a][l.queryField]=zm(e,i,o,l,n)}return r}function Za(e,t,n){return sm(e),e.models=ry(e,t,n),e.enums=Wm(t),e.queries=vm(e,t,n),e.mutations=Em(e,t,n),e.subscriptions=Sm(e,t,n),e.conversations=Hm(e,t,n),e.generations=Gm(e,t,n),e}function iy(e){return hi in e}class sy extends rm{getModuleName(){return"GraphQLAPI"}graphql(t,n,r){const i={category:kn.API,action:yr.GraphQl};if(iy(n)){const{[hi]:s,...o}=n;return super.graphql(t,o,r,{...i,...s})}return super.graphql(t,n,r,{...i})}isCancelError(t){return super.isCancelError(t)}cancel(t,n){return super.cancel(t,n)}}const gi=new sy;function oy(e,t){const n=di(this),r=n.endpoint,i=n.authMode,s=n.apiKey;if(e.authMode=e.authMode||i,e.apiKey=e.apiKey??s,e.authToken=e.authToken||n.authToken,r&&e.authMode==="apiKey"&&!e.apiKey)throw new Error("graphql() requires an explicit `apiKey` for a custom `endpoint` when `authMode = 'apiKey'`.");const o=t||n.headers;return gi.graphql(n.amplify,{...e,endpoint:r},o)}function ay(e,t){return gi.cancel(e,t)}function cy(e){return gi.isCancelError(e)}function ec(e){return e!==void 0}function uy(e){return e.event==="configure"}function ly(e){var r;const t={[Fa]:e.amplify,[xn]:e.authMode,[qa]:e.authToken,[Or]:"apiKey"in e?e.apiKey:void 0,[Pn]:"endpoint"in e?e.endpoint:void 0,[$a]:e.headers,graphql:oy,cancel:ay,isCancelError:cy,models:Mt,enums:Mt,queries:Mt,mutations:Mt,subscriptions:Mt},n=(r=e.amplify.getConfig().API)==null?void 0:r.GraphQL;if(t[Pn]){if(!t[xn])throw new Error("generateClient() requires an explicit `authMode` when `endpoint` is provided.");if(t[xn]==="apiKey"&&!t[Or])throw new Error("generateClient() requires an explicit `apiKey` when `endpoint` is provided and `authMode = 'apiKey'`.")}return t[Pn]||(ec(n)?Za(t,n,di):dy(t)),t}const dy=e=>{Qe.listen("core",t=>{var r;if(!uy(t.payload))return;const n=(r=t.payload.data.API)==null?void 0:r.GraphQL;ec(n)&&Za(e,n,di)})},Mt=new Proxy({},{get(){throw new Error("Client could not be generated. This is likely due to `Amplify.configure()` not being called prior to `generateClient()` or because the configuration passed to `Amplify.configure()` is missing GraphQL provider configuration.")}});function tc(e){return ly({amplify:K})}class hy{constructor(){this.client=null,this.currentUser=null,this.authStateListeners=[],this.initializeAmplify()}async initializeAmplify(){try{const t=await po(()=>import("./amplify_outputs-tWmn_gNy.js"),[],import.meta.url);console.log("Using Amplify configuration"),op.configure(t.default||t),this.client=tc(),this.initializeAuthState()}catch(t){throw console.error("Failed to load Amplify configuration:",t),new Error("Amplify configuration required")}}async initializeAuthState(){try{const t=await Kt();this.currentUser=t,this.notifyAuthStateChange(!0)}catch{this.currentUser=null,this.notifyAuthStateChange(!1)}}async ensureInitialized(){this.client||await this.initializeAmplify()}async signIn(t,n,r=!1){try{console.log("Attempting to sign in:",t);const i=await Nf({username:t,password:n});if(console.log("Sign in result:",i),i.nextStep){if(console.log("Sign in requires additional steps:",i.nextStep),i.nextStep.signInStep==="CONFIRM_SIGN_UP")return{success:!1,error:"Please verify your email first",code:"UserNotConfirmedException",needsVerification:!0,email:t};if(i.nextStep.signInStep==="DONE")console.log("Authentication completed successfully");else return{success:!1,error:"Additional authentication step required: "+i.nextStep.signInStep,nextStep:i.nextStep}}return console.log("Sign in successful, creating user profile..."),this.currentUser=i,await this.createOrUpdateUserProfile(i),this.notifyAuthStateChange(!0),{success:!0,user:i}}catch(i){return console.error("Sign in error:",i),this.handleAuthError(i)}}async signUp(t,n){try{console.log("Attempting to sign up:",t);const r=await _f({username:t,password:n,options:{userAttributes:{email:t}}});return{success:!0,userId:r.userId,nextStep:r.nextStep,needsVerification:r.nextStep.signUpStep==="CONFIRM_SIGN_UP"}}catch(r){return console.error("Sign up error:",r),this.handleAuthError(r)}}async confirmSignUp(t,n){try{console.log("Confirming sign up for:",t);const r=await qf({username:t,confirmationCode:n});return r.isSignUpComplete?{success:!0,autoSignIn:!0}:{success:!0,nextStep:r.nextStep}}catch(r){return console.error("Confirm sign up error:",r),this.handleAuthError(r)}}async resendSignUpCode(t){try{return console.log("Resending verification code for:",t),await Uf({username:t}),{success:!0}}catch(n){return console.error("Resend code error:",n),this.handleAuthError(n)}}async resetPassword(t){try{console.log("Initiating password reset for:",t);const n=await Of({username:t});return console.log("Password reset initiated:",n),{success:!0,nextStep:n.nextStep,codeDeliveryDetails:n.nextStep.resetPasswordStep==="CONFIRM_RESET_PASSWORD_WITH_CODE"?n.nextStep.codeDeliveryDetails:null}}catch(n){return console.error("Reset password error:",n),n.name==="UserNotFoundException"?{success:!1,error:"No account found with this email address",code:n.name}:n.name==="InvalidParameterException"?{success:!1,error:"Please enter a valid email address",code:n.name}:this.handleAuthError(n)}}async confirmResetPassword(t,n,r){try{return console.log("Confirming password reset for:",t),await Lf({username:t,confirmationCode:n,newPassword:r}),console.log("Password reset successful"),{success:!0}}catch(i){return console.error("Confirm reset password error:",i),this.handleAuthError(i)}}async createOrUpdateUserProfile(t){var n,r;try{await this.ensureInitialized();const i=t.userId||t.username;if(console.log("Creating/updating user profile for:",i),(await this.client.models.UserProfile.get({userId:i})).data)await this.client.models.UserProfile.update({userId:i,lastActiveAt:new Date().toISOString()}),console.log("Updated existing user profile");else{const o=this.generateUsername(((n=t.signInDetails)==null?void 0:n.loginId)||i);await this.client.models.UserProfile.create({userId:i,username:o,email:((r=t.signInDetails)==null?void 0:r.loginId)||i,currentSeason:"2025",totalSurvivedRaces:0,isEliminated:!1,notificationsEnabled:!0,joinedAt:new Date().toISOString()}),console.log("Created new user profile"),await this.migrateLocalStoragePicks(i)}}catch(i){console.error("Error managing user profile:",i)}}generateUsername(t){return t?t.split("@")[0].replace(/[^a-zA-Z0-9]/g,""):`Player${Math.floor(Math.random()*1e4)}`}async migrateLocalStoragePicks(t){try{await this.ensureInitialized();const n=JSON.parse(localStorage.getItem("f1survivor_user_picks")||"{}");if(n.picks&&n.picks.length>0){console.log("Migrating picks from localStorage:",n.picks.length);for(const r of n.picks)(await this.client.models.DriverPick.list({filter:{userId:{eq:t},raceId:{eq:r.raceId}}})).data.length===0&&await this.client.models.DriverPick.create({userId:t,seasonId:"2025",raceId:r.raceId,driverId:r.driverId.toString(),driverName:r.driverName,teamName:r.teamName,raceName:r.raceName||"",submittedAt:r.timestamp,pickDeadline:new Date(r.timestamp).toISOString(),isAutoPick:r.isAutoPick||!1});localStorage.removeItem("f1survivor_user_picks"),console.log("Successfully migrated picks from localStorage")}}catch(n){console.error("Error migrating picks:",n)}}async signOut(){try{return console.log("Signing out user"),await Qf(),this.currentUser=null,this.notifyAuthStateChange(!1),sessionStorage.clear(),{success:!0}}catch(t){return console.error("Sign out error:",t),this.handleAuthError(t)}}async getCurrentUser(){try{if(this.currentUser)return this.currentUser;const t=await Kt();return this.currentUser=t,t}catch{return null}}async isAuthenticated(){try{return await Kt(),!0}catch{return!1}}async getSession(){try{return await zr()}catch{return null}}onAuthStateChange(t){return this.authStateListeners.push(t),this.isAuthenticated().then(n=>t(n)),()=>{const n=this.authStateListeners.indexOf(t);n>-1&&this.authStateListeners.splice(n,1)}}notifyAuthStateChange(t){this.authStateListeners.forEach(n=>{n(t)})}handleAuthError(t){return{success:!1,error:{UserNotFoundException:"No account found with this email",NotAuthorizedException:"Incorrect email or password",UserNotConfirmedException:"Please verify your email first",UsernameExistsException:"An account with this email already exists",InvalidPasswordException:"Password does not meet requirements",LimitExceededException:"Too many attempts. Please try again later",NetworkError:"Network error. Please check your connection",CodeMismatchException:"Invalid verification code",ExpiredCodeException:"Verification code has expired",InvalidParameterException:"Please check your input and try again"}[t.name]||t.message||"Authentication failed",code:t.name}}}const U=new hy,xy=Object.freeze(Object.defineProperty({__proto__:null,authManager:U},Symbol.toStringTag,{value:"Module"}));class fy{constructor(){this.modal=null,this.currentForm="signin",this.pendingEmail="",this.isInitialized=!1,this.init()}async init(){if(!this.isInitialized)try{await this.loadAuthModal(),this.setupEventListeners(),this.setupPasswordValidation(),this.isInitialized=!0,console.log("Auth UI initialized successfully")}catch(t){console.error("Failed to initialize Auth UI:",t)}}async loadAuthModal(){try{const t=await fetch("/auth-modal.html");if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.text(),r=document.createElement("div");r.innerHTML=n,document.body.appendChild(r.firstElementChild),this.modal=document.getElementById("auth-modal"),console.log("Auth modal loaded successfully")}catch(t){console.error("Failed to load auth modal:",t),console.log("Using fallback modal creation"),this.createComprehensiveModal()}}createComprehensiveModal(){console.log("Creating comprehensive fallback modal"),document.body.insertAdjacentHTML("beforeend",`
      <div id="auth-modal" class="auth-modal">
        <div class="auth-modal-content">
          <button class="close-btn" id="close-auth-modal">&times;</button>
          
          <!-- Tab Navigation -->
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="signin">Sign In</button>
            <button class="auth-tab" data-tab="signup">Sign Up</button>
          </div>
          
          <!-- Sign In Form -->
          <form id="signin-form" class="auth-form active">
            <h2>Welcome Back</h2>
            <p class="auth-subtitle">Sign in to make your picks</p>
            
            <div class="form-group">
              <input type="email" id="signin-email" placeholder="Email" required>
            </div>
            
            <div class="form-group">
              <input type="password" id="signin-password" placeholder="Password" required>
            </div>
            
            <div class="form-options">
              <label>
                <input type="checkbox" id="remember-me"> Remember me
              </label>
              <a href="#" id="forgot-password-link">Forgot password?</a>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Sign In</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="auth-error" id="signin-error"></div>
          </form>
          
          <!-- Sign Up Form -->
          <form id="signup-form" class="auth-form">
            <h2>Join F1 Survivor</h2>
            <p class="auth-subtitle">Create an account to start playing</p>
            
            <div class="form-group">
              <input type="email" id="signup-email" placeholder="Email" required>
            </div>
            
            <div class="form-group">
              <input type="password" id="signup-password" placeholder="Password" required>
              <div class="password-requirements">
                <span class="requirement" data-req="length">8+ characters</span>
                <span class="requirement" data-req="lowercase">Lowercase</span>
                <span class="requirement" data-req="uppercase">Uppercase</span>
                <span class="requirement" data-req="number">Number</span>
                <span class="requirement" data-req="symbol">Symbol</span>
              </div>
            </div>
            
            <div class="form-group">
              <input type="password" id="signup-confirm" placeholder="Confirm Password" required>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Create Account</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="auth-error" id="signup-error"></div>
          </form>
          
          <!-- Email Verification Form -->
          <form id="verify-form" class="auth-form" style="display: none;">
            <h2>Verify Your Email</h2>
            <p class="auth-subtitle">We sent a verification code to <span id="verify-email"></span></p>
            
            <div class="form-group">
              <input type="text" id="verification-code" placeholder="Enter 6-digit code" maxlength="6" required>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Verify Email</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="form-options">
              <a href="#" id="resend-code-link">Resend code</a>
            </div>
            
            <div class="auth-error" id="verify-error"></div>
          </form>

          <!-- Password Reset Form -->
          <form id="reset-form" class="auth-form" style="display: none;">
            <h2>Reset Password</h2>
            <p class="auth-subtitle">Enter your email to reset your password</p>
            
            <div class="form-group">
              <input type="email" id="reset-email" placeholder="Email" required>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Send Reset Code</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="form-options">
              <a href="#" id="back-to-signin-link">Back to Sign In</a>
            </div>
            
            <div class="auth-error" id="reset-error"></div>
          </form>
        </div>
      </div>
    `),this.modal=document.getElementById("auth-modal")}setupEventListeners(){if(!this.modal)return;this.modal.querySelectorAll(".auth-tab").forEach(h=>{h.addEventListener("click",f=>{f.preventDefault(),this.switchTab(h.dataset.tab)})});const n=this.modal.querySelector("#close-auth-modal");n&&n.addEventListener("click",()=>this.hideModal()),this.modal.addEventListener("click",h=>{h.target===this.modal&&this.hideModal()}),document.addEventListener("keydown",h=>{h.key==="Escape"&&this.modal.classList.contains("show")&&this.hideModal()});const r=this.modal.querySelector("#signin-form"),i=this.modal.querySelector("#signup-form"),s=this.modal.querySelector("#verify-form"),o=this.modal.querySelector("#reset-form"),a=this.modal.querySelector("#confirm-reset-form");r&&r.addEventListener("submit",h=>this.handleSignIn(h)),i&&i.addEventListener("submit",h=>this.handleSignUp(h)),s&&s.addEventListener("submit",h=>this.handleVerification(h)),o&&o.addEventListener("submit",h=>this.handlePasswordReset(h)),a&&a.addEventListener("submit",h=>this.handleConfirmPasswordReset(h));const c=this.modal.querySelector("#forgot-password-link");c&&c.addEventListener("click",h=>{h.preventDefault(),this.switchTab("reset")});const u=this.modal.querySelector("#resend-code-link");u&&u.addEventListener("click",h=>this.handleResendCode(h));const l=this.modal.querySelector("#back-to-signin-link");l&&l.addEventListener("click",h=>{h.preventDefault(),this.switchTab("signin")});const d=this.modal.querySelector("#back-to-reset-link");d&&d.addEventListener("click",h=>{h.preventDefault(),this.switchTab("reset")})}setupPasswordValidation(){this.setupPasswordValidationForForm("#signup-password","#signup-form"),this.setupPasswordValidationForForm("#new-password","#confirm-reset-form")}setupPasswordValidationForForm(t,n){var o,a;const r=(o=this.modal)==null?void 0:o.querySelector(t),i=(a=this.modal)==null?void 0:a.querySelector(n),s=i==null?void 0:i.querySelectorAll(".requirement");!r||!s.length||r.addEventListener("input",()=>{const c=r.value;s.forEach(u=>{const l=u.dataset.req;let d=!1;switch(l){case"length":d=c.length>=8;break;case"lowercase":d=/[a-z]/.test(c);break;case"uppercase":d=/[A-Z]/.test(c);break;case"number":d=/\d/.test(c);break;case"symbol":d=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(c);break}u.classList.toggle("valid",d),u.classList.toggle("invalid",!d&&c.length>0)})})}async showModal(t="signin"){if(this.modal||(console.log("Modal not ready, initializing..."),await this.init()),!this.modal){console.error("Auth modal could not be initialized");return}this.switchTab(t),this.modal.classList.add("show"),setTimeout(()=>{const n=this.modal.querySelector(".auth-form.active input");n&&n.focus()},100)}hideModal(){this.modal&&(this.modal.classList.remove("show"),this.clearErrors(),this.clearForms())}switchTab(t){if(!this.modal)return;console.log("Switching to tab:",t),this.currentForm=t,this.modal.querySelectorAll(".auth-tab").forEach(s=>{s.classList.toggle("active",s.dataset.tab===t)}),this.modal.querySelectorAll(".auth-form").forEach(s=>{s.style.display="none",s.classList.remove("active")});const i=this.modal.querySelector(`#${t}-form`);i?(i.style.display="block",i.classList.add("active"),console.log("Form displayed:",t,i)):console.error("Form not found:",`#${t}-form`),this.clearErrors()}async handleSignIn(t){var s;t.preventDefault();const n=this.modal.querySelector("#signin-email").value,r=this.modal.querySelector("#signin-password").value,i=((s=this.modal.querySelector("#remember-me"))==null?void 0:s.checked)||!1;this.setLoading("signin",!0),this.clearErrors();try{const o=await U.signIn(n,r,i);o.success?(console.log("Sign in successful"),this.showSuccess("signin","Sign in successful!"),setTimeout(()=>{this.hideModal(),this.handleSuccessfulAuth()},1e3)):(console.log("Sign in failed:",o),o.needsVerification?(console.log("User needs email verification"),this.pendingEmail=o.email||n,this.showError("signin",o.error+" Redirecting to verification..."),setTimeout(()=>{this.switchTab("verify"),this.modal.querySelector("#verify-email").textContent=this.pendingEmail,this.clearErrors()},2e3)):this.showError("signin",o.error))}catch(o){console.error("Sign in error:",o),this.showError("signin","An unexpected error occurred. Please try again.")}finally{this.setLoading("signin",!1)}}async handleSignUp(t){t.preventDefault();const n=this.modal.querySelector("#signup-email").value,r=this.modal.querySelector("#signup-password").value,i=this.modal.querySelector("#signup-confirm").value;if(r!==i){this.showError("signup","Passwords do not match");return}if(!this.validatePassword(r)){this.showError("signup","Password does not meet requirements");return}this.setLoading("signup",!0),this.clearErrors();try{const s=await U.signUp(n,r);s.success?(console.log("Sign up successful, result:",s),console.log("needsVerification:",s.needsVerification),console.log("nextStep:",s.nextStep),this.pendingEmail=n,s.needsVerification!==!1?(console.log("Switching to verification tab"),this.switchTab("verify"),this.modal.querySelector("#verify-email").textContent=n):(console.log("Auto-confirmed user, showing success"),this.showSuccess("signup","Account created and confirmed successfully!"),setTimeout(()=>this.switchTab("signin"),3e3))):this.showError("signup",s.error)}catch(s){console.error("Sign up error:",s),this.showError("signup","An unexpected error occurred. Please try again.")}finally{this.setLoading("signup",!1)}}async handleVerification(t){t.preventDefault();const n=this.modal.querySelector("#verification-code").value;if(!n||n.length!==6){this.showError("verify","Please enter a valid 6-digit code");return}this.setLoading("verify",!0),this.clearErrors();try{const r=await U.confirmSignUp(this.pendingEmail,n);r.success?(console.log("Email verification successful"),this.showSuccess("verify","Email verified successfully!"),r.autoSignIn?setTimeout(async()=>{const i=this.modal.querySelector("#signup-password").value;(await U.signIn(this.pendingEmail,i)).success?(this.hideModal(),this.handleSuccessfulAuth()):this.switchTab("signin")},1e3):setTimeout(()=>this.switchTab("signin"),2e3)):this.showError("verify",r.error)}catch(r){console.error("Verification error:",r),this.showError("verify","An unexpected error occurred. Please try again.")}finally{this.setLoading("verify",!1)}}async handleResendCode(t){t.preventDefault();try{const n=await U.resendSignUpCode(this.pendingEmail);n.success?this.showSuccess("verify","Verification code sent!"):this.showError("verify",n.error)}catch(n){console.error("Resend code error:",n),this.showError("verify","Failed to resend code. Please try again.")}}async handlePasswordReset(t){t.preventDefault();const n=this.modal.querySelector("#reset-email").value;if(!n){this.showError("reset","Please enter your email address");return}this.setLoading("reset",!0),this.clearErrors();try{console.log("Initiating password reset for:",n);const r=await U.resetPassword(n);r.success?(this.pendingEmail=n,this.showSuccess("reset","If an account with this email exists, you will receive a reset code shortly."),setTimeout(()=>{this.switchTab("confirm-reset"),this.modal.querySelector("#confirm-reset-email").textContent=n,this.clearErrors()},2e3)):this.showError("reset",r.error)}catch(r){console.error("Password reset error:",r),this.showError("reset","An unexpected error occurred. Please try again.")}finally{this.setLoading("reset",!1)}}async handleConfirmPasswordReset(t){t.preventDefault();const n=this.modal.querySelector("#reset-code").value,r=this.modal.querySelector("#new-password").value,i=this.modal.querySelector("#confirm-new-password").value;if(!n||n.length!==6){this.showError("confirm-reset","Please enter a valid 6-digit code");return}if(!r){this.showError("confirm-reset","Please enter a new password");return}if(!this.validatePassword(r)){this.showError("confirm-reset","Password does not meet requirements");return}if(r!==i){this.showError("confirm-reset","Passwords do not match");return}this.setLoading("confirm-reset",!0),this.clearErrors();try{console.log("Confirming password reset");const s=await U.confirmResetPassword(this.pendingEmail,n,r);s.success?(this.showSuccess("confirm-reset","Password reset successful! You can now sign in."),setTimeout(()=>{this.switchTab("signin"),this.modal.querySelector("#signin-email").value=this.pendingEmail,this.clearForms()},2e3)):this.showError("confirm-reset",s.error)}catch(s){console.error("Confirm password reset error:",s),this.showError("confirm-reset","An unexpected error occurred. Please try again.")}finally{this.setLoading("confirm-reset",!1)}}validatePassword(t){return t.length>=8&&/[a-z]/.test(t)&&/[A-Z]/.test(t)&&/\d/.test(t)&&/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)}setLoading(t,n){const r=this.modal.querySelector(`#${t}-form .auth-submit`),i=r==null?void 0:r.querySelector(".button-text"),s=r==null?void 0:r.querySelector(".loading-spinner");r&&(r.disabled=n),i&&s&&(i.style.display=n?"none":"inline",s.style.display=n?"inline":"none")}showError(t,n){const r=this.modal.querySelector(`#${t}-error`);r&&(r.textContent=n,r.classList.add("show"))}showSuccess(t,n){const r=this.modal.querySelector(".auth-success");r&&r.remove();const i=document.createElement("div");i.className="auth-success show",i.textContent=n;const s=this.modal.querySelector(`#${t}-form`);s&&s.appendChild(i)}clearErrors(){this.modal.querySelectorAll(".auth-error").forEach(r=>{r.classList.remove("show"),r.textContent=""}),this.modal.querySelectorAll(".auth-success").forEach(r=>r.remove())}clearForms(){this.modal.querySelectorAll("form").forEach(r=>r.reset()),this.modal.querySelectorAll(".requirement").forEach(r=>{r.classList.remove("valid","invalid")})}handleSuccessfulAuth(){const t=sessionStorage.getItem("redirectAfterAuth");t?(sessionStorage.removeItem("redirectAfterAuth"),window.location.href=t):window.location.reload()}}const py=new fy;window.showAuthModal=async(e="signin")=>{await py.showModal(e)};const rr={USER_PICKS:"f1survivor_user_picks",CURRENT_SEASON:"f1survivor_season",USER_SETTINGS:"f1survivor_settings"};function nc(e,t=null){try{let n=mi();console.log("Existing picks before save:",n),Array.isArray(n)||(console.log("Converting existing picks to array"),n=[]);const r=JSON.parse(localStorage.getItem("nextRaceData"));if(!r||!r.raceId)throw new Error("No valid race data found. Cannot save pick.");const i={driverId:parseInt(e),timestamp:new Date().toISOString(),raceId:r.raceId,driverName:(t==null?void 0:t.driverName)||null,teamName:(t==null?void 0:t.teamName)||null,isAutoPick:(t==null?void 0:t.isAutoPick)||!1},s=n.findIndex(a=>a.raceId===r.raceId);s!==-1?(n[s]=i,console.log("Updated existing pick for race:",r.raceId)):(n.push(i),console.log("Added new pick for race:",r.raceId));const o={userId:"local-user",currentSeason:Xt(),picks:n};return console.log("Saving picks data:",o),localStorage.setItem(rr.USER_PICKS,JSON.stringify(o)),i}catch(n){throw console.error("Failed to save picks to localStorage:",n),n}}function mi(){try{const e=localStorage.getItem(rr.USER_PICKS);if(!e)return[];const t=JSON.parse(e);return t.currentSeason!==Xt()?[]:t.picks?Array.isArray(t.picks)?t.picks:typeof t.picks=="object"&&t.picks.driverId?[t.picks]:typeof t.picks=="number"?[{driverId:t.picks,timestamp:new Date().toISOString()}]:[]:[]}catch(e){return console.error("Failed to load picks from localStorage:",e),[]}}function Xt(){return"2025"}const gy=Object.freeze(Object.defineProperty({__proto__:null,STORAGE_KEYS:rr,getCurrentSeason:Xt,loadUserPicks:mi,saveUserPicks:nc},Symbol.toStringTag,{value:"Module"})),my={...rr,USER_LEAGUES:"f1survivor_user_leagues",LEAGUE_DATA:"f1survivor_league_data",ACTIVE_LEAGUE:"f1survivor_active_league",USER_ID:"f1survivor_user_id",USER_NAME:"f1survivor_user_name"};class yy{constructor(){this.STORAGE_KEYS=my,this.currentUserId=this.getCurrentUserId()}getCurrentUserId(){let t=localStorage.getItem(this.STORAGE_KEYS.USER_ID);return t||(t=`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(this.STORAGE_KEYS.USER_ID,t)),t}getCurrentUsername(){let t=localStorage.getItem(this.STORAGE_KEYS.USER_NAME);return t||(t=`Player${Math.floor(Math.random()*1e4)}`,localStorage.setItem(this.STORAGE_KEYS.USER_NAME,t)),t}setUsername(t){localStorage.setItem(this.STORAGE_KEYS.USER_NAME,t)}getAllLeagues(){try{const t=localStorage.getItem(this.STORAGE_KEYS.LEAGUE_DATA);return t?JSON.parse(t):{}}catch(t){return console.error("Failed to load leagues:",t),{}}}getLeague(t){return this.getAllLeagues()[t]||null}saveLeague(t){try{const n=this.getAllLeagues();return n[t.leagueId]=t,localStorage.setItem(this.STORAGE_KEYS.LEAGUE_DATA,JSON.stringify(n)),!0}catch(n){return console.error("Failed to save league:",n),!1}}getUserLeagueData(){try{const t=localStorage.getItem(this.STORAGE_KEYS.USER_LEAGUES);return t?JSON.parse(t):{userId:this.currentUserId,currentSeason:Xt(),activeLeagueId:null,leagues:[],createdLeagues:[]}}catch(t){return console.error("Failed to load user league data:",t),{userId:this.currentUserId,currentSeason:Xt(),activeLeagueId:null,leagues:[],createdLeagues:[]}}}saveUserLeagueData(t){try{return localStorage.setItem(this.STORAGE_KEYS.USER_LEAGUES,JSON.stringify(t)),!0}catch(n){return console.error("Failed to save user league data:",n),!1}}addUserToLeague(t,n=!1){const r=this.getUserLeagueData();r.leagues.includes(t)||r.leagues.push(t),n&&!r.createdLeagues.includes(t)&&r.createdLeagues.push(t),this.saveUserLeagueData(r)}removeUserFromLeague(t){const n=this.getUserLeagueData();n.leagues=n.leagues.filter(r=>r!==t),n.createdLeagues=n.createdLeagues.filter(r=>r!==t),n.activeLeagueId===t&&(n.activeLeagueId=null),this.saveUserLeagueData(n)}getActiveLeagueId(){return this.getUserLeagueData().activeLeagueId}setActiveLeagueId(t){const n=this.getUserLeagueData();n.activeLeagueId=t,this.saveUserLeagueData(n)}getActiveLeague(){const t=this.getActiveLeagueId();return t?this.getLeague(t):null}saveUserPicksWithLeague(t,n,r=null){return r?this.saveLeaguePick(r,t,n):nc(t,n)}saveLeaguePick(t,n,r){const i=this.getLeague(t);if(!i)throw new Error("League not found");const s=this.getCurrentUserId(),o=JSON.parse(localStorage.getItem("nextRaceData"));if(!o||!o.raceId)throw new Error("No valid race data found. Cannot save pick.");const a={driverId:parseInt(n),timestamp:new Date().toISOString(),raceId:o.raceId,driverName:(r==null?void 0:r.driverName)||null,teamName:(r==null?void 0:r.teamName)||null,isAutoPick:(r==null?void 0:r.isAutoPick)||!1};i.picks||(i.picks={}),i.picks[s]||(i.picks[s]=[]);const c=i.picks[s].findIndex(u=>u.raceId===o.raceId);return c!==-1?i.picks[s][c]=a:i.picks[s].push(a),this.saveLeague(i),a}loadUserPicksWithLeague(t=null){return t?this.loadLeaguePicks(t):mi()}loadLeaguePicks(t,n=null){const r=this.getLeague(t);if(!r)return[];const i=n||this.getCurrentUserId();return r.picks&&r.picks[i]?r.picks[i]:[]}isDriverAlreadyPickedInLeague(t,n){return this.loadLeaguePicks(n).some(i=>i.driverId===parseInt(t))}getCurrentRacePickForLeague(t){try{const n=JSON.parse(localStorage.getItem("nextRaceData"));return n&&this.loadLeaguePicks(t).find(i=>i.raceId===n.raceId)||null}catch(n){return console.error("Failed to get current race pick for league:",n),null}}getUserLeagues(){const t=this.getUserLeagueData(),n=this.getAllLeagues();return t.leagues.map(r=>n[r]).filter(r=>r!==null).map(r=>({...r,isOwner:r.ownerId===this.currentUserId}))}findLeagueByInviteCode(t){const n=this.getAllLeagues();return Object.values(n).find(r=>r.inviteCode===t.toUpperCase())||null}}const st=new yy;class rc{constructor(){this.client=tc(),this.currentSeason="season_2025"}async getUserPicks(t=null,n=null){const r=await U.getCurrentUser();if(!r)throw new Error("Authentication required");const s={userId:{eq:t||r.userId||r.username},seasonId:{eq:this.currentSeason}};return n&&(s.leagueId={eq:n}),(await this.client.models.DriverPick.list({filter:s,authMode:"userPool"})).data||[]}async saveUserPick(t){const n=await U.getCurrentUser();if(!n)throw new Error("Authentication required");const r=n.userId||n.username,i=await this.getCurrentRacePick(t.leagueId);if(i){console.log(`Updating existing pick for race ${t.raceId}: ${i.driverName} → ${t.driverName}`);const s={driverId:t.driverId.toString(),driverName:t.driverName,teamName:t.teamName,raceName:t.raceName||"Unknown Race",submittedAt:new Date().toISOString(),isAutoPick:t.isAutoPick||!1};return await this.client.models.DriverPick.update({id:i.id,...s},{authMode:"userPool"})}else{console.log(`Creating new pick for race ${t.raceId}: ${t.driverName}`);const o={pickId:`pick_${r}_${t.raceId}_${Date.now()}`,userId:r,seasonId:this.currentSeason,raceId:t.raceId,driverId:t.driverId.toString(),driverName:t.driverName,teamName:t.teamName,raceName:t.raceName||"Unknown Race",submittedAt:new Date().toISOString(),pickDeadline:t.pickDeadline||new Date().toISOString(),isAutoPick:t.isAutoPick||!1};return t.leagueId&&(o.leagueId=t.leagueId),await this.client.models.DriverPick.create(o,{authMode:"userPool"})}}async isDriverAlreadyPicked(t,n=null){if(!await U.getCurrentUser())return!1;const i=JSON.parse(localStorage.getItem("nextRaceData")),s=i==null?void 0:i.raceId;return(await this.getUserPicks(null,n)).filter(c=>c.raceId!==s).some(c=>c.driverId===t.toString())}async getCurrentRacePick(t=null){if(!await U.getCurrentUser())return null;const r=JSON.parse(localStorage.getItem("nextRaceData"));if(!(r!=null&&r.raceId))return null;const s=(await this.getUserPicks(null,t)).filter(o=>o.raceId===r.raceId);return s.length===0?null:s.length>1?(console.warn(`Found ${s.length} picks for race ${r.raceId}, cleaning up duplicates...`),(await this.cleanupDuplicatePicksForRace(r.raceId)).mostRecentPick):s[0]}async updateUserPick(t,n){if(!await U.getCurrentUser())throw new Error("Authentication required");return await this.client.models.DriverPick.update({id:t,...n,submittedAt:new Date().toISOString()},{authMode:"userPool"})}async deleteUserPick(t){if(!await U.getCurrentUser())throw new Error("Authentication required");return await this.client.models.DriverPick.delete({id:t},{authMode:"userPool"})}async createLeague(t){const n=await U.getCurrentUser();if(!n)throw new Error("Authentication required");const r=n.userId||n.username,i=await this.client.models.League.create({name:t.name,inviteCode:t.inviteCode,ownerId:r,maxMembers:t.maxMembers||50,season:this.currentSeason,autoPickEnabled:t.autoPickEnabled||!0,isPrivate:t.isPrivate||!0,status:"ACTIVE",createdAt:new Date().toISOString(),lastActiveAt:new Date().toISOString()},{authMode:"userPool"});return await this.client.models.LeagueMember.create({leagueId:i.data.leagueId,userId:r,joinedAt:new Date().toISOString(),status:"ACTIVE",isOwner:!0,survivedRaces:0,totalPicks:0,autoPickCount:0},{authMode:"userPool"}),i.data}async joinLeague(t){const n=await U.getCurrentUser();if(!n)throw new Error("Authentication required");const r=await this.client.models.League.list({filter:{inviteCode:{eq:t},status:{eq:"ACTIVE"}},authMode:"userPool"});if(!r.data||r.data.length===0)throw new Error("League not found with this invite code");const i=r.data[0],s=n.userId||n.username,o=await this.client.models.LeagueMember.list({filter:{leagueId:{eq:i.leagueId},userId:{eq:s}},authMode:"userPool"});if(o.data&&o.data.length>0)throw new Error("You are already a member of this league");return await this.client.models.LeagueMember.create({leagueId:i.leagueId,userId:s,joinedAt:new Date().toISOString(),status:"ACTIVE",isOwner:!1,survivedRaces:0,totalPicks:0,autoPickCount:0},{authMode:"userPool"}),i}async getLeague(t){if(!await U.getCurrentUser())throw new Error("Authentication required");return(await this.client.models.League.get({leagueId:t},{authMode:"userPool"})).data}async getLeagueMembers(t){if(!await U.getCurrentUser())throw new Error("Authentication required");return(await this.client.models.LeagueMember.list({filter:{leagueId:{eq:t}},authMode:"userPool"})).data||[]}async getUserLeagues(){const t=await U.getCurrentUser();if(!t)return[];const n=t.userId||t.username,r=await this.client.models.LeagueMember.list({filter:{userId:{eq:n},status:{eq:"ACTIVE"}},authMode:"userPool"});if(!r.data)return[];const i=[];for(const s of r.data){const o=await this.getLeague(s.leagueId);o&&i.push({...o,membershipData:s})}return i}transformPickForUI(t){return{driverId:parseInt(t.driverId),raceId:t.raceId,timestamp:t.submittedAt,driverName:t.driverName,teamName:t.teamName,isAutoPick:t.isAutoPick||!1,pickId:t.id}}transformPicksForUI(t){return t.map(n=>this.transformPickForUI(n))}async addTestPreviousRacePick(t,n,r,i,s){const o=await U.getCurrentUser();if(!o)throw new Error("Authentication required");const c={pickId:`pick_${o.userId||o.username}_${i}_${Date.now()}`,userId:o.userId||o.username,seasonId:this.currentSeason,raceId:i,driverId:t.toString(),driverName:n,teamName:r,raceName:s,submittedAt:new Date(Date.now()-7*24*60*60*1e3).toISOString(),pickDeadline:new Date(Date.now()-6*24*60*60*1e3).toISOString(),isAutoPick:!1};return await this.client.models.DriverPick.create(c,{authMode:"userPool"})}async deleteUserPick(t){return await this.client.models.DriverPick.delete({id:t},{authMode:"userPool"})}async cleanupDuplicatePicksForRace(t){if(!await U.getCurrentUser())throw new Error("Authentication required");const i=(await this.getUserPicks()).filter(a=>a.raceId===t);if(i.length<=1)return console.log(`No duplicate picks found for race ${t}`),{duplicatesRemoved:0};i.sort((a,c)=>new Date(c.submittedAt)-new Date(a.submittedAt));const s=i.slice(1);console.log(`Found ${i.length} picks for race ${t}, keeping most recent, deleting ${s.length} duplicates`);const o=s.map(a=>this.client.models.DriverPick.delete({id:a.id},{authMode:"userPool"}));return await Promise.all(o),console.log(`Successfully cleaned up ${s.length} duplicate picks for race ${t}`),{duplicatesRemoved:s.length,mostRecentPick:i[0]}}async cleanupAllDuplicatePicks(){if(!await U.getCurrentUser())throw new Error("Authentication required");console.log("🧹 Starting cleanup of all duplicate picks...");const n=await this.getUserPicks(),r={};n.forEach(o=>{r[o.raceId]||(r[o.raceId]=[]),r[o.raceId].push(o)});let i=0;const s=[];for(const[o,a]of Object.entries(r))if(a.length>1){const c=await this.cleanupDuplicatePicksForRace(o);s.push({raceId:o,...c}),i+=c.duplicatesRemoved}return console.log(`✅ Cleanup complete! Removed ${i} duplicate picks across ${s.length} races`),{totalDuplicatesRemoved:i,racesWithDuplicates:s.length,details:s}}}const ge=new rc,Py=Object.freeze(Object.defineProperty({__proto__:null,AmplifyDataService:rc,amplifyDataService:ge},Symbol.toStringTag,{value:"Module"}));function at(){const e=st.getActiveLeagueId();if(!e)return{isLeagueMode:!1,leagueId:null,league:null};const t=st.getLeague(e);return{isLeagueMode:!0,leagueId:e,league:t}}function ic(e){return st.setActiveLeagueId(e)}async function Ey(e,t){if(!await U.getCurrentUser())throw new Error("Authentication required to save picks");const r=at();if(r.isLeagueMode)return console.log(`Saving pick to league: ${r.league.leagueName}`),st.saveLeaguePick(r.leagueId,e,t);{console.log("Saving pick in solo mode via AWS backend");const i=JSON.parse(localStorage.getItem("nextRaceData"));if(!i||!i.raceId)throw new Error("No valid race data found. Cannot save pick.");const s={raceId:i.raceId,driverId:parseInt(e),driverName:(t==null?void 0:t.driverName)||null,teamName:(t==null?void 0:t.teamName)||null,raceName:i.raceName||"Unknown Race",isAutoPick:(t==null?void 0:t.isAutoPick)||!1};return ge.saveUserPick(s)}}async function vy(){if(!await U.getCurrentUser())return console.log("No authenticated user, returning empty picks"),[];const t=at();if(t.isLeagueMode)return console.log(`Loading picks from league: ${t.league.leagueName}`),st.loadLeaguePicks(t.leagueId);{console.log("Loading picks in solo mode via AWS backend");const n=await ge.getUserPicks();return ge.transformPicksForUI(n)}}async function Sy(e){if(!await U.getCurrentUser())return!1;const n=at();return n.isLeagueMode?st.isDriverAlreadyPickedInLeague(e,n.leagueId):ge.isDriverAlreadyPicked(e)}async function Iy(){if(!await U.getCurrentUser())return null;const t=at();return t.isLeagueMode?st.getCurrentRacePickForLeague(t.leagueId):ge.getCurrentRacePick()}function sc(){const e=at(),t=document.querySelector(".league-indicator");if(t&&t.remove(),e.isLeagueMode){const n=document.querySelector("#driver-selection-screen .modal-header");if(n){const i=document.createElement("div");i.className="league-indicator",i.innerHTML=`
        <span class="indicator-label">League:</span>
        <span class="indicator-value">${e.league.leagueName}</span>
      `,n.appendChild(i)}const r=document.querySelector(".hero-section");if(r){const i=document.createElement("div");i.className="league-indicator main-page",i.innerHTML=`
        <span>Playing in: <strong>${e.league.leagueName}</strong></span>
      `,r.appendChild(i)}}}function Ur(){sc();const e=at();e.isLeagueMode?console.log(`League mode active: ${e.league.leagueName}`):console.log("Solo mode active")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ur):Ur();const Ry=Object.freeze(Object.defineProperty({__proto__:null,displayLeagueIndicator:sc,getCurrentRacePickWithContext:Iy,getLeagueContext:at,initializeLeagueIntegration:Ur,isDriverAlreadyPickedWithContext:Sy,loadPicksWithContext:vy,savePickWithContext:Ey,setActiveLeagueId:ic},Symbol.toStringTag,{value:"Module"}));function wy(){try{return localStorage.getItem("activeLeagueId")}catch(e){return console.error("Error getting active league ID:",e),null}}class Ty{constructor(){this.currentSeason="2025"}async getCurrentUser(){const t=await U.getCurrentUser();if(!t)throw new Error("Authentication required for league operations");return t}async createLeague(t,n={}){if(!t||t.trim().length===0)throw new Error("League name cannot be empty");if(t.trim().length>50)throw new Error("League name cannot exceed 50 characters");await this.getCurrentUser();const r=this.generateInviteCode(),i={name:t.trim(),inviteCode:r,maxMembers:n.maxMembers||20,isPrivate:n.isPrivate!==!1,autoPickEnabled:n.autoPickEnabled!==!1};return await ge.createLeague(i)}async joinLeague(t){if(!t||t.trim().length===0)throw new Error("Invalid invite code");return await this.getCurrentUser(),await ge.joinLeague(t.trim())}async leaveLeague(t){const n=this.storageManager.getLeague(t);if(!n)throw new Error("League not found");const r=n.members.findIndex(i=>i.userId===this.currentUserId);if(r===-1)throw new Error("Not a member of this league");if(n.ownerId===this.currentUserId)throw new Error("League owner cannot leave. Delete the league instead.");if(n.members.splice(r,1),n.picks&&n.picks[this.currentUserId]&&delete n.picks[this.currentUserId],!this.storageManager.saveLeague(n))throw new Error("Failed to leave league");return this.storageManager.removeUserFromLeague(t),!0}async deleteLeague(t){const n=this.storageManager.getLeague(t);if(!n)throw new Error("League not found");if(n.ownerId!==this.currentUserId)throw new Error("Only the league owner can delete the league");n.members.forEach(i=>{i.userId,this.currentUserId});const r=this.storageManager.getAllLeagues();return delete r[t],localStorage.setItem("f1survivor_league_data",JSON.stringify(r)),this.storageManager.removeUserFromLeague(t),!0}async kickMember(t,n){const r=this.storageManager.getLeague(t);if(!r)throw new Error("League not found");if(r.ownerId!==this.currentUserId)throw new Error("Only the league owner can kick members");if(n===this.currentUserId)throw new Error("Cannot kick yourself from the league");const i=r.members.findIndex(s=>s.userId===n);if(i===-1)throw new Error("Member not found in league");if(r.members.splice(i,1),r.picks&&r.picks[n]&&delete r.picks[n],!this.storageManager.saveLeague(r))throw new Error("Failed to kick member");return!0}async updateLeagueSettings(t,n){const r=this.storageManager.getLeague(t);if(!r)throw new Error("League not found");if(r.ownerId!==this.currentUserId)throw new Error("Only the league owner can update settings");if(n.maxMembers&&n.maxMembers<r.members.length)throw new Error("Cannot set max members below current member count");if(r.settings={...r.settings,...n},!this.storageManager.saveLeague(r))throw new Error("Failed to update league settings");return r}getLeagueStandings(t){const n=this.storageManager.getLeague(t);if(!n)throw new Error("League not found");const r=n.members.map(i=>{const s=n.picks[i.userId]||[],o=s.length;return{userId:i.userId,username:i.username,survivedRaces:o,totalPicks:s.length,lastPick:s[s.length-1]||null,isEliminated:!1,isOwner:i.isOwner}});return r.sort((i,s)=>s.survivedRaces-i.survivedRaces),r}generateLeagueId(){return`league_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateInviteCode(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let r=0;r<8;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}async getActiveLeague(){const t=wy();if(!t)return null;try{return await ge.getLeague(t)}catch(n){return console.error("Error getting active league:",n),null}}setActiveLeague(t){ic(t)}async getUserLeagues(){try{return await ge.getUserLeagues()}catch(t){return console.error("Error getting user leagues:",t),[]}}async isLeagueOwner(t){try{const n=await this.getCurrentUser(),r=await ge.getLeague(t);return r&&r.ownerId===n.userId}catch(n){return console.error("Error checking league ownership:",n),!1}}async getLeague(t){try{return await ge.getLeague(t)}catch(n){return console.error("Error getting league:",n),null}}previewLeague(t){const n=this.storageManager.findLeagueByInviteCode(t.trim());return n?{leagueName:n.leagueName,memberCount:n.members.length,maxMembers:n.settings.maxMembers,season:n.season,createdAt:n.createdAt}:null}}const oc=new Ty;class by{constructor(){this.leagueManager=oc,this.activeModal=null}showCreateLeagueModal(){this.closeActiveModal(),document.body.insertAdjacentHTML("beforeend",`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content">
          <button class="close-btn">&times;</button>
          <h3>Create New League</h3>
          
          <form id="create-league-form">
            <div class="form-group">
              <label for="league-name">League Name</label>
              <input type="text" id="league-name" maxlength="50" required>
              <small>Choose a memorable name for your league</small>
            </div>
            
            <div class="form-group">
              <label for="max-members">Max Members</label>
              <select id="max-members">
                <option value="10">10 Players</option>
                <option value="15">15 Players</option>
                <option value="20" selected>20 Players</option>
                <option value="30">30 Players</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>
                <input type="checkbox" id="auto-pick-enabled" checked>
                Enable auto-pick for missed deadlines
              </label>
            </div>
            
            <div class="form-actions">
              <button type="button" id="cancel-create">Cancel</button>
              <button type="submit" id="create-league-btn">Create League</button>
            </div>
          </form>
        </div>
      </div>
    `),this.activeModal=document.getElementById("league-modal"),this.attachCreateLeagueEvents()}showJoinLeagueModal(){this.closeActiveModal(),document.body.insertAdjacentHTML("beforeend",`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content">
          <button class="close-btn">&times;</button>
          <h3>Join League</h3>
          
          <form id="join-league-form">
            <div class="form-group">
              <label for="invite-code">Invite Code</label>
              <input type="text" id="invite-code" placeholder="Enter 8-character code" maxlength="8" required>
              <small>Ask your league organizer for the invite code</small>
            </div>
            
            <div id="league-preview" class="league-preview" style="display: none;">
              <h4>League Preview</h4>
              <div class="preview-info">
                <p><strong>Name:</strong> <span id="preview-name"></span></p>
                <p><strong>Members:</strong> <span id="preview-members"></span></p>
                <p><strong>Season:</strong> <span id="preview-season"></span></p>
              </div>
            </div>
            
            <div id="join-error" class="error-message" style="display: none;"></div>
            
            <div class="form-actions">
              <button type="button" id="cancel-join">Cancel</button>
              <button type="submit" id="join-league-btn">Join League</button>
            </div>
          </form>
        </div>
      </div>
    `),this.activeModal=document.getElementById("league-modal"),this.attachJoinLeagueEvents()}showManageLeaguesModal(){this.closeActiveModal();const t=this.leagueManager.getUserLeagues(),n=`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content large">
          <button class="close-btn">&times;</button>
          <h3>Manage Leagues</h3>
          
          <div class="league-actions">
            <button id="create-league-action" class="action-btn create">
              <span class="icon">+</span>
              Create New League
            </button>
            <button id="join-league-action" class="action-btn join">
              <span class="icon">🔗</span>
              Join League
            </button>
          </div>
          
          <div class="user-leagues">
            <h4>Your Leagues</h4>
            <div class="leagues-list">
              ${t.length===0?`<p class="no-leagues">You haven't joined any leagues yet.</p>`:t.map(r=>`
                  <div class="league-item" data-league-id="${r.leagueId}">
                    <div class="league-info">
                      <h5>${this.escapeHtml(r.leagueName)}</h5>
                      <p>${r.members.length} members • ${r.isOwner?"Owner":"Member"}</p>
                      ${r.isOwner?`<p class="invite-code">Invite Code: <strong>${r.inviteCode}</strong></p>`:""}
                    </div>
                    <div class="league-actions-item">
                      <button class="select-league" data-league-id="${r.leagueId}">Select</button>
                      ${r.isOwner?`<button class="manage-league" data-league-id="${r.leagueId}">Settings</button>`:""}
                      <button class="leave-league" data-league-id="${r.leagueId}">${r.isOwner?"Delete":"Leave"}</button>
                    </div>
                  </div>
                `).join("")}
            </div>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",n),this.activeModal=document.getElementById("league-modal"),this.attachManageLeaguesEvents()}showLeagueSettingsModal(t){this.closeActiveModal();const n=this.leagueManager.getLeague(t);if(!n||n.ownerId!==this.leagueManager.currentUserId)return;const r=`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content">
          <button class="close-btn">&times;</button>
          <h3>League Settings: ${this.escapeHtml(n.leagueName)}</h3>
          
          <div class="league-info-section">
            <p><strong>Invite Code:</strong> <span class="invite-code-display">${n.inviteCode}</span></p>
            <button class="copy-invite-code" data-code="${n.inviteCode}">Copy Code</button>
          </div>
          
          <form id="league-settings-form">
            <div class="form-group">
              <label for="max-members-setting">Max Members</label>
              <select id="max-members-setting">
                <option value="10" ${n.settings.maxMembers===10?"selected":""}>10 Players</option>
                <option value="15" ${n.settings.maxMembers===15?"selected":""}>15 Players</option>
                <option value="20" ${n.settings.maxMembers===20?"selected":""}>20 Players</option>
                <option value="30" ${n.settings.maxMembers===30?"selected":""}>30 Players</option>
              </select>
              <small>Current members: ${n.members.length}</small>
            </div>
            
            <div class="form-group">
              <label>
                <input type="checkbox" id="auto-pick-enabled-setting" ${n.settings.autoPickEnabled?"checked":""}>
                Enable auto-pick for missed deadlines
              </label>
            </div>
            
            <div class="form-actions">
              <button type="button" id="cancel-settings">Cancel</button>
              <button type="submit" id="save-settings-btn">Save Settings</button>
            </div>
          </form>
          
          <div class="members-section">
            <h4>Members</h4>
            <div class="members-list">
              ${n.members.map(i=>`
                <div class="member-item">
                  <span class="member-name">${this.escapeHtml(i.username)} ${i.isOwner?"(Owner)":""}</span>
                  ${!i.isOwner&&i.userId!==this.leagueManager.currentUserId?`<button class="kick-member" data-user-id="${i.userId}">Remove</button>`:""}
                </div>
              `).join("")}
            </div>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),this.activeModal=document.getElementById("league-modal"),this.attachLeagueSettingsEvents(t)}attachCreateLeagueEvents(){const t=this.activeModal,n=t.querySelector("#create-league-form"),r=t.querySelector(".close-btn"),i=t.querySelector("#cancel-create");r.addEventListener("click",()=>this.closeActiveModal()),i.addEventListener("click",()=>this.closeActiveModal()),n.addEventListener("submit",async s=>{s.preventDefault();const o=document.getElementById("league-name").value,a=parseInt(document.getElementById("max-members").value),c=document.getElementById("auto-pick-enabled").checked;try{const u=await this.leagueManager.createLeague(o,{maxMembers:a,autoPickEnabled:c});this.showSuccessModal("League Created!",`Your league "${u.leagueName}" has been created successfully.<br>
          <strong>Invite Code: ${u.inviteCode}</strong><br>
          Share this code with friends to invite them to your league.`),this.leagueManager.setActiveLeague(u.leagueId),setTimeout(()=>{window.location.reload()},3e3)}catch(u){this.showError(u.message)}})}attachJoinLeagueEvents(){const t=this.activeModal,n=t.querySelector("#join-league-form"),r=t.querySelector(".close-btn"),i=t.querySelector("#cancel-join"),s=t.querySelector("#invite-code"),o=t.querySelector("#league-preview"),a=t.querySelector("#join-error");r.addEventListener("click",()=>this.closeActiveModal()),i.addEventListener("click",()=>this.closeActiveModal());let c;s.addEventListener("input",u=>{clearTimeout(c);const l=u.target.value.trim();l.length===8?c=setTimeout(()=>{const d=this.leagueManager.previewLeague(l);d?(t.querySelector("#preview-name").textContent=d.leagueName,t.querySelector("#preview-members").textContent=`${d.memberCount}/${d.maxMembers}`,t.querySelector("#preview-season").textContent=d.season,o.style.display="block",a.style.display="none"):o.style.display="none"},300):o.style.display="none"}),n.addEventListener("submit",async u=>{u.preventDefault();const l=s.value.trim();try{const d=await this.leagueManager.joinLeague(l);this.showSuccessModal("Joined League!",`You have successfully joined "${d.leagueName}".`),this.leagueManager.setActiveLeague(d.leagueId),setTimeout(()=>{window.location.reload()},2e3)}catch(d){a.textContent=d.message,a.style.display="block"}})}attachManageLeaguesEvents(){const t=this.activeModal,n=t.querySelector(".close-btn"),r=t.querySelector("#create-league-action"),i=t.querySelector("#join-league-action");n.addEventListener("click",()=>this.closeActiveModal()),r.addEventListener("click",()=>this.showCreateLeagueModal()),i.addEventListener("click",()=>this.showJoinLeagueModal()),t.querySelectorAll(".select-league").forEach(s=>{s.addEventListener("click",o=>{const a=o.target.dataset.leagueId;this.leagueManager.setActiveLeague(a),window.location.reload()})}),t.querySelectorAll(".manage-league").forEach(s=>{s.addEventListener("click",o=>{const a=o.target.dataset.leagueId;this.showLeagueSettingsModal(a)})}),t.querySelectorAll(".leave-league").forEach(s=>{s.addEventListener("click",async o=>{const a=o.target.dataset.leagueId,c=this.leagueManager.getLeague(a),u=this.leagueManager.isLeagueOwner(a),l=u?`Are you sure you want to delete "${c.leagueName}"? This action cannot be undone.`:`Are you sure you want to leave "${c.leagueName}"?`;if(confirm(l))try{u?await this.leagueManager.deleteLeague(a):await this.leagueManager.leaveLeague(a),window.location.reload()}catch(d){this.showError(d.message)}})})}attachLeagueSettingsEvents(t){const n=this.activeModal,r=n.querySelector("#league-settings-form"),i=n.querySelector(".close-btn"),s=n.querySelector("#cancel-settings"),o=n.querySelector(".copy-invite-code");i.addEventListener("click",()=>this.closeActiveModal()),s.addEventListener("click",()=>this.closeActiveModal()),o.addEventListener("click",a=>{const c=a.target.dataset.code;navigator.clipboard.writeText(c).then(()=>{a.target.textContent="Copied!",setTimeout(()=>{a.target.textContent="Copy Code"},2e3)})}),r.addEventListener("submit",async a=>{a.preventDefault();const c=parseInt(document.getElementById("max-members-setting").value),u=document.getElementById("auto-pick-enabled-setting").checked;try{await this.leagueManager.updateLeagueSettings(t,{maxMembers:c,autoPickEnabled:u}),this.showSuccessModal("Settings Updated","League settings have been updated successfully."),setTimeout(()=>{this.showManageLeaguesModal()},1500)}catch(l){this.showError(l.message)}}),n.querySelectorAll(".kick-member").forEach(a=>{a.addEventListener("click",async c=>{const u=c.target.dataset.userId,d=this.leagueManager.getLeague(t).members.find(h=>h.userId===u);if(confirm(`Are you sure you want to remove ${d.username} from the league?`))try{await this.leagueManager.kickMember(t,u),this.showLeagueSettingsModal(t)}catch(h){this.showError(h.message)}})})}showSuccessModal(t,n){this.closeActiveModal();const r=`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content small success">
          <h3>${t}</h3>
          <p>${n}</p>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),this.activeModal=document.getElementById("league-modal"),setTimeout(()=>{this.closeActiveModal()},3e3)}showError(t){const n=document.createElement("div");n.className="error-toast",n.textContent=t,document.body.appendChild(n),setTimeout(()=>{n.remove()},3e3)}closeActiveModal(){this.activeModal&&(this.activeModal.remove(),this.activeModal=null)}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}const Ay=new by;class Ny{constructor(){this.leagueManager=oc,this.modalManager=Ay,this.currentLeague=null}async initialize(){if(!await U.isAuthenticated()){console.log("User not authenticated, skipping league dashboard initialization");return}this.currentLeague=await this.leagueManager.getActiveLeague(),await this.renderLeagueSelector(),this.currentLeague&&await this.updateDashboardForLeague()}async renderLeagueSelector(){const t=document.querySelector(".dashboard-container");if(!t)return;const n=document.querySelector(".league-selector-wrapper");n&&n.remove();const r=await this.leagueManager.getUserLeagues(),i=localStorage.getItem("activeLeagueId"),s=`
      <div class="league-selector-wrapper">
        <div class="league-selector">
          <label>Current Mode:</label>
          <select id="league-selector">
            <option value="" ${i?"":"selected"}>Solo Play</option>
            ${r.map(o=>`
              <option value="${o.leagueId}" ${o.leagueId===i?"selected":""}>
                ${this.escapeHtml(o.name)}
              </option>
            `).join("")}
          </select>
          <button id="manage-leagues-btn" class="manage-leagues-btn">
            <span class="icon">⚙️</span>
            Manage Leagues
          </button>
        </div>
      </div>
    `;t.insertAdjacentHTML("afterbegin",s),this.attachSelectorEvents()}attachSelectorEvents(){const t=document.getElementById("league-selector"),n=document.getElementById("manage-leagues-btn");t&&t.addEventListener("change",r=>{const i=r.target.value;i?this.leagueManager.setActiveLeague(i):this.leagueManager.setActiveLeague(null),window.location.reload()}),n&&n.addEventListener("click",()=>{this.modalManager.showManageLeaguesModal()})}updateDashboardForLeague(){const t=document.querySelector(".dashboard-container h1");t&&this.currentLeague&&(t.innerHTML=`Dashboard - <span class="league-name">${this.escapeHtml(this.currentLeague.leagueName)}</span>`),this.updateEliminationZoneForLeague(),this.updateStatsForLeague()}updateEliminationZoneForLeague(){if(!this.currentLeague)return;const t=this.leagueManager.getLeagueStandings(this.currentLeague.leagueId),n=document.querySelector(".elimination-zone");if(n){const r=n.querySelector(".players-container");r&&(r.innerHTML=t.map((s,o)=>`
          <div class="player-card ${s.userId===this.leagueManager.currentUserId?"current-user":""} ${s.isEliminated?"eliminated":""}">
            <div class="player-rank">${o+1}</div>
            <div class="player-info">
              <h3>${this.escapeHtml(s.username)} ${s.isOwner?'<span class="owner-badge">Owner</span>':""}</h3>
              <p>${s.survivedRaces} races survived</p>
              ${s.lastPick?`<p class="last-pick">Last pick: ${s.lastPick.driverName}</p>`:""}
            </div>
            ${s.isEliminated?'<div class="status eliminated">ELIMINATED</div>':'<div class="status active">ACTIVE</div>'}
          </div>
        `).join(""));const i=n.querySelector("h2");i&&(i.textContent=`League Standings - ${this.currentLeague.leagueName}`)}}updateStatsForLeague(){if(!this.currentLeague)return;const t=this.storageManager.loadLeaguePicks(this.currentLeague.leagueId),n=document.querySelector('[data-stat="races-survived"]');n&&(n.textContent=t.length);const r=this.leagueManager.getLeagueStandings(this.currentLeague.leagueId),i=r.findIndex(o=>o.userId===this.leagueManager.currentUserId)+1,s=document.querySelector('[data-stat="league-position"]');if(s)s.textContent=`${i}/${r.length}`;else{const o=document.querySelector(".stats-grid");if(o){const a=document.createElement("div");a.className="stat-card",a.innerHTML=`
          <h3>League Position</h3>
          <p class="stat-value" data-stat="league-position">${i}/${r.length}</p>
        `,o.appendChild(a)}}}getPickContext(){const t=this.storageManager.getActiveLeagueId();return{isLeagueMode:!!t,leagueId:t,league:t?this.leagueManager.getLeague(t):null}}async savePickWithContext(t,n){const r=this.getPickContext();if(r.isLeagueMode)return await this.storageManager.saveLeaguePick(r.leagueId,t,n);{const{saveUserPicks:i}=await po(async()=>{const{saveUserPicks:s}=await Promise.resolve().then(()=>gy);return{saveUserPicks:s}},void 0,import.meta.url);return i(t,n)}}loadPicksWithContext(){const t=this.getPickContext();if(t.isLeagueMode)return this.storageManager.loadLeaguePicks(t.leagueId);{const{loadUserPicks:n}=window;return n()}}isDriverAlreadyPickedInContext(t){const n=this.getPickContext();if(n.isLeagueMode)return this.storageManager.isDriverAlreadyPickedInLeague(t,n.leagueId);{const{isDriverAlreadyPicked:r}=window;return r(t)}}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}const ho=new Ny;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{ho.initialize()}):ho.initialize();export{fo as F,po as _,U as a,py as b,Iy as c,Sy as d,mi as e,xy as f,uc as g,Py as h,Ur as i,Ry as j,vy as l,Cy as r,Ey as s};
