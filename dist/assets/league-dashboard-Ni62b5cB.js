(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const co=[{id:"aus-2025",location:"Melbourne",raceName:"Australian GP",country:"Australia",circuit:"Melbourne",date:"2025-03-16",timeLocal:"15:00",timeGMT:"04:00",dateStart:"2025-03-16T04:00:00+00:00",round:1},{id:"chn-2025",location:"Shanghai",raceName:"Chinese GP",country:"China",circuit:"Shanghai",date:"2025-03-23",timeLocal:"15:00",timeGMT:"07:00",dateStart:"2025-03-23T07:00:00+00:00",round:2},{id:"jpn-2025",location:"Suzuka",raceName:"Japanese GP",country:"Japan",circuit:"Suzuka",date:"2025-04-06",timeLocal:"14:00",timeGMT:"05:00",dateStart:"2025-04-06T05:00:00+00:00",round:3},{id:"bhr-2025",location:"Sakhir",raceName:"Bahrain GP",country:"Bahrain",circuit:"Sakhir",date:"2025-04-13",timeLocal:"18:00",timeGMT:"15:00",dateStart:"2025-04-13T15:00:00+00:00",round:4},{id:"sau-2025",location:"Jeddah",raceName:"Saudi Arabian GP",country:"Saudi Arabia",circuit:"Jeddah",date:"2025-04-20",timeLocal:"20:00",timeGMT:"17:00",dateStart:"2025-04-20T17:00:00+00:00",round:5},{id:"mia-2025",location:"Miami",raceName:"Miami GP",country:"United States",circuit:"Miami",date:"2025-05-04",timeLocal:"16:00",timeGMT:"20:00",dateStart:"2025-05-04T20:00:00+00:00",round:6},{id:"emi-2025",location:"Imola",raceName:"Emilia-Romagna GP",country:"Italy",circuit:"Imola",date:"2025-05-18",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-05-18T13:00:00+00:00",round:7},{id:"mon-2025",location:"Monaco",raceName:"Monaco GP",country:"Monaco",circuit:"Monaco",date:"2025-05-25",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-05-25T13:00:00+00:00",round:8},{id:"esp-2025",location:"Barcelona",raceName:"Spanish GP",country:"Spain",circuit:"Barcelona",date:"2025-06-01",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-06-01T13:00:00+00:00",round:9},{id:"can-2025",location:"Montreal",raceName:"Canadian GP",country:"Canada",circuit:"Montreal",date:"2025-06-15",timeLocal:"14:00",timeGMT:"18:00",dateStart:"2025-06-15T18:00:00+00:00",round:10},{id:"aut-2025",location:"Spielberg",raceName:"Austrian GP",country:"Austria",circuit:"Red Bull Ring",date:"2025-06-29",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-06-29T13:00:00+00:00",round:11},{id:"gbr-2025",location:"Silverstone",raceName:"British GP",country:"Great Britain",circuit:"Silverstone",date:"2025-07-06",timeLocal:"15:00",timeGMT:"14:00",dateStart:"2025-07-06T14:00:00+00:00",round:12},{id:"bel-2025",location:"Spa",raceName:"Belgian GP",country:"Belgium",circuit:"Spa-Francorchamps",date:"2025-07-27",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-07-27T13:00:00+00:00",round:13},{id:"hun-2025",location:"Budapest",raceName:"Hungarian GP",country:"Hungary",circuit:"Hungaroring",date:"2025-08-03",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-08-03T13:00:00+00:00",round:14},{id:"ned-2025",location:"Zandvoort",raceName:"Dutch GP",country:"Netherlands",circuit:"Zandvoort",date:"2025-08-31",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-08-31T13:00:00+00:00",round:15},{id:"ita-2025",location:"Monza",raceName:"Italian GP",country:"Italy",circuit:"Monza",date:"2025-09-07",timeLocal:"15:00",timeGMT:"13:00",dateStart:"2025-09-07T13:00:00+00:00",round:16},{id:"aze-2025",location:"Baku",raceName:"Azerbaijan GP",country:"Azerbaijan",circuit:"Baku",date:"2025-09-21",timeLocal:"15:00",timeGMT:"11:00",dateStart:"2025-09-21T11:00:00+00:00",round:17},{id:"sgp-2025",location:"Singapore",raceName:"Singapore GP",country:"Singapore",circuit:"Marina Bay",date:"2025-10-05",timeLocal:"20:00",timeGMT:"12:00",dateStart:"2025-10-05T12:00:00+00:00",round:18},{id:"usa-2025",location:"Austin",raceName:"United States GP",country:"United States",circuit:"COTA",date:"2025-10-19",timeLocal:"14:00",timeGMT:"19:00",dateStart:"2025-10-19T19:00:00+00:00",round:19},{id:"mex-2025",location:"Mexico City",raceName:"Mexico City GP",country:"Mexico",circuit:"Mexico City",date:"2025-10-26",timeLocal:"14:00",timeGMT:"20:00",dateStart:"2025-10-26T20:00:00+00:00",round:20},{id:"bra-2025",location:"São Paulo",raceName:"São Paulo GP",country:"Brazil",circuit:"Interlagos",date:"2025-11-09",timeLocal:"14:00",timeGMT:"17:00",dateStart:"2025-11-09T17:00:00+00:00",round:21},{id:"lv-2025",location:"Las Vegas",raceName:"Las Vegas GP",country:"United States",circuit:"Las Vegas",date:"2025-11-22",timeLocal:"20:00",timeGMT:"04:00",dateStart:"2025-11-23T04:00:00+00:00",round:22},{id:"qat-2025",location:"Lusail",raceName:"Qatar GP",country:"Qatar",circuit:"Lusail",date:"2025-11-30",timeLocal:"19:00",timeGMT:"16:00",dateStart:"2025-11-30T16:00:00+00:00",round:23},{id:"uae-2025",location:"Abu Dhabi",raceName:"Abu Dhabi GP",country:"United Arab Emirates",circuit:"Yas Marina",date:"2025-12-07",timeLocal:"17:00",timeGMT:"13:00",dateStart:"2025-12-07T13:00:00+00:00",round:24}];function tc(e=new Date){const t=co.filter(n=>new Date(n.dateStart)>e);return t.length===0?null:t.sort((n,r)=>new Date(n.dateStart)-new Date(r.dateStart))[0]}const by=Object.freeze(Object.defineProperty({__proto__:null,F1_2025_CALENDAR:co,getNextRace:tc},Symbol.toStringTag,{value:"Module"})),nc="Logging",rc="x-amz-user-agent",ic="NoHubcallbackProvidedException";var ae;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(ae||(ae={}));const Ii={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class Q{constructor(t,n=ae.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...n){let r=this.level;Q.LOG_LEVEL&&(r=Q.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(r=window.LOG_LEVEL);const i=Ii[r];if(!(Ii[t]>=i))return;let o=console.log.bind(console);t===ae.ERROR&&console.error&&(o=console.error.bind(console)),t===ae.WARN&&console.warn&&(o=console.warn.bind(console)),Q.BIND_ALL_LOG_LEVELS&&(t===ae.INFO&&console.info&&(o=console.info.bind(console)),t===ae.DEBUG&&console.debug&&(o=console.debug.bind(console)));const a=`[${t}] ${this._ts()} ${this.name}`;let c="";if(n.length===1&&typeof n[0]=="string")c=`${a} - ${n[0]}`,o(c);else if(n.length===1)c=`${a} ${n[0]}`,o(a,n[0]);else if(typeof n[0]=="string"){let u=n.slice(1);u.length===1&&(u=u[0]),c=`${a} - ${n[0]} ${u}`,o(`${a} - ${n[0]}`,u)}else c=`${a} ${n}`,o(a,n);for(const u of this._pluggables){const l={message:c,timestamp:Date.now()};u.pushLogs([l])}}log(...t){this._log(ae.INFO,...t)}info(...t){this._log(ae.INFO,...t)}warn(...t){this._log(ae.WARN,...t)}error(...t){this._log(ae.ERROR,...t)}debug(...t){this._log(ae.DEBUG,...t)}verbose(...t){this._log(ae.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===nc&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}Q.LOG_LEVEL=null;Q.BIND_ALL_LOG_LEVELS=!1;class ne extends Error{constructor({message:t,name:n,recoverySuggestion:r,underlyingError:i,metadata:s}){if(super(t),this.name=n,this.underlyingError=i,this.recoverySuggestion=r,s){const{extendedRequestId:o,httpStatusCode:a,requestId:c}=s;this.metadata={extendedRequestId:o,httpStatusCode:a,requestId:c}}this.constructor=ne,Object.setPrototypeOf(this,ne.prototype)}}var Ge;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(Ge||(Ge={}));const Lr=(e,t=ne)=>(n,r,i)=>{const{message:s,recoverySuggestion:o}=e[r];if(!n)throw new t({name:r,message:i?`${s} ${i}`:s,recoverySuggestion:o})},ze=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",Pt=new Q("Hub");class uo{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,n){const r=this.listeners.get(t);if(!r){Pt.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...r.filter(({callback:i})=>i!==n)])}dispatch(t,n,r,i){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(i===ze||Pt.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const s={channel:t,payload:{...n},source:r,patternInfo:[]};try{this._toListeners(s)}catch(o){Pt.error(o)}}listen(t,n,r="noname"){let i;if(typeof n!="function")throw new ne({name:ic,message:"No callback supplied to Hub"});i=n;let s=this.listeners.get(t);return s||(s=[],this.listeners.set(t,s)),s.push({name:r,callback:i}),()=>{this._remove(t,i)}}_toListeners(t){const{channel:n,payload:r}=t,i=this.listeners.get(n);i&&i.forEach(s=>{Pt.debug(`Dispatching to ${n} with `,r);try{s.callback(t)}catch(o){Pt.error(o)}})}}const Ye=new uo("__default__"),_n=new uo("internal-hub"),sc=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new ne({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},oc=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new ne({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},ac=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new ne({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},Mr={convert(e,t){let n=e;return t!=null&&t.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),ac()(n)}};var Te;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(Te||(Te={}));const cc={[Te.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Te.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Te.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Te.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Te.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},Ur=Lr(cc);function M(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,Ur(t,Te.AuthUserPoolException)}function lo(e){var n,r,i,s,o,a,c,u;const t=!!((r=(n=e==null?void 0:e.loginWith)==null?void 0:n.oauth)!=null&&r.domain)&&!!((s=(i=e==null?void 0:e.loginWith)==null?void 0:i.oauth)!=null&&s.redirectSignOut)&&!!((a=(o=e==null?void 0:e.loginWith)==null?void 0:o.oauth)!=null&&a.redirectSignIn)&&!!((u=(c=e==null?void 0:e.loginWith)==null?void 0:c.oauth)!=null&&u.responseType);Ur(t,Te.OAuthNotConfigureException)}function yn(e){const t=!!(e!=null&&e.identityPoolId);Ur(t,Te.InvalidIdentityPoolIdException)}function tt(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const r=t[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(Mr.convert(r).split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),s=JSON.parse(i);return{toString:()=>e,payload:s}}catch{throw new Error("Invalid token payload")}}const fo=e=>e&&e["nonRetryable"],cn=new Q("retryUtil");async function uc(e,t,n,r){if(typeof e!="function")throw Error("functionToRetry must be a function");return new Promise(async(i,s)=>{let o=0,a=!1,c=()=>{},u;for(;;){o++,cn.debug(`${e.name} attempt #${o} with this vars: ${JSON.stringify(t)}`);try{i(await e(...t));return}catch(l){if(u=l,cn.debug(`error on ${e.name}`,l),fo(l)){cn.debug(`${e.name} non retryable error`,l),s(l);return}const d=n(o,t,l);if(cn.debug(`${e.name} retrying in ${d} ms`),d===!1||a){s(l);return}else await new Promise(f=>{c=f,setTimeout(c,d)})}}s(u)})}const po=e=>{const t=Reflect.ownKeys(e);for(const n of t){const r=e[n];(r&&typeof r=="object"||typeof r=="function")&&po(r)}return Object.freeze(e)},lc=new Q("parseAWSExports"),dc={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},fc=(e={})=>{var pi,hi,mi,gi,yi,Ei;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new ne({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:r,aws_appsync_region:i,aws_bots_config:s,aws_cognito_identity_pool_id:o,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:u,aws_cognito_password_protection_settings:l,aws_cognito_verification_mechanisms:d,aws_cognito_signup_attributes:f,aws_cognito_social_providers:p,aws_cognito_username_attributes:h,aws_mandatory_sign_in:m,aws_mobile_analytics_app_id:g,aws_mobile_analytics_app_region:E,aws_user_files_s3_bucket:S,aws_user_files_s3_bucket_region:A,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:I,aws_user_pools_id:v,aws_user_pools_web_client_id:T,geo:P,oauth:k,predictions:D,aws_cloud_logic_custom:q,Notifications:V,modelIntrospection:O}=e,C={};g&&(C.Analytics={Pinpoint:{appId:g,region:E}});const{InAppMessaging:U,Push:Y}=V??{};if(U!=null&&U.AWSPinpoint||Y!=null&&Y.AWSPinpoint){if(U!=null&&U.AWSPinpoint){const{appId:H,region:Xe}=U.AWSPinpoint;C.Notifications={InAppMessaging:{Pinpoint:{appId:H,region:Xe}}}}if(Y!=null&&Y.AWSPinpoint){const{appId:H,region:Xe}=Y.AWSPinpoint;C.Notifications={...C.Notifications,PushNotification:{Pinpoint:{appId:H,region:Xe}}}}}if(Array.isArray(s)&&(C.Interactions={LexV1:Object.fromEntries(s.map(H=>[H.name,H]))}),r){const H=dc[n];H||lc.debug(`Invalid authentication type ${n}. Falling back to IAM.`),C.API={GraphQL:{endpoint:r,apiKey:t,region:i,defaultAuthMode:H??"iam"}},O&&(C.API.GraphQL.modelIntrospection=O)}const le=c?{status:c&&c.toLowerCase(),totpEnabled:(u==null?void 0:u.includes("TOTP"))??!1,smsEnabled:(u==null?void 0:u.includes("SMS"))??!1}:void 0,_=l?{minLength:l.passwordPolicyMinLength,requireLowercase:((pi=l.passwordPolicyCharacters)==null?void 0:pi.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((hi=l.passwordPolicyCharacters)==null?void 0:hi.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((mi=l.passwordPolicyCharacters)==null?void 0:mi.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((gi=l.passwordPolicyCharacters)==null?void 0:gi.includes("REQUIRES_SYMBOLS"))??!1}:void 0,L=Array.from(new Set([...d??[],...f??[]])).reduce((H,Xe)=>({...H,[Xe.toLowerCase()]:{required:!0}}),{}),F=(h==null?void 0:h.includes("EMAIL"))??!1,$e=(h==null?void 0:h.includes("PHONE_NUMBER"))??!1;(o||v)&&(C.Auth={Cognito:{identityPoolId:o,allowGuestAccess:m!=="enable",signUpVerificationMethod:a,userAttributes:L,userPoolClientId:T,userPoolId:v,mfa:le,passwordFormat:_,loginWith:{username:!(F||$e),email:F,phone:$e}}});const _t=k?Object.keys(k).length>0:!1,nr=p?p.length>0:!1;if(C.Auth&&_t&&(C.Auth.Cognito.loginWith={...C.Auth.Cognito.loginWith,oauth:{...pc(k),...nr&&{providers:hc(p)}}}),S&&(C.Storage={S3:{bucket:S,region:A,dangerouslyConnectToHttpEndpointForTesting:I}}),P){const{amazon_location_service:H}=P;C.Geo={LocationService:{maps:H.maps,geofenceCollections:H.geofenceCollections,searchIndices:H.search_indices,region:H.region}}}if(q&&(C.API={...C.API,REST:q.reduce((H,Xe)=>{const{name:Za,endpoint:ec,region:vi,service:Si}=Xe;return{...H,[Za]:{endpoint:ec,...Si?{service:Si}:void 0,...vi?{region:vi}:void 0}}},{})}),D){const{VoiceId:H}=((Ei=(yi=D==null?void 0:D.convert)==null?void 0:yi.speechGenerator)==null?void 0:Ei.defaults)??{};C.Predictions=H?{...D,convert:{...D.convert,speechGenerator:{...D.convert.speechGenerator,defaults:{voiceId:H}}}}:D}return C},Ai=e=>(e==null?void 0:e.split(","))??[],pc=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:r,responseType:i})=>({domain:e,scopes:t,redirectSignIn:Ai(n),redirectSignOut:Ai(r),responseType:i}),hc=e=>e.map(t=>{const n=t.toLowerCase();return n.charAt(0).toUpperCase()+n.slice(1)}),mc=Symbol("oauth-listener");let un;const gc=new Uint8Array(16);function yc(){if(!un&&(un=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!un))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return un(gc)}const ee=[];for(let e=0;e<256;++e)ee.push((e+256).toString(16).slice(1));function Ec(e,t=0){return ee[e[t+0]]+ee[e[t+1]]+ee[e[t+2]]+ee[e[t+3]]+"-"+ee[e[t+4]]+ee[e[t+5]]+"-"+ee[e[t+6]]+ee[e[t+7]]+"-"+ee[e[t+8]]+ee[e[t+9]]+"-"+ee[e[t+10]]+ee[e[t+11]]+ee[e[t+12]]+ee[e[t+13]]+ee[e[t+14]]+ee[e[t+15]]}const vc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wi={randomUUID:vc};function Sc(e,t,n){if(wi.randomUUID&&!t&&!e)return wi.randomUUID();e=e||{};const r=e.random||(e.rng||yc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return Ec(r)}function Ic(e){const{version:t}=e;return t?t.startsWith("1"):!1}function Ac(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:r}=e;return{S3:{bucket:t,region:n,buckets:r&&kc(r)}}}function wc(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:r,password_policy:i,mfa_configuration:s,mfa_methods:o,unauthenticated_identities_enabled:a,oauth:c,username_attributes:u,standard_required_attributes:l,groups:d}=e,f={Cognito:{userPoolId:t,userPoolClientId:n,groups:d}};return r&&(f.Cognito={...f.Cognito,identityPoolId:r}),i&&(f.Cognito.passwordFormat={requireLowercase:i.require_lowercase,requireNumbers:i.require_numbers,requireUppercase:i.require_uppercase,requireSpecialCharacters:i.require_symbols,minLength:i.min_length??6}),s&&(f.Cognito.mfa={status:Oc(s),smsEnabled:o==null?void 0:o.includes("SMS"),totpEnabled:o==null?void 0:o.includes("TOTP")}),a&&(f.Cognito.allowGuestAccess=a),c&&(f.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:Pc(c.identity_providers)}}),u&&(f.Cognito.loginWith={...f.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),l&&(f.Cognito.userAttributes=l.reduce((p,h)=>({...p,[h]:{required:!0}}),{})),f}function bc(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function Tc(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:r,search_indices:i}=e;return{LocationService:{region:t,searchIndices:i,geofenceCollections:n,maps:r}}}function Nc(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:r,api_key:i,model_introspection:s}=e;return{GraphQL:{endpoint:r,defaultAuthMode:ho(n),region:t,apiKey:i,modelIntrospection:s}}}function Rc(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:n,api_key:r,default_authorization_type:i}=e.events;return{Events:{endpoint:t,defaultAuthMode:ho(i),region:n,apiKey:r}}}function Cc(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:r}=e,i=n.includes("IN_APP_MESSAGING"),s=n.includes("APNS")||n.includes("FCM");if(!(i||s))return;const o={};return i&&(o.InAppMessaging={Pinpoint:{appId:r,region:t}}),s&&(o.PushNotification={Pinpoint:{appId:r,region:t}}),o}function xc(e){const t={};if(e.storage&&(t.Storage=Ac(e.storage)),e.auth&&(t.Auth=wc(e.auth)),e.analytics&&(t.Analytics=bc(e.analytics)),e.geo&&(t.Geo=Tc(e.geo)),e.data&&(t.API=Nc(e.data)),e.custom){const n=Rc(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=Cc(e.notifications)),t}const _c={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function ho(e){return _c[e]}const bi={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function Pc(e=[]){return e.reduce((t,n)=>(bi[n]!==void 0&&t.push(bi[n]),t),[])}function Oc(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function kc(e){const t={};return e.forEach(({name:n,bucket_name:r,aws_region:i,paths:s})=>{if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);const o=s?Object.entries(s).reduce((a,[c,u])=>(u!==void 0&&(a[c]=u),a),{}):void 0;t[n]={bucketName:r,region:i,paths:o}}),t}const mo=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?fc(e):Ic(e)?xc(e):e;var fr=function(e,t){return fr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},fr(e,t)};function Fr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");fr(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function go(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(l){try{u(r.next(l))}catch(d){o(d)}}function c(l){try{u(r.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((r=r.apply(e,t||[])).next())})}function qr(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Vt(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function hr(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function ct(e){return this instanceof ct?(this.v=e,this):new ct(e)}function Dc(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(p){return function(h){return Promise.resolve(h).then(p,d)}}function a(p,h){r[p]&&(i[p]=function(m){return new Promise(function(g,E){s.push([p,m,g,E])>1||c(p,m)})},h&&(i[p]=h(i[p])))}function c(p,h){try{u(r[p](h))}catch(m){f(s[0][3],m)}}function u(p){p.value instanceof ct?Promise.resolve(p.value.v).then(l,d):f(s[0][2],p)}function l(p){c("next",p)}function d(p){c("throw",p)}function f(p,h){p(h),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Lc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Vt=="function"?Vt(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}var de=64,Mc=32,Uc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Fc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],qc=Math.pow(2,53)-1,En=function(){function e(){this.state=Int32Array.from(Fc),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>qc)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[n++],r--,this.bufferLength===de&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%de>=de-8){for(var i=this.bufferLength;i<de;i++)n.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(var i=this.bufferLength;i<de-8;i++)n.setUint8(i,0);n.setUint32(de-8,Math.floor(t/4294967296),!0),n.setUint32(de-4,t),this.hashBuffer(),this.finished=!0}for(var s=new Uint8Array(Mc),i=0;i<8;i++)s[i*4]=this.state[i]>>>24&255,s[i*4+1]=this.state[i]>>>16&255,s[i*4+2]=this.state[i]>>>8&255,s[i*4+3]=this.state[i]>>>0&255;return s},e.prototype.hashBuffer=function(){for(var t=this,n=t.buffer,r=t.state,i=r[0],s=r[1],o=r[2],a=r[3],c=r[4],u=r[5],l=r[6],d=r[7],f=0;f<de;f++){if(f<16)this.temp[f]=(n[f*4]&255)<<24|(n[f*4+1]&255)<<16|(n[f*4+2]&255)<<8|n[f*4+3]&255;else{var p=this.temp[f-2],h=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10;p=this.temp[f-15];var m=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3;this.temp[f]=(h+this.temp[f-7]|0)+(m+this.temp[f-16]|0)}var g=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&l)|0)+(d+(Uc[f]+this.temp[f]|0)|0)|0,E=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&s^i&o^s&o)|0;d=l,l=u,u=c,c=a+g|0,a=o,o=s,s=i,i=g+E|0}r[0]+=i,r[1]+=s,r[2]+=o,r[3]+=a,r[4]+=c,r[5]+=u,r[6]+=l,r[7]+=d},e}();const Kc=e=>new TextEncoder().encode(e);var Bc=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:Kc;function yo(e){return e instanceof Uint8Array?e:typeof e=="string"?Bc(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function $c(e){return typeof e=="string"?e.length===0:e.byteLength===0}var Wt=function(){function e(t){this.secret=t,this.hash=new En,this.reset()}return e.prototype.update=function(t){if(!($c(t)||this.error))try{this.hash.update(yo(t))}catch(n){this.error=n}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return go(this,void 0,void 0,function(){return qr(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new En,this.secret){this.outer=new En;var t=Vc(this.secret),n=new Uint8Array(de);n.set(t);for(var r=0;r<de;r++)t[r]^=54,n[r]^=92;this.hash.update(t),this.outer.update(n);for(var r=0;r<t.byteLength;r++)t[r]=0}},e}();function Vc(e){var t=yo(e);if(t.byteLength>de){var n=new En;n.update(t),t=n.digest()}var r=new Uint8Array(de);return r.set(t),r}const Eo={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Eo[e]=t}function Wc(e){let t="";for(let n=0;n<e.byteLength;n++)t+=Eo[e[n]];return t}var G;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(G||(G={}));var Pn;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(Pn||(Pn={}));var Ti;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(Ti||(Ti={}));var Ni;(function(e){e.Record="1",e.IdentifyUser="2"})(Ni||(Ni={}));var mr;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(mr||(mr={}));var se;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(se||(se={}));var Ri;(function(e){e.Subscribe="1",e.GraphQl="2"})(Ri||(Ri={}));var Ci;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(Ci||(Ci={}));var xi;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(xi||(xi={}));var _i;(function(e){e.None="0"})(_i||(_i={}));var Pi;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(Pi||(Pi={}));var Oi;(function(e){e.Subscribe="1"})(Oi||(Oi={}));var ki;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(ki||(ki={}));var Di;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(Di||(Di={}));const Hc="6.15.0",Kn=()=>typeof global<"u",yt=()=>typeof window<"u",vo=()=>typeof document<"u",Kr=()=>typeof process<"u",Ht=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));var Li={};function jc(){const e=r=>r.startsWith("_react")||r.startsWith("__react"),t=r=>Object.keys(r).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return vo()&&n().some(t)}function Gc(){return Kr()&&typeof Li<"u"&&!!Object.keys(Li).find(e=>e.includes("react"))}function zc(){return yt()&&Ht(window,"__VUE")}function Yc(){return Kn()&&Ht(global,"__VUE")}var Mi={};function Jc(){return yt()&&Ht(window,"__SVELTE")}function Qc(){return Kr()&&typeof Mi<"u"&&!!Object.keys(Mi).find(e=>e.includes("svelte"))}function Xc(){return yt()&&window.next&&typeof window.next=="object"}function Zc(){return Kn()&&(Ht(global,"__next")||Ht(global,"__NEXT"))}function eu(){return yt()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function tu(){return Kn()&&typeof global.__NUXT_PATHS__<"u"}var Ui={};function nu(){const e=!!(vo()&&document.querySelector("[ng-version]")),t=!!(yt()&&typeof window.ng<"u");return e||t}function ru(){var e;return Kr()&&typeof Ui=="object"&&((e=Ui.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function iu(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function su(){return Kn()&&typeof global.expo<"u"}function ou(){return yt()}const au=[{platform:G.Expo,detectionMethod:su},{platform:G.ReactNative,detectionMethod:iu},{platform:G.NextJs,detectionMethod:Xc},{platform:G.Nuxt,detectionMethod:eu},{platform:G.Angular,detectionMethod:nu},{platform:G.React,detectionMethod:jc},{platform:G.VueJs,detectionMethod:zc},{platform:G.Svelte,detectionMethod:Jc},{platform:G.WebUnknown,detectionMethod:ou},{platform:G.NextJsSSR,detectionMethod:Zc},{platform:G.NuxtSSR,detectionMethod:tu},{platform:G.ReactSSR,detectionMethod:Gc},{platform:G.VueJsSSR,detectionMethod:Yc},{platform:G.AngularSSR,detectionMethod:ru},{platform:G.SvelteSSR,detectionMethod:Qc}];function cu(){var e;return((e=au.find(t=>t.detectionMethod()))==null?void 0:e.platform)||G.ServerSideUnknown}let qt;const rr=[];let gr=!1;const uu=10,lu=10,du=1e3,So=()=>{var e;if(!qt){if(qt=cu(),gr)for(;rr.length;)(e=rr.pop())==null||e();else rr.forEach(t=>{t()});Fi(G.ServerSideUnknown,uu),Fi(G.WebUnknown,lu)}return qt};function fu(){qt=void 0}function Fi(e,t){qt===e&&!gr&&setTimeout(()=>{fu(),gr=!0,setTimeout(So,du)},t)}const pu={},hu=(e,t)=>{var n,r;return(r=(n=pu[e])==null?void 0:n[t])==null?void 0:r.additionalDetails},mu="aws-amplify",gu=e=>e.replace(/\+.*/,""),yu=({category:e,action:t}={})=>{const n=[[mu,gu(Hc)]];if(e&&n.push([e,t]),n.push(["framework",So()]),e&&t){const r=hu(e,t);r&&r.forEach(i=>{n.push(i)})}return n},Et=e=>yu(e).map(([r,i])=>r&&i?`${r}/${i}`:r).join(" ");function te(e){return typeof e=="function"}function Eu(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var ir=Eu(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function qi(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Br=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Vt(o),c=a.next();!c.done;c=a.next()){var u=c.value;u.remove(this)}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else o.remove(this);var l=this.initialTeardown;if(te(l))try{l()}catch(m){s=m instanceof ir?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Vt(d),p=f.next();!p.done;p=f.next()){var h=p.value;try{Ki(h)}catch(m){s=s??[],m instanceof ir?s=hr(hr([],pr(s)),pr(m.errors)):s.push(m)}}}catch(m){r={error:m}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(s)throw new ir(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Ki(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&qi(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&qi(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();Br.EMPTY;function Io(e){return e instanceof Br||e&&"closed"in e&&te(e.remove)&&te(e.add)&&te(e.unsubscribe)}function Ki(e){te(e)?e():e.unsubscribe()}var vu={Promise:void 0},Su={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,hr([e,t],pr(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Ao(e){Su.setTimeout(function(){throw e})}function Bi(){}function Iu(e){e()}var $r=function(e){Fr(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Io(n)&&n.add(r)):r.destination=bu,r}return t.create=function(n,r,i){return new yr(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Br),Au=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){ln(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){ln(r)}else ln(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){ln(n)}},e}(),yr=function(e){Fr(t,e);function t(n,r,i){var s=e.call(this)||this,o;return te(n)||!n?o={next:n??void 0,error:r??void 0,complete:i??void 0}:o=n,s.destination=new Au(o),s}return t}($r);function ln(e){Ao(e)}function wu(e){throw e}var bu={closed:!0,next:Bi,error:wu,complete:Bi},Vr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Tu(e){return e}function Nu(e){return e.length===0?Tu:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var oe=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,s=Cu(t)?t:new yr(t,n,r);return Iu(function(){var o=i,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?i._subscribe(s):i._trySubscribe(s))}),s},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=$i(n),new n(function(i,s){var o=new yr({next:function(a){try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[Vr]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Nu(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=$i(t),new t(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},e.create=function(t){return new e(t)},e}();function $i(e){var t;return(t=e??vu.Promise)!==null&&t!==void 0?t:Promise}function Ru(e){return e&&te(e.next)&&te(e.error)&&te(e.complete)}function Cu(e){return e&&e instanceof $r||Ru(e)&&Io(e)}function xu(e){return te(e==null?void 0:e.lift)}function Jt(e){return function(t){if(xu(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Bn(e,t,n,r,i){return new _u(e,t,n,r,i)}var _u=function(e){Fr(t,e);function t(n,r,i,s,o,a){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(u){try{r(u)}catch(l){n.error(l)}}:e.prototype._next,c._error=s?function(u){try{s(u)}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=i?function(){try{i()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}($r),wo=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function bo(e){return te(e==null?void 0:e.then)}function To(e){return te(e[Vr])}function No(e){return Symbol.asyncIterator&&te(e==null?void 0:e[Symbol.asyncIterator])}function Ro(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Pu(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Co=Pu();function xo(e){return te(e==null?void 0:e[Co])}function _o(e){return Dc(this,arguments,function(){var n,r,i,s;return qr(this,function(o){switch(o.label){case 0:n=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,ct(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,ct(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,ct(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Po(e){return te(e==null?void 0:e.getReader)}function $n(e){if(e instanceof oe)return e;if(e!=null){if(To(e))return Ou(e);if(wo(e))return ku(e);if(bo(e))return Du(e);if(No(e))return Oo(e);if(xo(e))return Lu(e);if(Po(e))return Mu(e)}throw Ro(e)}function Ou(e){return new oe(function(t){var n=e[Vr]();if(te(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ku(e){return new oe(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Du(e){return new oe(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Ao)})}function Lu(e){return new oe(function(t){var n,r;try{for(var i=Vt(e),s=i.next();!s.done;s=i.next()){var o=s.value;if(t.next(o),t.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function Oo(e){return new oe(function(t){Uu(e,t).catch(function(n){return t.error(n)})})}function Mu(e){return Oo(_o(e))}function Uu(e,t){var n,r,i,s;return go(this,void 0,void 0,function(){var o,a;return qr(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=Lc(e),c.label=1;case 1:return[4,n.next()];case 2:if(r=c.sent(),!!r.done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function et(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function ko(e,t){return t===void 0&&(t=0),Jt(function(n,r){n.subscribe(Bn(r,function(i){return et(r,e,function(){return r.next(i)},t)},function(){return et(r,e,function(){return r.complete()},t)},function(i){return et(r,e,function(){return r.error(i)},t)}))})}function Do(e,t){return t===void 0&&(t=0),Jt(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Fu(e,t){return $n(e).pipe(Do(t),ko(t))}function qu(e,t){return $n(e).pipe(Do(t),ko(t))}function Ku(e,t){return new oe(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Bu(e,t){return new oe(function(n){var r;return et(n,t,function(){r=e[Co](),et(n,t,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return te(r==null?void 0:r.return)&&r.return()}})}function Lo(e,t){if(!e)throw new Error("Iterable cannot be null");return new oe(function(n){et(n,t,function(){var r=e[Symbol.asyncIterator]();et(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function $u(e,t){return Lo(_o(e),t)}function Vu(e,t){if(e!=null){if(To(e))return Fu(e,t);if(wo(e))return Ku(e,t);if(bo(e))return qu(e,t);if(No(e))return Lo(e,t);if(xo(e))return Bu(e,t);if(Po(e))return $u(e,t)}throw Ro(e)}function Wu(e,t){return t?Vu(e,t):$n(e)}function Wr(e,t){return Jt(function(n,r){var i=0;n.subscribe(Bn(r,function(s){r.next(e.call(t,s,i++))}))})}function Hu(e,t){return Jt(function(n,r){var i=0;n.subscribe(Bn(r,function(s){return e.call(t,s,i++)&&r.next(s)}))})}function Mo(e){return Jt(function(t,n){var r=null,i=!1,s;r=t.subscribe(Bn(n,void 0,void 0,function(o){s=$n(e(o,Mo(e)(t))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}const ju=()=>{if(typeof self>"u")return!1;const e=self;return typeof e.WorkerGlobalScope<"u"&&self instanceof e.WorkerGlobalScope};class ut{networkMonitor(t){const n=ju()?self:typeof window<"u"&&window;return n?new oe(r=>{r.next({online:n.navigator.onLine});const i=()=>{r.next({online:!0})},s=()=>{r.next({online:!1})};return n.addEventListener("online",i),n.addEventListener("offline",s),ut._observers.push(r),()=>{n.removeEventListener("online",i),n.removeEventListener("offline",s),ut._observers=ut._observers.filter(o=>o!==r)}}):Wu([{online:!0}])}static _observerOverride(t){for(const n of this._observers){if(n.closed){this._observers=this._observers.filter(r=>r!==n);continue}n!=null&&n.next&&n.next(t)}}}ut._observers=[];const Uo=()=>typeof window<"u"&&typeof window.document<"u",Vi=new Q("Auth");class Gu{configure(t,n){var r,i;this.authConfig=t,this.authOptions=n,t&&((r=t.Cognito)!=null&&r.userPoolEndpoint)&&Vi.warn(Wi("Amazon Cognito User Pool")),t&&((i=t.Cognito)!=null&&i.identityPoolEndpoint)&&Vi.warn(Wi("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var s,o,a,c,u,l;let n,r;const i=await this.getTokens(t);return i?(r=(o=(s=i.accessToken)==null?void 0:s.payload)==null?void 0:o.sub,n=await((c=(a=this.authOptions)==null?void 0:a.credentialsProvider)==null?void 0:c.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:i,authenticated:!0,forceRefresh:t.forceRefresh}))):n=await((l=(u=this.authOptions)==null?void 0:u.credentialsProvider)==null?void 0:l.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:i,credentials:n==null?void 0:n.credentials,identityId:n==null?void 0:n.identityId,userSub:r}}async clearCredentials(){var t,n;await((n=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:n.clearCredentialsAndIdentityId())}async getTokens(t){var n,r;return await((r=(n=this.authOptions)==null?void 0:n.tokenProvider)==null?void 0:r.getTokens(t))??void 0}}const Wi=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class zu{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Gu}configure(t,n){const r=mo(t);this.resourcesConfig=r,n&&(this.libraryOptions=n),this.resourcesConfig=po(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Ye.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",ze),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[mc](t){var n,r,i;(r=(n=this.resourcesConfig.Auth)==null?void 0:n.Cognito.loginWith)!=null&&r.oauth?t((i=this.resourcesConfig.Auth)==null?void 0:i.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,n,r;!((n=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&n.oauth)||!this.oAuthListener||(this.oAuthListener((r=this.resourcesConfig.Auth)==null?void 0:r.Cognito),this.oAuthListener=void 0)}}const B=new zu,Yu=(e,t)=>e.Auth.fetchAuthSession(t),Hr=e=>Yu(B,e);function Fo(){return B.Auth.clearCredentials()}const Vn=e=>{const{headers:t,statusCode:n}=e;return{...Ju(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},Ju=e=>typeof(e==null?void 0:e.$metadata)=="object",st=async e=>{if(!e||e.statusCode<300)return;const t=await Qt(e),r=(o=>{const[a]=o.toString().split(/[,:]+/);return a.includes("#")?a.split("#")[1]:a})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),i=t.message??t.Message??"Unknown error",s=new Error(i);return Object.assign(s,{name:r,$metadata:Vn(e)})},Qt=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:Vn(e)})},ge=(e,t,n,r)=>async(i,s)=>{const o={...r,...i},a=await o.endpointResolver(o,s),c=await t(s,a),u=await e(c,{...o});return n(u)},qo=5*60*1e3;function Ko(e=qo){return r=>{const i=2**r*100+100*Math.random();return i>e?!1:i}}const Bo=3,Hi="amz-sdk-invocation-id",Qu="amz-sdk-request",ji=5*60*1e3,jr=e=>{const n=Ko(ji)(e);return n===!1?ji:n},Xu=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Zu=e=>!!e&&Xu.includes(e),Gr=e=>async(t,n)=>{const r=n??await e(t)??void 0,i=(r==null?void 0:r.code)||(r==null?void 0:r.name),s=t==null?void 0:t.statusCode;return{retryable:rl(n)||nl(s,i)||Zu(i)||il(s,i)}},el=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],tl=["TimeoutError","RequestTimeout","RequestTimeoutException"],nl=(e,t)=>e===429||!!t&&el.includes(t),rl=e=>[Ge.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),il=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&tl.includes(t),$o="cognito-identity",Vo={service:$o,retryDecider:Gr(st),computeDelay:jr,cache:"no-store"},zr=({maxAttempts:e=Bo,retryDecider:t,computeDelay:n,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(i,s)=>async function(a){let c,u=s.attemptsCount??0,l;const d=()=>{if(l)return Gi(l,u),l;throw Gi(c,u),c};for(;!(r!=null&&r.aborted)&&u<e;){try{l=await i(a),c=void 0}catch(h){c=h,l=void 0}u=(s.attemptsCount??0)>u?s.attemptsCount??0:u+1,s.attemptsCount=u;const{isCredentialsExpiredError:f,retryable:p}=await t(l,c,s);if(p){if(s.isCredentialsExpired=!!f,!(r!=null&&r.aborted)&&u<e){const h=n(u);await sl(h,r)}continue}else return d()}if(r!=null&&r.aborted)throw new Error("Request aborted.");return d()}},sl=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let n,r;const i=new Promise(s=>{r=s,n=setTimeout(s,e)});return t==null||t.addEventListener("abort",function s(o){clearTimeout(n),t==null||t.removeEventListener("abort",s),r()}),i},Gi=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},Er=Sc,ol=()=>e=>async function(n){return n.headers[Hi]||(n.headers[Hi]=Er()),e(n)},al=({maxAttempts:e=Bo})=>(t,n)=>async function(i){const s=n.attemptsCount??0;return i.headers[Qu]=`attempt=${s+1}; max=${e}`,t(i)},Yr=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(i){if(t.trim().length===0)return await n(i);{const s=e.toLowerCase();return i.headers[s]=i.headers[s]?`${i.headers[s]} ${t}`:t,await n(i)}},Xt=(e,t)=>(n,r)=>{const i={};let s=o=>e(o,r);for(let o=t.length-1;o>=0;o--){const a=t[o];s=a(r)(s,i)}return s(n)},sr=e=>{let t;return()=>(t||(t=e()),t)},cl=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),Jr=async({url:e,method:t,headers:n,body:r},{abortSignal:i,cache:s,withCrossDomainCredentials:o})=>{var d;let a;try{a=await fetch(e,{method:t,headers:n,body:cl(t)?r:void 0,signal:i,cache:s,credentials:o?"include":"same-origin"})}catch(f){throw f instanceof TypeError?new ne({name:Ge.NetworkError,message:"A network error has occurred.",underlyingError:f}):f}const c={};(d=a.headers)==null||d.forEach((f,p)=>{c[p.toLowerCase()]=f});const u={statusCode:a.status,headers:c,body:null},l=Object.assign(a.body??{},{text:sr(()=>a.text()),blob:sr(()=>a.blob()),json:sr(()=>a.json())});return{...u,body:l}},Wo=Xt(Jr,[Yr,ol,zr,al]),ul=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},Ho=Xt(Wo,[ul]),jo=e=>(t,n)=>{const r=ll(e),i=JSON.stringify(t);return dl(n,r,i)},ll=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),dl=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),zi=e=>ge(Ho,jo("GetCredentialsForIdentity"),fl,{...Vo,...e,userAgentValue:Et()}),fl=async e=>{if(e.statusCode>=300)throw await st(e);const t=await Qt(e);return{IdentityId:t.IdentityId,Credentials:pl(t.Credentials),$metadata:Vn(e)}},pl=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),hl=e=>ge(Ho,jo("GetId"),ml,{...Vo,...e,userAgentValue:Et()}),ml=async e=>{if(e.statusCode>=300)throw await st(e);return{IdentityId:(await Qt(e)).IdentityId,$metadata:Vn(e)}},Go={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},gl={partitions:[Go,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},zo=e=>{const{partitions:t}=gl;for(const{regions:n,outputs:r,regionRegex:i}of t){const s=new RegExp(i);if(n.includes(e)||s.test(e))return r.dnsSuffix}return Go.outputs.dnsSuffix},Re=URL,Yo=URLSearchParams,yl=({region:e})=>({url:new Re(`https://${$o}.${e}.${zo(e)}`)});class Lt extends ne{constructor(){super({name:Ge.PlatformNotSupported,message:"Function not supported on current platform"})}}class Jo{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new Lt;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new Lt;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new Lt;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new Lt;this.storage.clear()}}class Qo{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const Xo=new Q("CoreStorageUtils"),El=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{Xo.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new Qo},Zo=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return Xo.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new Qo}};class vl extends Jo{constructor(){super(El())}}class Sl extends Jo{constructor(){super(Zo())}}class Il{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new Lt;return this._storage}setItem(t,n){this.storage.setItem(t,n)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class Al extends Il{constructor(){super(Zo())}}/*! js-cookie v3.0.5 | MIT */function dn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var wl={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function vr(e,t){function n(i,s,o){if(!(typeof document>"u")){o=dn({},t,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in o)o[c]&&(a+="; "+c,o[c]!==!0&&(a+="="+o[c].split(";")[0]));return document.cookie=i+"="+e.write(s,i)+a}}function r(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},a=0;a<s.length;a++){var c=s[a].split("="),u=c.slice(1).join("=");try{var l=decodeURIComponent(c[0]);if(o[l]=e.read(u,l),i===l)break}catch{}}return i?o[i]:o}}return Object.create({set:n,get:r,remove:function(i,s){n(i,"",dn({},s,{expires:-1}))},withAttributes:function(i){return vr(this.converter,dn({},this.attributes,i))},withConverter:function(i){return vr(dn({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var fn=vr(wl,{path:"/"});class bl{constructor(t={}){const{path:n,domain:r,expires:i,sameSite:s,secure:o}=t;if(this.domain=r,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?i:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?o:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!s||!["strict","lax","none"].includes(s))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(s==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=s}}async setItem(t,n){fn.set(t,n,this.getData())}async getItem(t){return fn.get(t)??null}async removeItem(t){fn.remove(t,this.getData())}async clear(){const t=fn.get(),n=Object.keys(t).map(r=>this.removeItem(r));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const Zt=new vl;new Sl;const De=new Al,ea=e=>Object.keys(e).map(t=>t.toLowerCase()).sort().join(";"),Tl="X-Amz-Date",Nl="X-Amz-Security-Token",Rl="authorization",Cl="host",xl=Tl.toLowerCase(),_l=Nl.toLowerCase(),ta="aws4_request",na="AWS4-HMAC-SHA256",Pl="AWS4",Ol="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",kl="UNSIGNED-PAYLOAD",Dl=(e,t,n)=>`${e}/${t}/${n}/${ta}`,Ll=e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}},Ml=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:r,uriEscapePath:i=!0})=>{const{accessKeyId:s,secretAccessKey:o,sessionToken:a}=e,{longDate:c,shortDate:u}=Ll(t),l=Dl(u,n,r);return{accessKeyId:s,credentialScope:l,longDate:c,secretAccessKey:o,sessionToken:a,shortDate:u,signingRegion:n,signingService:r,uriEscapePath:i}},Mt=(e,t)=>{const n=new Wt(e??void 0);return n.update(t),n.digestSync()},Sr=(e,t)=>{const n=Mt(e,t);return Wc(n)},Ul=e=>Object.entries(e).map(([t,n])=>({key:t.toLowerCase(),value:(n==null?void 0:n.trim().replace(/\s+/g," "))??""})).sort((t,n)=>t.key<n.key?-1:1).map(t=>`${t.key}:${t.value}
`).join(""),Fl=e=>Array.from(e).sort(([t,n],[r,i])=>t===r?n<i?-1:1:t<r?-1:1).map(([t,n])=>`${Yi(t)}=${Yi(n)}`).join("&"),Yi=e=>encodeURIComponent(e).replace(/[!'()*]/g,ql),ql=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,Kl=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",Bl=e=>e==null?Ol:$l(e)?Sr(null,e):kl,$l=e=>typeof e=="string"||ArrayBuffer.isView(e)||Vl(e),Vl=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]",Wl=({body:e,headers:t,method:n,url:r},i=!0)=>[n,Kl(r.pathname,i),Fl(r.searchParams),Ul(t),ea(t),Bl(e)].join(`
`),Hl=(e,t,n,r)=>{const i=`${Pl}${e}`,s=Mt(i,t),o=Mt(s,n),a=Mt(o,r);return Mt(a,ta)},jl=(e,t,n)=>[na,e,t,n].join(`
`),Gl=(e,{credentialScope:t,longDate:n,secretAccessKey:r,shortDate:i,signingRegion:s,signingService:o,uriEscapePath:a})=>{const c=Wl(e,a),u=Sr(null,c),l=jl(n,t,u);return Sr(Hl(r,i,s,o),l)},ra=(e,t)=>{const n=Ml(t),{accessKeyId:r,credentialScope:i,longDate:s,sessionToken:o}=n,a={...e.headers};a[Cl]=e.url.host,a[xl]=s,o&&(a[_l]=o);const c={...e,headers:a},u=Gl(c,n),l=`Credential=${r}/${i}`,d=`SignedHeaders=${ea(a)}`,f=`Signature=${u}`;return a[Rl]=`${na} ${l}, ${d}, ${f}`,c},ia=e=>new Date(Date.now()+e),zl=5*60*1e3,Yl=(e,t)=>Math.abs(ia(t).getTime()-e)>=zl,Jl=(e,t)=>Yl(e,t)?e-Date.now():t,Ql=({credentials:e,region:t,service:n,uriEscapePath:r=!0})=>{let i;return(s,o)=>async function(c){i=i??0;const u={credentials:typeof e=="function"?await e({forceRefresh:!!(o!=null&&o.isCredentialsExpired)}):e,signingDate:ia(i),signingRegion:t,signingService:n,uriEscapePath:r},l=await ra(c,u),d=await s(l),f=Xl(d);return f&&(i=Jl(Date.parse(f),i)),d}},Xl=({headers:e}={})=>(e==null?void 0:e.date)??(e==null?void 0:e.Date)??(e==null?void 0:e["x-amz-date"]);class Zl extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}const ed=(e,t,n=qo,r)=>uc(e,t,Ko(n)),td=e=>{let t;return async(...n)=>t||(t=new Promise((r,i)=>{e(...n).then(s=>{r(s)}).catch(s=>{i(s)}).finally(()=>{t=void 0})}),t)};function Ji({expiresAt:e,clockDrift:t,tolerance:n=5e3}){return Date.now()+t+n>e}const nd=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:r="",architecture:i="",fullVersionList:s=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),o=s.map(c=>`${c.brand}/${c.version}`).join(";");return[t,n,i,r,t,o].filter(c=>c).join(" ")||navigator.userAgent};class On extends ne{get response(){return this._response?rd(this._response):void 0}constructor(t){super(t),this.constructor=On,Object.setPrototypeOf(this,On.prototype),t.response&&(this._response=t.response)}}const rd=e=>({...e,headers:{...e.headers}});function id(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const ft={convert(e,t={urlSafe:!1,skipPadding:!1}){const n=typeof e=="string"?e:id(e);let r=oc()(n);return t.urlSafe&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(r=r.replace(/=/g,"")),r}};function sd(){return sc().getRandomValues(new Uint32Array(1))[0]}function od(e){const{words:t}=e,{sigBytes:n}=e,r=[];for(let i=0;i<n;i++){const s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((s&15).toString(16))}return r.join("")}class Qr{constructor(t,n){this.words=[];let r=t;r=this.words=r||[],n!==void 0?this.sigBytes=n:this.sigBytes=r.length*4}random(t){const n=[];for(let r=0;r<t;r+=4)n.push(sd());return new Qr(n,t)}toString(){return od(this)}}var x;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"})(x||(x={}));const sa={[x.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[x.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[x.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[x.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[x.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[x.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[x.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[x.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[x.EmptySignInPassword]:{message:"password is required to signIn"},[x.EmptySignInUsername]:{message:"username is required to signIn"},[x.EmptySignUpPassword]:{message:"password is required to signUp"},[x.EmptySignUpUsername]:{message:"username is required to signUp"},[x.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[x.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[x.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[x.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[x.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var Qi;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(Qi||(Qi={}));var pt;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(pt||(pt={}));class R extends ne{constructor(t){super(t),this.constructor=R,Object.setPrototypeOf(this,R.prototype)}}function z(e,t){const{message:n,recoverySuggestion:r}=sa[t];if(!e)throw new R({name:t,message:n,recoverySuggestion:r})}function X(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new R({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function Ir(e){if(!e||!e.includes(":"))throw new R({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function Xi(e){return Object.entries(e).map(([t,n])=>({Name:t,Value:n}))}var Zi;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(Zi||(Zi={}));var es;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(es||(es={}));var ts;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ts||(ts={}));var ns;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ns||(ns={}));var rs;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(rs||(rs={}));var is;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(is||(is={}));var ss;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ss||(ss={}));var os;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(os||(os={}));var as;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(as||(as={}));var cs;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(cs||(cs={}));var us;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(us||(us={}));var ls;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(ls||(ls={}));var ds;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ds||(ds={}));var fs;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(fs||(fs={}));var kn;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(kn||(kn={}));var ps;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(ps||(ps={}));var hs;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(hs||(hs={}));var ms;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ms||(ms={}));var Ar;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(Ar||(Ar={}));var gs;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(gs||(gs={}));var ys;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ys||(ys={}));var Es;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Es||(Es={}));var vs;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(vs||(vs={}));var Ss;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ss||(Ss={}));const Wn="UserUnAuthenticatedException",ad="UserAlreadyAuthenticatedException",cd="DeviceMetadataNotFoundException",ud="InvalidRedirectException",ld="InvalidAppSchemeException",dd="InvalidPreferredRedirectUrlException",fd=new R({name:ud,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new R({name:ld,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new R({name:dd,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const pd="InvalidOriginException",hd=new R({name:pd,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),md="OAuthSignOutException",gd="TokenRefreshException",yd="UnexpectedSignInInterruptionException";function Ed(e){if(!e||!e.accessToken)throw new R({name:Wn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function vd(e){if(!e||!e.idToken)throw new R({name:Wn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Sd=new R({name:gd,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),Id=new R({name:Wn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function oa(e){if(bd(e))throw Sd;if(!wd(e))throw Id}function aa(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new R({name:cd,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const Ad={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function ca(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function wd(e){return ca(e)&&(e==null?void 0:e.refreshToken)}function bd(e){return ca(e)&&!(e!=null&&e.refreshToken)}const Td=async e=>{var a,c;const t=(a=e.getConfig().Auth)==null?void 0:a.Cognito;M(t);const n=await e.Auth.getTokens({forceRefresh:!1});Ed(n);const{"cognito:username":r,sub:i}=((c=n.idToken)==null?void 0:c.payload)??{},s={username:r,userId:i},o=Nd(n);return o&&(s.signInDetails=o),s};function Nd(e){return e==null?void 0:e.signInDetails}const Kt=async()=>Td(B),ye=(e,t)=>Et({category:Pn.Auth,action:e,...t}),xe=e=>(t,n)=>{const r=Rd(e),i=JSON.stringify(t);return Cd(n,r,i)},Rd=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),Cd=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function Ie(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new R({name:Ge.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const Ke=()=>async e=>{if(e.statusCode>=300){const t=await st(e);throw Ie(t),new R({name:t.name,message:t.message,metadata:t.$metadata})}return Qt(e)},xd=()=>(e,t)=>async function(r){return r.headers["cache-control"]="no-store",e(r)},_e=Xt(Wo,[xd]),ua="cognito-idp",Pe={service:ua,retryDecider:Gr(st),computeDelay:jr,userAgentValue:Et(),cache:"no-store"},vt=e=>ge(_e,xe("InitiateAuth"),Ke(),{...Pe,...e}),Hn=e=>ge(_e,xe("RespondToAuthChallenge"),Ke(),{...Pe,...e}),_d=e=>ge(_e,xe("AssociateSoftwareToken"),Ke(),{...Pe,...e}),Pd=({region:e})=>({url:new Re(`https://${ua}.${e}.${zo(e)}`)}),Z=({endpointOverride:e})=>t=>e?{url:new Re(e)}:Pd(t);function ue({username:e,userPoolId:t,userPoolClientId:n}){if(typeof window>"u")return;const r=window.AmazonCognitoAdvancedSecurityData;if(typeof r>"u")return;const i=r.getData(e,t,n);return i?{EncodedData:i}:{}}const Od=async({tokens:e,authConfig:t,username:n})=>{var g;M(t==null?void 0:t.Cognito);const{userPoolId:r,userPoolClientId:i,userPoolEndpoint:s}=t.Cognito,o=X(r);oa(e);const a=e.refreshToken,c={REFRESH_TOKEN:a};(g=e.deviceMetadata)!=null&&g.deviceKey&&(c.DEVICE_KEY=e.deviceMetadata.deviceKey);const u=ue({username:n,userPoolId:r,userPoolClientId:i}),l=vt({endpointResolver:Z({endpointOverride:s})}),{AuthenticationResult:d}=await l({region:o},{ClientId:i,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:c,UserContextData:u}),f=tt((d==null?void 0:d.AccessToken)??""),p=d!=null&&d.IdToken?tt(d.IdToken):void 0,{iat:h}=f.payload;if(!h)throw new R({name:"iatNotFoundException",message:"iat not found in access token"});const m=h*1e3-new Date().getTime();return{accessToken:f,idToken:p,clockDrift:m,refreshToken:a,username:n}},kd=td(Od),Dd={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var Dn;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(Dn||(Dn={}));const Ld={[Dn.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},Md=Lr(Ld),Is="CognitoIdentityServiceProvider";class Ud{getKeyValueStorage(){if(!this.keyValueStorage)throw new R({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new R({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const r=tt(n),i=await this.getKeyValueStorage().getItem(t.idToken),s=i?tt(i):void 0,o=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,a=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(a),u=await this.getKeyValueStorage().getItem(t.signInDetails),l={accessToken:r,idToken:s,refreshToken:o,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return u&&(l.signInDetails=JSON.parse(u)),l}catch{return null}}async storeTokens(t){Md(t!==void 0,Dn.InvalidAuthTokens);const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const r=await this.getAuthKeys();await this.getKeyValueStorage().setItem(r.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(r.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(r.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(r.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(r.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(r.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(r.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(r.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(r.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(r.signInDetails),await this.getKeyValueStorage().setItem(r.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),r=await this.getKeyValueStorage().getItem(n.deviceKey),i=await this.getKeyValueStorage().getItem(n.deviceGroupKey),s=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return s&&i&&r?{deviceKey:r,deviceGroupKey:i,randomPassword:s}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){var r;M((r=this.authConfig)==null?void 0:r.Cognito);const n=t??await this.getLastAuthUser();return Fd(Is,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){var n;M((n=this.authConfig)==null?void 0:n.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${Is}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:n}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t);return n&&JSON.parse(n)}}const Fd=(e,t)=>Xr(Dd)(`${e}`,t);function Xr(e){const t=Object.values({...e});return(n,r)=>t.reduce((i,s)=>({...i,[s]:`${n}.${r}.${s}`}),{})}const As="amplify-signin-with-hostedUI",we="CognitoIdentityServiceProvider";class la{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){M(this.cognitoConfig);const t=be(we,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){M(this.cognitoConfig);const t=be(we,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(As),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){M(this.cognitoConfig);const t=be(we,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){M(this.cognitoConfig);const n=be(we,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){M(this.cognitoConfig);const t=be(we,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){M(this.cognitoConfig);const n=be(we,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){M(this.cognitoConfig);const t=be(we,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){M(this.cognitoConfig);const n=be(we,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var s;M(this.cognitoConfig);const t=be(we,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(As),[r,i]=((s=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:s.split(","))??[];return{isOAuthSignIn:r==="true"||n==="true",preferPrivateSession:i==="true"}}async storeOAuthSignIn(t,n=!1){M(this.cognitoConfig);const r=be(we,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(r.oauthSignIn,`${t},${n}`)}}const be=(e,t)=>Xr(Ad)(e,t),ws=new la(Zt);class qd{constructor(){this.waitForInflightOAuth=Uo()?async()=>{if(await ws.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){ws.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new R({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new R({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){var o,a,c,u,l;let n;try{M((o=this.authConfig)==null?void 0:o.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const r=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const i=!!(n!=null&&n.idToken)&&Ji({expiresAt:(((c=(a=n.idToken)==null?void 0:a.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:n.clockDrift??0}),s=Ji({expiresAt:(((l=(u=n.accessToken)==null?void 0:u.payload)==null?void 0:l.exp)??0)*1e3,clockDrift:n.clockDrift??0});return(t!=null&&t.forceRefresh||i||s)&&(n=await this.refreshTokens({tokens:n,username:r}),n===null)?null:{accessToken:n==null?void 0:n.accessToken,idToken:n==null?void 0:n.idToken,signInDetails:n==null?void 0:n.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:r}=t,i=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return i.signInDetails=r,await this.setTokens({tokens:i}),Ye.dispatch("auth",{event:"tokenRefresh"},"Auth",ze),i}catch(r){return this.handleErrors(r)}}handleErrors(t){if(Ie(t),t.name!==Ge.NetworkError&&this.clearTokens(),Ye.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",ze),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class Kd{constructor(){this.authTokenStore=new Ud,this.authTokenStore.setKeyValueStorage(Zt),this.tokenOrchestrator=new qd,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(kd)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const Ut=new Kd,{tokenOrchestrator:me}=Ut;async function St(e){if(e.AccessToken){const t=tt(e.AccessToken),n=(t.payload.iat||0)*1e3,r=new Date().getTime(),i=n>0?n-r:0;let s,o,a;e.RefreshToken&&(o=e.RefreshToken),e.IdToken&&(s=tt(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(a=e.NewDeviceMetadata);const c={accessToken:t,idToken:s,refreshToken:o,clockDrift:i,deviceMetadata:a,username:e.username};e!=null&&e.signInDetails&&(c.signInDetails=e.signInDetails),await me.setTokens({tokens:c})}else throw new ne({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const Bd="Unable to get user session following successful sign-in.",It=async()=>{try{Ye.dispatch("auth",{event:"signedIn",data:await Kt()},"Auth",ze)}catch(e){throw e.name===Wn?new R({name:yd,message:Bd,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function da(){return{active:!1}}const $d=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return da();default:return e}},Vd=e=>{let t=e(da(),{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},Ve=Vd($d),Wd=3*60*1e3,pn="CognitoSignInState",Le={username:`${pn}.username`,challengeName:`${pn}.challengeName`,signInSession:`${pn}.signInSession`,expiry:`${pn}.expiry`},Hd=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return hn({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return hn(t.value),{...t.value};case"SET_CHALLENGE_NAME":return hn({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return hn({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return Gd();case"RESET_STATE":return fa(),Zr();default:return e}},jd=e=>{const t=Number(e),n=Date.now();return t<=n},Ce=()=>{Je.dispatch({type:"RESET_STATE"})},fa=()=>{for(const e of Object.values(Le))De.removeItem(e)},Zr=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),Gd=()=>{const e=De.getItem(Le.expiry);if(!e||jd(e))return fa(),Zr();const t=De.getItem(Le.username)??void 0,n=De.getItem(Le.challengeName)??void 0,r=De.getItem(Le.signInSession)??void 0;return{username:t,challengeName:n,signInSession:r}},zd=e=>{let t=e(Zr(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},Je=zd(Hd);function At(e){Je.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const hn=({challengeName:e,signInSession:t,username:n})=>{n&&De.setItem(Le.username,n),e&&De.setItem(Le.challengeName,e),t&&(De.setItem(Le.signInSession,t),De.setItem(Le.expiry,String(Date.now()+Wd)))};class Me extends ne{constructor(t){super(t),this.constructor=Me,Object.setPrototypeOf(this,Me.prototype)}}var j;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(j||(j={}));const bs="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",or="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",Ts="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",Ln={[j.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:bs},[j.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:Ts},[j.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:Ts},[j.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:bs},[j.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[j.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[j.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:or},[j.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:or},[j.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:or},[j.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},ei=Lr(Ln,Me),Yd=e=>{if(e instanceof Me)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:n}=Ln[j.PasskeyAuthenticationCanceled];return new Me({name:j.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return Jd(e)},Jd=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:n}=Ln[j.PasskeyOperationAborted];return new Me({name:j.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:n}=Ln[j.RelyingPartyMismatch];return new Me({name:j.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new Me({name:Ge.Unknown,message:"An unknown error has occurred.",underlyingError:e})},Qd=()=>Uo()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",Ot=e=>ft.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),Ns=e=>Uint8Array.from(Mr.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,Xd=e=>{const t=Ns(e.challenge),n=(e.allowCredentials||[]).map(r=>({...r,id:Ns(r.id)}));return{...e,challenge:t,allowCredentials:n}},Zd=e=>{const t={clientDataJSON:Ot(e.response.clientDataJSON),authenticatorData:Ot(e.response.authenticatorData),signature:Ot(e.response.signature)};e.response.userHandle&&(t.userHandle=Ot(e.response.userHandle));const n={id:e.id,rawId:Ot(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n};function ef(e){ei(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,j.PasskeyRetrievalFailed)}const tf=async e=>{try{const t=Qd();ei(t,j.PasskeyNotSupported);const n=Xd(e),r=await navigator.credentials.get({publicKey:n});return ef(r),Zd(r)}catch(t){throw Yd(t)}},nf=e=>ge(_e,xe("ConfirmDevice"),Ke(),{...Pe,...e}),vn={convert(e){return new TextEncoder().encode(e)}};function w(e,t){e!=null&&this.fromString(e,t)}function ie(){return new w(null,null)}let je;const rf=0xdeadbeefcafe,Rs=(rf&16777215)===15715070;function sf(e,t,n,r,i,s){for(;--s>=0;){const o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=o&67108863}return i}function of(e,t,n,r,i,s){const o=t&32767,a=t>>15;for(;--s>=0;){let c=this[e]&32767;const u=this[e++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+n[r]+(i&1073741823),i=(c>>>30)+(l>>>15)+a*u+(i>>>30),n[r++]=c&1073741823}return i}function af(e,t,n,r,i,s){const o=t&16383,a=t>>14;for(;--s>=0;){let c=this[e]&16383;const u=this[e++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+n[r]+i,i=(c>>28)+(l>>14)+a*u,n[r++]=c&268435455}return i}const Cs=typeof navigator<"u";Cs&&Rs&&navigator.appName==="Microsoft Internet Explorer"?(w.prototype.am=of,je=30):Cs&&Rs&&navigator.appName!=="Netscape"?(w.prototype.am=sf,je=26):(w.prototype.am=af,je=28);w.prototype.DB=je;w.prototype.DM=(1<<je)-1;w.prototype.DV=1<<je;const ti=52;w.prototype.FV=Math.pow(2,ti);w.prototype.F1=ti-je;w.prototype.F2=2*je-ti;const cf="0123456789abcdefghijklmnopqrstuvwxyz",jn=[];let wt,he;wt=48;for(he=0;he<=9;++he)jn[wt++]=he;wt=97;for(he=10;he<36;++he)jn[wt++]=he;wt=65;for(he=10;he<36;++he)jn[wt++]=he;function xs(e){return cf.charAt(e)}function uf(e,t){const n=jn[e.charCodeAt(t)];return n??-1}function lf(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function df(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function ni(e){const t=ie();return t.fromInt(e),t}function ff(e,t){let n;if(t===16)n=4;else if(t===8)n=3;else if(t===2)n=1;else if(t===32)n=5;else if(t===4)n=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let r=e.length,i=!1,s=0;for(;--r>=0;){const o=uf(e,r);if(o<0){e.charAt(r)==="-"&&(i=!0);continue}i=!1,s===0?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=n,s>=this.DB&&(s-=this.DB)}this.clamp(),i&&w.ZERO.subTo(this,this)}function pf(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function hf(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const n=(1<<t)-1;let r,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(i=!0,s=xs(r));o>=0;)a<t?(r=(this[o]&(1<<a)-1)<<t-a,r|=this[--o]>>(a+=this.DB-t)):(r=this[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(i=!0),i&&(s+=xs(r));return i?s:"0"}function mf(){const e=ie();return w.ZERO.subTo(this,e),e}function gf(){return this.s<0?this.negate():this}function yf(e){let t=this.s-e.s;if(t!=0)return t;let n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this[n]-e[n])!=0)return t;return 0}function ri(e){let t=1,n;return(n=e>>>16)!==0&&(e=n,t+=16),(n=e>>8)!==0&&(e=n,t+=8),(n=e>>4)!==0&&(e=n,t+=4),(n=e>>2)!==0&&(e=n,t+=2),(n=e>>1)!==0&&(e=n,t+=1),t}function Ef(){return this.t<=0?0:this.DB*(this.t-1)+ri(this[this.t-1]^this.s&this.DM)}function vf(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function Sf(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function If(e,t){const n=e%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(e/this.DB);let o=this.s<<n&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>r|o,o=(this[a]&i)<<n;for(a=s-1;a>=0;--a)t[a]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Af(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}const r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(let o=n+1;o<this.t;++o)t[o-n-1]|=(this[o]&s)<<i,t[o-n]=this[o]>>r;r>0&&(t[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function wf(e,t){let n=0,r=0;const i=Math.min(e.t,this.t);for(;n<i;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()}function bf(e,t){const n=this.abs(),r=e.abs();let i=n.t;for(t.t=i+r.t;--i>=0;)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&w.ZERO.subTo(t,t)}function Tf(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function Nf(e,t,n){const r=e.abs();if(r.t<=0)return;const i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n===null&&(n=ie());const s=ie(),o=this.s,a=e.s,c=this.DB-ri(r[r.t-1]);c>0?(r.lShiftTo(c,s),i.lShiftTo(c,n)):(r.copyTo(s),i.copyTo(n));const u=s.t,l=s[u-1];if(l===0)return;const d=l*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),f=this.FV/d,p=(1<<this.F1)/d,h=1<<this.F2;let m=n.t,g=m-u;const E=t===null?ie():t;for(s.dlShiftTo(g,E),n.compareTo(E)>=0&&(n[n.t++]=1,n.subTo(E,n)),w.ONE.dlShiftTo(u,E),E.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--g>=0;){let S=n[--m]===l?this.DM:Math.floor(n[m]*f+(n[m-1]+h)*p);if((n[m]+=s.am(0,S,n,g,0,u))<S)for(s.dlShiftTo(g,E),n.subTo(E,n);n[m]<--S;)n.subTo(E,n)}t!==null&&(n.drShiftTo(u,t),o!==a&&w.ZERO.subTo(t,t)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),o<0&&w.ZERO.subTo(n,n)}function Rf(e){const t=ie();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(w.ZERO)>0&&e.subTo(t,t),t}function Cf(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function xf(e){return this.compareTo(e)===0}function _f(e,t){let n=0,r=0;const i=Math.min(e.t,this.t);for(;n<i;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()}function Pf(e){const t=ie();return this.addTo(e,t),t}function Of(e){const t=ie();return this.subTo(e,t),t}function kf(e){const t=ie();return this.multiplyTo(e,t),t}function Df(e){const t=ie();return this.divRemTo(e,t,null),t}function bt(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Lf(e){const t=ie();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(w.ZERO)>0&&this.m.subTo(t,t),t}function Mf(e){const t=ie();return e.copyTo(t),this.reduce(t),t}function Uf(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=e[t]&32767;const r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Ff(e,t){e.squareTo(t),this.reduce(t)}function qf(e,t,n){e.multiplyTo(t,n),this.reduce(n)}bt.prototype.convert=Lf;bt.prototype.revert=Mf;bt.prototype.reduce=Uf;bt.prototype.mulTo=qf;bt.prototype.sqrTo=Ff;function Kf(e,t,n){let r=e.bitLength(),i,s=ni(1);const o=new bt(t);if(r<=0)return s;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6;const a=[];let c=3;const u=i-1,l=(1<<i)-1;if(a[1]=o.convert(this),i>1){const E=ie();for(o.sqrTo(a[1],E);c<=l;)a[c]=ie(),o.mulTo(E,a[c-2],a[c]),c+=2}let d=e.t-1,f,p=!0,h=ie(),m;for(r=ri(e[d])-1;d>=0;){for(r>=u?f=e[d]>>r-u&l:(f=(e[d]&(1<<r+1)-1)<<u-r,d>0&&(f|=e[d-1]>>this.DB+r-u)),c=i;(f&1)===0;)f>>=1,--c;if((r-=c)<0&&(r+=this.DB,--d),p)a[f].copyTo(s),p=!1;else{for(;c>1;)o.sqrTo(s,h),o.sqrTo(h,s),c-=2;c>0?o.sqrTo(s,h):(m=s,s=h,h=m),o.mulTo(h,a[f],s)}for(;d>=0&&(e[d]&1<<r)===0;)o.sqrTo(s,h),m=s,s=h,h=m,--r<0&&(r=this.DB-1,--d)}const g=o.revert(s);return n(null,g),g}w.prototype.copyTo=lf;w.prototype.fromInt=df;w.prototype.fromString=ff;w.prototype.clamp=pf;w.prototype.dlShiftTo=vf;w.prototype.drShiftTo=Sf;w.prototype.lShiftTo=If;w.prototype.rShiftTo=Af;w.prototype.subTo=wf;w.prototype.multiplyTo=bf;w.prototype.squareTo=Tf;w.prototype.divRemTo=Nf;w.prototype.invDigit=Cf;w.prototype.addTo=_f;w.prototype.toString=hf;w.prototype.negate=mf;w.prototype.abs=gf;w.prototype.compareTo=yf;w.prototype.bitLength=Ef;w.prototype.mod=Rf;w.prototype.equals=xf;w.prototype.add=Pf;w.prototype.subtract=Of;w.prototype.multiply=kf;w.prototype.divide=Df;w.prototype.modPow=Kf;w.ZERO=ni(0);w.ONE=ni(1);const Bf=async({a:e,g:t,k:n,x:r,B:i,N:s,U:o})=>new Promise((a,c)=>{t.modPow(r,s,(u,l)=>{if(u){c(u);return}i.subtract(n.multiply(l)).modPow(e.add(o.multiply(r)),s,(d,f)=>{if(d){c(d);return}a(f.mod(s))})})}),$f="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",pa={},wr={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),pa[e]=t,wr[t]=e}const ht=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const r=e.slice(n,n+2).toLowerCase();if(r in wr)t[n/2]=wr[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t},ii=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=pa[e[n]];return t},br=e=>{const t=new Wt;t.update(e);const n=t.digestSync(),r=ii(n);return new Array(64-r.length).join("0")+r},Sn=e=>br(ht(e)),Vf=/^[89a-f]/i,Oe=e=>{if(!(e instanceof w))throw new Error("Not a BigInteger");const t=e.compareTo(w.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=Vf.test(n)?`00${n}`:n,t){const r=n.split("").map(s=>{const o=~parseInt(s,16)&15;return"0123456789ABCDEF".charAt(o)}).join("");n=new w(r,16).add(w.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},Wf=({A:e,B:t})=>{const n=new w(Sn(Oe(e)+Oe(t)),16);if(n.equals(w.ZERO))throw new Error("U cannot be zero.");return n},Hf=(e,t,n)=>{const r=new Wt(t);r.update(e);const i=r.digestSync(),s=new Wt(i);return s.update(n),s.digestSync().slice(0,16)},si=e=>{const t=new Qr().random(e).toString();return ht(t)},jf=()=>ft.convert(si(40));class Gf{constructor({userPoolName:t,a:n,g:r,A:i,N:s}){this.encoder=vn,this.userPoolName=t,this.a=n,this.g=r,this.A=i,this.N=s,this.k=new w(Sn(`${Oe(s)}${Oe(r)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new R({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new R({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new R({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,n){this.randomPassword=jf();const r=`${t}${n}:${this.randomPassword}`,i=br(r),s=ii(si(16));return this.saltToHashDevices=Oe(new w(s,16)),new Promise((o,a)=>{this.g.modPow(new w(Sn(this.saltToHashDevices+i),16),this.N,(c,u)=>{if(c){a(c);return}this.verifierDevices=Oe(u),o()})})}async getPasswordAuthenticationKey({username:t,password:n,serverBValue:r,salt:i}){if(r.mod(this.N).equals(w.ZERO))throw new Error("B cannot be zero.");const s=Wf({A:this.A,B:r}),o=`${this.userPoolName}${t}:${n}`,a=br(o),c=new w(Sn(Oe(i)+a),16),u=await Bf({a:this.a,g:this.g,k:this.k,x:c,B:r,N:this.N,U:s}),l=this.encoder.convert("Caldera Derived Key"),d=this.encoder.convert(""),f=new Uint8Array(l.byteLength+d.byteLength);return f.set(l,0),f.set(d,l.byteLength),Hf(ht(Oe(u)),ht(Oe(s)),f)}}const zf=async({a:e,g:t,N:n})=>new Promise((r,i)=>{t.modPow(e,n,(s,o)=>{if(s){i(s);return}if(o.mod(n).equals(w.ZERO)){i(new Error("Illegal parameter. A mod N cannot be 0."));return}r(o)})}),Gn=async e=>{const t=new w($f,16),n=new w("2",16),r=Yf(),i=await zf({a:r,g:n,N:t});return new Gf({userPoolName:e,a:r,g:n,A:i,N:t})},Yf=()=>{const e=ii(si(128));return new w(e,16)};async function Tt({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:r}){if(!n)return;const i=e.split("_")[1]||"",s=await Gn(i),o=n==null?void 0:n.DeviceKey,a=n==null?void 0:n.DeviceGroupKey;try{await s.generateHashDevice(a??"",o??"")}catch{return}const c={Salt:ft.convert(ht(s.getSaltToHashDevices())),PasswordVerifier:ft.convert(ht(s.getVerifierDevices()))},u=s.getRandomPassword();try{return await nf({endpointResolver:Z({endpointOverride:t})})({region:X(e)},{AccessToken:r,DeviceName:await nd(),DeviceKey:n==null?void 0:n.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:o,deviceGroupKey:a,randomPassword:u}}catch{return}}async function Jf(e){var p;const t=(p=B.getConfig().Auth)==null?void 0:p.Cognito;M(t);const{username:n,signInSession:r,signInDetails:i,challengeName:s}=Je.getState();if(s!=="WEB_AUTHN"||!n)throw new R({name:pt.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:o}=e;ei(!!o,j.InvalidPasskeyAuthenticationOptions);const a=await tf(JSON.parse(o)),c=Hn({endpointResolver:Z({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:u,ChallengeParameters:l,AuthenticationResult:d,Session:f}=await c({region:X(t.userPoolId),userAgentValue:ye(se.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(a)},ClientId:t.userPoolClientId,Session:r});if(At({signInSession:f,username:n,challengeName:u,signInDetails:i}),d)return await St({...d,username:n,NewDeviceMetadata:await Tt({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:i}),Je.dispatch({type:"RESET_STATE"}),await It(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(u==="WEB_AUTHN")throw new R({name:pt.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:u,challengeParameters:l}}const Qf=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Xf=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ha=()=>{const e=new Date,t=Xf[e.getUTCDay()],n=Qf[e.getUTCMonth()],r=e.getUTCDate();let i=e.getUTCHours();i<10&&(i=`0${i}`);let s=e.getUTCMinutes();s<10&&(s=`0${s}`);let o=e.getUTCSeconds();o<10&&(o=`0${o}`);const a=e.getUTCFullYear();return`${t} ${n} ${r} ${i}:${s}:${o} UTC ${a}`},ma=({userPoolName:e,username:t,challengeParameters:n,dateNow:r,hkdf:i})=>{const s=vn.convert(e),o=vn.convert(t),a=Zf(n.SECRET_BLOCK),c=vn.convert(r),u=new Uint8Array(s.byteLength+o.byteLength+a.byteLength+c.byteLength);u.set(s,0),u.set(o,s.byteLength),u.set(a,s.byteLength+o.byteLength),u.set(c,s.byteLength+o.byteLength+a.byteLength);const l=new Wt(i);l.update(u);const d=l.digestSync();return ft.convert(d)},Zf=e=>{const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=Mr.convert(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i};async function oi({username:e,config:t,clientMetadata:n,session:r,tokenOrchestrator:i}){const{userPoolId:s,userPoolEndpoint:o}=t,a=t.userPoolClientId,c=await(i==null?void 0:i.getDeviceMetadata(e));aa(c);const u=await Gn(c.deviceGroupKey),l={USERNAME:e,SRP_A:u.A.toString(16),DEVICE_KEY:c.deviceKey},d={ChallengeName:"DEVICE_SRP_AUTH",ClientId:a,ChallengeResponses:l,ClientMetadata:n,Session:r},f=Hn({endpointResolver:Z({endpointOverride:o})}),{ChallengeParameters:p,Session:h}=await f({region:X(s)},d);return ep(e,p,n,h,u,t,i)}async function ep(e,t,n,r,i,{userPoolId:s,userPoolClientId:o,userPoolEndpoint:a},c){const u=await(c==null?void 0:c.getDeviceMetadata(e));aa(u);const l=new w(t==null?void 0:t.SRP_B,16),d=new w(t==null?void 0:t.SALT,16),{deviceKey:f}=u,{deviceGroupKey:p}=u,h=await i.getPasswordAuthenticationKey({username:u.deviceKey,password:u.randomPassword,serverBValue:l,salt:d}),m=ha(),g={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:m,PASSWORD_CLAIM_SIGNATURE:ma({username:f,userPoolName:p,challengeParameters:t,dateNow:m,hkdf:h}),DEVICE_KEY:f},E=ue({username:e,userPoolId:s,userPoolClientId:o}),S={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:o,ChallengeResponses:g,Session:r,ClientMetadata:n,UserContextData:E};return Hn({endpointResolver:Z({endpointOverride:a})})({region:X(s)},S)}async function ga(e,t,n,r,i,s,o){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=s,l=(a==null?void 0:a.split("_")[1])||"",d=new w(t==null?void 0:t.SRP_B,16),f=new w(t==null?void 0:t.SALT,16),p=t==null?void 0:t.USER_ID_FOR_SRP;if(!p)throw new R({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const h=await i.getPasswordAuthenticationKey({username:p,password:e,serverBValue:d,salt:f}),m=ha(),g={USERNAME:p,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:m,PASSWORD_CLAIM_SIGNATURE:ma({username:p,userPoolName:l,challengeParameters:t,dateNow:m,hkdf:h})},E=await o.getDeviceMetadata(p);E&&E.deviceKey&&(g.DEVICE_KEY=E.deviceKey);const S=ue({username:p,userPoolId:a,userPoolClientId:c}),A={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:g,ClientMetadata:n,Session:r,ClientId:c,UserContextData:S},v=await Hn({endpointResolver:Z({endpointOverride:u})})({region:X(a)},A);return v.ChallengeName==="DEVICE_SRP_AUTH"?oi({username:p,config:s,clientMetadata:n,session:v.Session,tokenOrchestrator:o}):v}async function zn(e,t,n,r){try{return await e(...t)}catch(i){if(i instanceof R&&i.name==="ResourceNotFoundException"&&i.message.includes("Device does not exist."))return await r.clearDeviceMetadata(n),e(...t);throw i}}function en(e){const{dispatch:t}=Je;t({type:"SET_USERNAME",value:e})}async function ya({username:e,password:t,clientMetadata:n,config:r,tokenOrchestrator:i,authFlow:s,preferredChallenge:o}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=r,l=(a==null?void 0:a.split("_")[1])||"",d=await Gn(l),f={USERNAME:e,SRP_A:d.A.toString(16)};s==="USER_AUTH"&&o&&(f.PREFERRED_CHALLENGE=o);const p=ue({username:e,userPoolId:a,userPoolClientId:c}),h={AuthFlow:s,AuthParameters:f,ClientMetadata:n,ClientId:c,UserContextData:p},g=await vt({endpointResolver:Z({endpointOverride:u})})({region:X(a),userAgentValue:ye(se.SignIn)},h),{ChallengeParameters:E,Session:S}=g,A=(E==null?void 0:E.USERNAME)??e;return en(A),g.ChallengeName==="PASSWORD_VERIFIER"?zn(ga,[t,E,n,S,d,r,i],A,i):g}const _s="userAttributes.";function tp(e){return"isSignedIn"in e&&"nextStep"in e}async function np(e,t,n,r,i){var m,g;const{userPoolClientId:s,userPoolId:o,userPoolEndpoint:a}=r,c={USERNAME:e,PASSWORD:t},u=await i.getDeviceMetadata(e);u&&u.deviceKey&&(c.DEVICE_KEY=u.deviceKey);const l=ue({username:e,userPoolId:o,userPoolClientId:s}),d={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:n,ClientId:s,UserContextData:l},p=await vt({endpointResolver:Z({endpointOverride:a})})({region:X(o),userAgentValue:ye(se.SignIn)},d),h=((m=p.ChallengeParameters)==null?void 0:m.USERNAME)??((g=p.ChallengeParameters)==null?void 0:g.USER_ID_FOR_SRP)??e;return en(h),p.ChallengeName==="DEVICE_SRP_AUTH"?oi({username:h,config:r,clientMetadata:n,session:p.Session,tokenOrchestrator:i}):p}async function rp(e,t,n,r,i){return ya({username:e,password:t,clientMetadata:n,config:r,tokenOrchestrator:i,authFlow:"USER_SRP_AUTH"})}async function ip(e,t,n,r){var h;const{userPoolClientId:i,userPoolId:s,userPoolEndpoint:o}=n,a={USERNAME:e},c=await r.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);const u=ue({username:e,userPoolId:s,userPoolClientId:i}),l={AuthFlow:"CUSTOM_AUTH",AuthParameters:a,ClientMetadata:t,ClientId:i,UserContextData:u},f=await vt({endpointResolver:Z({endpointOverride:o})})({region:X(s),userAgentValue:ye(se.SignIn)},l),p=((h=f.ChallengeParameters)==null?void 0:h.USERNAME)??e;return en(p),f.ChallengeName==="DEVICE_SRP_AUTH"?oi({username:p,config:n,clientMetadata:t,session:f.Session,tokenOrchestrator:r}):f}async function sp(e,t,n,r,i){M(r);const{userPoolId:s,userPoolClientId:o,userPoolEndpoint:a}=r,c=(s==null?void 0:s.split("_")[1])||"",u=await Gn(c),l={USERNAME:e,SRP_A:u.A.toString(16),CHALLENGE_NAME:"SRP_A"},d=ue({username:e,userPoolId:s,userPoolClientId:o}),f={AuthFlow:"CUSTOM_AUTH",AuthParameters:l,ClientMetadata:n,ClientId:o,UserContextData:d},p=vt({endpointResolver:Z({endpointOverride:a})}),{ChallengeParameters:h,Session:m}=await p({region:X(s),userAgentValue:ye(se.SignIn)},f),g=(h==null?void 0:h.USERNAME)??e;return en(g),zn(ga,[t,h,n,m,u,r,i],g,i)}async function Nt(e){var s;const{challengeName:t,challengeParameters:n,availableChallenges:r}=e,i=(s=B.getConfig().Auth)==null?void 0:s.Cognito;switch(M(i),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:o,username:a}=Je.getState(),c=Ps(Os(n.MFAS_CAN_SETUP))||[],u=up(c),l=u.includes("TOTP"),d=u.includes("EMAIL");if(l&&d)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:u}};if(d)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(l){const f=_d({endpointResolver:Z({endpointOverride:i.userPoolEndpoint})}),{Session:p,SecretCode:h}=await f({region:X(i.userPoolId)},{Session:o});return Je.dispatch({type:"SET_SIGN_IN_SESSION",value:p}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:op(h,a)}}}throw new R({name:pt.SignInException,message:`Cannot initiate MFA setup from available types: ${c}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:ap(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:Ps(Os(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const o=await Jf(n);return tp(o)?o:Nt(o)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:r}}}throw new R({name:pt.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function op(e,t){return{sharedSecret:e,getSetupUri:(n,r)=>{const i=`otpauth://totp/${n}:${r??t}?secret=${e}&issuer=${n}`;return new Re(i)}}}function tn(e){if(e===kn.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===kn.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function ap(e){return e?JSON.parse(e).map(n=>n.includes(_s)?n.replace(_s,""):n):[]}function cp(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function Ps(e){if(e)return e.map(cp).filter(Boolean)}function Os(e){return e?JSON.parse(e):[]}function up(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function lp(){let e;try{e=await Kt()}catch{}if(e&&e.userId&&e.username)throw new R({name:ad,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function nn(e){return Je.getState().username??e}async function dp(e){var a;const t=(a=B.getConfig().Auth)==null?void 0:a.Cognito;M(t);const{username:n,password:r,options:i}=e,s={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},o=i==null?void 0:i.clientMetadata;z(!!n,x.EmptySignInUsername),z(!r,x.CustomAuthSignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await zn(ip,[n,o,t,me],n,me),f=nn(n);return At({signInSession:d,username:f,challengeName:c,signInDetails:s}),l?(await St({username:f,...l,NewDeviceMetadata:await Tt({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:s}),Ce(),await It(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Nt({challengeName:c,challengeParameters:u})}catch(c){Ce(),Ie(c);const u=tn(c.name);if(u)return u;throw c}}async function fp(e){var a;const{username:t,password:n,options:r}=e,i={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},s=(a=B.getConfig().Auth)==null?void 0:a.Cognito;M(s);const o=r==null?void 0:r.clientMetadata;z(!!t,x.EmptySignInUsername),z(!!n,x.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await sp(t,n,o,s,me),f=nn(t);return At({signInSession:d,username:f,challengeName:c,signInDetails:i}),l?(await St({username:f,...l,NewDeviceMetadata:await Tt({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:i}),Ce(),await It(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Nt({challengeName:c,challengeParameters:u})}catch(c){Ce(),Ie(c);const u=tn(c.name);if(u)return u;throw c}}function Ue(e=!0){Ve.dispatch({type:"RESET"})}async function ks(e){var o,a;const{username:t,password:n}=e,r=(o=B.getConfig().Auth)==null?void 0:o.Cognito,i={loginId:t,authFlowType:"USER_SRP_AUTH"};M(r);const s=(a=e.options)==null?void 0:a.clientMetadata;z(!!t,x.EmptySignInUsername),z(!!n,x.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await rp(t,n,s,r,me),f=nn(t);return At({signInSession:d,username:f,challengeName:c,signInDetails:i}),l?(await St({username:f,...l,NewDeviceMetadata:await Tt({userPoolId:r.userPoolId,userPoolEndpoint:r.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:i}),Ce(),await It(),Ue(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Nt({challengeName:c,challengeParameters:u})}catch(c){Ce(),Ue(),Ie(c);const u=tn(c.name);if(u)return u;throw c}}async function pp(e){var a;const{username:t,password:n,options:r}=e,i=(a=B.getConfig().Auth)==null?void 0:a.Cognito,s={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};M(i);const o=r==null?void 0:r.clientMetadata;z(!!t,x.EmptySignInUsername),z(!!n,x.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:l,Session:d}=await zn(np,[t,n,o,i,me],t,me),f=nn(t);return At({signInSession:d,username:f,challengeName:c,signInDetails:s}),l?(await St({...l,username:f,NewDeviceMetadata:await Tt({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:s}),Ce(),await It(),Ue(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Nt({challengeName:c,challengeParameters:u})}catch(c){Ce(),Ue(),Ie(c);const u=tn(c.name);if(u)return u;throw c}}async function hp({username:e,clientMetadata:t,config:n,tokenOrchestrator:r,preferredChallenge:i,password:s,session:o}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=n,l=ue({username:e,userPoolId:a,userPoolClientId:c}),d={USERNAME:e};if(i){if(i==="PASSWORD_SRP")return z(!!s,x.EmptySignInPassword),ya({username:e,password:s,clientMetadata:t,config:n,tokenOrchestrator:r,authFlow:"USER_AUTH",preferredChallenge:i});i==="PASSWORD"&&(z(!!s,x.EmptySignInPassword),d.PASSWORD=s),d.PREFERRED_CHALLENGE=i}const f={AuthFlow:"USER_AUTH",AuthParameters:d,ClientMetadata:t,ClientId:c,UserContextData:l};o&&(f.Session=o);const h=await vt({endpointResolver:Z({endpointOverride:u})})({region:X(a),userAgentValue:ye(se.SignIn)},f);return en(e),h}async function mp(e){var c;const{username:t,password:n,options:r}=e,i=(c=B.getConfig().Auth)==null?void 0:c.Cognito,s={loginId:t,authFlowType:"USER_AUTH"};M(i);const o=r==null?void 0:r.clientMetadata,a=r==null?void 0:r.preferredChallenge;z(!!t,x.EmptySignInUsername);try{const u={username:t,config:i,tokenOrchestrator:me,clientMetadata:o,preferredChallenge:a,password:n},l=Ve.getState();l.active&&l.username===t&&(u.session=l.session);const d=await hp(u),f=nn(t);return At({signInSession:d.Session,username:f,challengeName:d.ChallengeName,signInDetails:s}),d.AuthenticationResult?(await St({username:f,...d.AuthenticationResult,NewDeviceMetadata:await Tt({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:d.AuthenticationResult.NewDeviceMetadata,accessToken:d.AuthenticationResult.AccessToken}),signInDetails:s}),Ce(),await It(),Ue(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Nt({challengeName:d.ChallengeName,challengeParameters:d.ChallengeParameters,availableChallenges:"AvailableChallenges"in d?d.AvailableChallenges:void 0})}catch(u){Ce(),Ue(),Ie(u);const l=tn(u.name);if(l)return l;throw u}}async function gp(e){var n;Ue(!1);const t=(n=e.options)==null?void 0:n.authFlowType;switch(await lp(),t){case"USER_SRP_AUTH":return ks(e);case"USER_PASSWORD_AUTH":return pp(e);case"CUSTOM_WITHOUT_SRP":return dp(e);case"CUSTOM_WITH_SRP":return fp(e);case"USER_AUTH":return mp(e);default:return ks(e)}}const yp=3*60*1e3;function Ep(e){const t=_n.listen("auth-internal",async({payload:r})=>{switch(r.event){case"confirmSignUp":{const i=r.data;i!=null&&i.isSignUpComplete&&(_n.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),n=setTimeout(()=>{t(),clearTimeout(n),Ue()},yp)}const vp=()=>async e=>{if(e.statusCode>=300){const t=await st(e);if(Ie(t),t.name===Ar.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const n=x.EmptySignUpPassword,{message:r,recoverySuggestion:i}=sa[n];throw new R({name:n,message:r,recoverySuggestion:i})}throw new R({name:t.name,message:t.message})}return Qt(e)},Sp=e=>ge(_e,xe("SignUp"),vp(),{...Pe,...e});async function Ip(e){var T;const{username:t,password:n,options:r}=e,i=(T=B.getConfig().Auth)==null?void 0:T.Cognito,s=(i==null?void 0:i.signUpVerificationMethod)??"code",{clientMetadata:o,validationData:a,autoSignIn:c}=e.options??{};M(i),z(!!t,x.EmptySignUpUsername);const u=typeof c!="boolean"?c:void 0;u==null||u.authFlowType;const{userPoolId:l,userPoolClientId:d,userPoolEndpoint:f}=i,p=Sp({endpointResolver:Z({endpointOverride:f})}),h={Username:t,Password:void 0,UserAttributes:(r==null?void 0:r.userAttributes)&&Xi(r==null?void 0:r.userAttributes),ClientMetadata:o,ValidationData:a&&Xi(a),ClientId:d,UserContextData:ue({username:t,userPoolId:l,userPoolClientId:d})};n&&(h.Password=n);const{UserSub:m,CodeDeliveryDetails:g,UserConfirmed:E,Session:S}=await p({region:X(l),userAgentValue:ye(se.SignUp)},h);(u||c===!0)&&(Ve.dispatch({type:"START"}),Ve.dispatch({type:"SET_USERNAME",value:t}),Ve.dispatch({type:"SET_SESSION",value:S}));const A={destination:g==null?void 0:g.Destination,deliveryMedium:g==null?void 0:g.DeliveryMedium,attributeName:g==null?void 0:g.AttributeName},I=!!E,v=Ve.getState().active;if(I)return v?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:m}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:m};if(v){if(s==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:A},userId:m};Ep()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:A},userId:m}}const Ap=e=>ge(_e,xe("ForgotPassword"),Ke(),{...Pe,...e});async function wp(e){var d,f;const{username:t}=e;z(!!t,x.EmptyResetPasswordUsername);const n=(d=B.getConfig().Auth)==null?void 0:d.Cognito;M(n);const{userPoolClientId:r,userPoolId:i,userPoolEndpoint:s}=n,o=(f=e.options)==null?void 0:f.clientMetadata,a=ue({username:t,userPoolId:i,userPoolClientId:r}),l=(await Ap({endpointResolver:Z({endpointOverride:s})})({region:X(i),userAgentValue:ye(se.ResetPassword)},{Username:t,ClientMetadata:o,ClientId:r,UserContextData:a})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:l==null?void 0:l.DeliveryMedium,destination:l==null?void 0:l.Destination,attributeName:l==null?void 0:l.AttributeName}}}}const bp=e=>ge(_e,xe("ConfirmForgotPassword"),Ke(),{...Pe,...e});async function Tp(e){var d,f;const t=(d=B.getConfig().Auth)==null?void 0:d.Cognito;M(t);const{userPoolClientId:n,userPoolId:r,userPoolEndpoint:i}=t,{username:s,newPassword:o}=e;z(!!s,x.EmptyConfirmResetPasswordUsername),z(!!o,x.EmptyConfirmResetPasswordNewPassword);const a=e.confirmationCode;z(!!a,x.EmptyConfirmResetPasswordConfirmationCode);const c=(f=e.options)==null?void 0:f.clientMetadata,u=ue({username:s,userPoolId:r,userPoolClientId:n});await bp({endpointResolver:Z({endpointOverride:i})})({region:X(t.userPoolId),userAgentValue:ye(se.ConfirmResetPassword)},{Username:s,ConfirmationCode:a,Password:o,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:u})}const Np=e=>ge(_e,xe("ResendConfirmationCode"),Ke(),{...Pe,...e});async function Rp(e){var p,h;const{username:t}=e;z(!!t,x.EmptySignUpUsername);const n=(p=B.getConfig().Auth)==null?void 0:p.Cognito;M(n);const{userPoolClientId:r,userPoolId:i,userPoolEndpoint:s}=n,o=(h=e.options)==null?void 0:h.clientMetadata,a=ue({username:t,userPoolId:i,userPoolClientId:r}),c=Np({endpointResolver:Z({endpointOverride:s})}),{CodeDeliveryDetails:u}=await c({region:X(n.userPoolId),userAgentValue:ye(se.ResendSignUpCode)},{Username:t,ClientMetadata:o,ClientId:n.userPoolClientId,UserContextData:a}),{DeliveryMedium:l,AttributeName:d,Destination:f}={...u};return{destination:f,deliveryMedium:l,attributeName:d||void 0}}const Cp=e=>ge(_e,xe("ConfirmSignUp"),Ke(),{...Pe,...e});async function xp(e){var f;const{username:t,confirmationCode:n,options:r}=e,i=(f=B.getConfig().Auth)==null?void 0:f.Cognito;M(i);const{userPoolId:s,userPoolClientId:o,userPoolEndpoint:a}=i,c=r==null?void 0:r.clientMetadata;z(!!t,x.EmptyConfirmSignUpUsername),z(!!n,x.EmptyConfirmSignUpCode);const u=ue({username:t,userPoolId:s,userPoolClientId:o}),l=Cp({endpointResolver:Z({endpointOverride:a})}),{Session:d}=await l({region:X(i.userPoolId),userAgentValue:ye(se.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:c,ForceAliasCreation:r==null?void 0:r.forceAliasCreation,ClientId:i.userPoolClientId,UserContextData:u});return new Promise((p,h)=>{try{const m={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},g=Ve.getState();if(!g.active||g.username!==t){p(m),Ue();return}Ve.dispatch({type:"SET_SESSION",value:d});const E=_n.listen("auth-internal",({payload:S})=>{switch(S.event){case"autoSignIn":p({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),E()}});_n.dispatch("auth-internal",{event:"confirmSignUp",data:m})}catch(m){h(m)}})}function _p(e,t){{const n=(e==null?void 0:e.find(Pp))??(e==null?void 0:e.find(Op)),r=(e==null?void 0:e.find(Dp))??(e==null?void 0:e.find(kp));if(n)return n;throw r?hd:fd}}const Pp=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),Op=e=>e.includes(String(window.location.hostname)),kp=e=>e.startsWith("http://"),Dp=e=>e.startsWith("https://"),Lp=async e=>{window!=null&&window.location&&(window.location.href=e.replace("http://","https://"))},Mp=async e=>{await e.clearOAuthData(),me.clearTokens(),await Fo(),Ye.dispatch("auth",{event:"signedOut"},"Auth",ze)},Up=async(e,t=!1,n)=>{lo(e);const{loginWith:r,userPoolClientId:i}=e,{domain:s,redirectSignOut:o}=r.oauth,a=_p(o),c=`https://${s}/logout?${Object.entries({client_id:i,logout_uri:encodeURIComponent(a)}).map(([u,l])=>`${u}=${l}`).join("&")}`;return Lp(c)},Fp=async(e,t,n,r)=>{const{isOAuthSignIn:i}=await t.loadOAuthSignIn(),s=await n.getOAuthMetadata();if(await Mp(t),i||s!=null&&s.oauthSignIn)return Up(e,!1)},qp=e=>ge(_e,xe("RevokeToken"),Ke(),{...Pe,...e}),Kp=new Q("Auth");async function Bp(e){var r;const t=(r=B.getConfig().Auth)==null?void 0:r.Cognito;M(t),await $p(t);let n;try{lo(t),n=!0}catch{n=!1}if(n){const i=new la(Zt);i.setAuthConfig(t);const{type:s}=await Fp(t,i,me)??{};if(s==="error")throw new R({name:md,message:"An error occurred when attempting to log out from OAuth provider."})}else me.clearTokens(),await Fo(),Ye.dispatch("auth",{event:"signedOut"},"Auth",ze)}async function $p(e){try{const{userPoolEndpoint:t,userPoolId:n,userPoolClientId:r}=e,i=await me.getTokenStore().loadTokens();oa(i),Vp(i.accessToken)&&await qp({endpointResolver:Z({endpointOverride:t})})({region:X(n),userAgentValue:ye(se.SignOut)},{ClientId:r,Token:i.refreshToken})}catch{Kp.debug("Client signOut error caught but will proceed with token removal")}}const Vp=e=>{var t;return!!((t=e==null?void 0:e.payload)!=null&&t.origin_jti)},Wp={identityId:"identityId"},Hp=new Q("DefaultIdentityIdStore");class Ea{setAuthConfig(t){yn(t.Cognito),this.authConfig=t,this._authKeys=jp("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;yn((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const n=await this.keyValueStorage.getItem(this._authKeys.identityId);return n?(this._hasGuestIdentityId=!0,{id:n,type:"guest"}):null}}catch(n){return Hp.log("Error getting stored IdentityId.",n),null}}async storeIdentityId(t){var n;yn((n=this.authConfig)==null?void 0:n.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const jp=(e,t)=>Xr(Wp)(`com.amplify.${e}`,t),Tr=({endpointOverride:e})=>t=>e?{url:new Re(e)}:yl(t);function va(e){const t=tt(e).payload.iss,n={};if(!t)throw new R({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const r=t.replace(/(^\w+:|^)\/\//,"");return n[r]=e,n}async function Gp({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});const r=await n.loadIdentityId();if(r)return r.id;const i=e!=null&&e.idToken?va(e.idToken.toString()):{},s=await zp(i,t);return n.storeIdentityId({id:s,type:e?"primary":"guest"}),s}async function zp(e,t){const n=t==null?void 0:t.identityPoolId,r=Ir(n),i=hl({endpointResolver:Tr({endpointOverride:t.identityPoolEndpoint})});let s;try{s=(await i({region:r},{IdentityPoolId:n,Logins:e})).IdentityId}catch(o){throw Ie(o),new R(o)}if(!s)throw new R({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return s}const mn=new Q("CognitoCredentialsProvider"),Ds=50*60*1e3;class Sa{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){mn.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){mn.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:r}=t,{authConfig:i}=t;try{yn(i==null?void 0:i.Cognito)}catch{return}if(!n&&!i.Cognito.allowGuestAccess)return;const{forceRefresh:s}=t,o=this.hasTokenChanged(r),a=await Gp({tokens:r,authConfig:i.Cognito,identityIdStore:this._identityIdStore});return(s||o)&&this.clearCredentials(),n?(vd(r),this.credsForOIDCTokens(i.Cognito,r,a)):this.getGuestCredentials(a,i.Cognito)}async getGuestCredentials(t,n){var o,a;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return mn.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const r=Ir(n.identityPoolId),i=zi({endpointResolver:Tr({endpointOverride:n.identityPoolEndpoint})});let s;try{s=await i({region:r},{IdentityId:t})}catch(c){throw Ie(c),new R(c)}if((o=s==null?void 0:s.Credentials)!=null&&o.AccessKeyId&&((a=s==null?void 0:s.Credentials)!=null&&a.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+Ds;const c={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:t};return s.IdentityId&&(c.identityId=s.IdentityId,this._identityIdStore.storeIdentityId({id:s.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!1},c}else throw new R({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,r){var c,u,l;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return mn.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const i=n.idToken?va(n.idToken.toString()):{},s=Ir(t.identityPoolId),o=zi({endpointResolver:Tr({endpointOverride:t.identityPoolEndpoint})});let a;try{a=await o({region:s},{IdentityId:r,Logins:i})}catch(d){throw Ie(d),new R(d)}if((c=a==null?void 0:a.Credentials)!=null&&c.AccessKeyId&&((u=a==null?void 0:a.Credentials)!=null&&u.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+Ds;const d={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:r};return a.IdentityId&&(d.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...d,isAuthenticatedCreds:!0,associatedIdToken:(l=n.idToken)==null?void 0:l.toString()},d}else throw new R({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var n,r;return!!t&&!!((n=this._credentialsAndIdentityId)!=null&&n.associatedIdToken)&&((r=t.idToken)==null?void 0:r.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const Yp=new Sa(new Ea(Zt)),Jp={configure(e,t){const n=mo(e),r=new bl({sameSite:"lax"}),i=t!=null&&t.ssr?r:Zt,s=t!=null&&t.ssr?new Sa(new Ea(r)):Yp;if(!n.Auth){B.configure(n,t);return}if(t!=null&&t.Auth){B.configure(n,t);return}if(!B.libraryOptions.Auth){Ut.setAuthConfig(n.Auth),Ut.setKeyValueStorage(i),B.configure(n,{...t,Auth:{tokenProvider:Ut,credentialsProvider:s}});return}if(t){const o=B.libraryOptions.Auth;t.ssr!==void 0&&(Ut.setKeyValueStorage(i),o.credentialsProvider=s),B.configure(n,{Auth:o,...t});return}B.configure(n)},getConfig(){return B.getConfig()}};function In(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?In=function(n){return typeof n}:In=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},In(e)}function Qp(e){return In(e)=="object"&&e!==null}var Ia=typeof Symbol=="function"&&Symbol.toStringTag!=null?Symbol.toStringTag:"@@toStringTag";function Nr(e,t){for(var n=/\r\n|[\n\r]/g,r=1,i=t+1,s;(s=n.exec(e.body))&&s.index<t;)r+=1,i=t+1-(s.index+s[0].length);return{line:r,column:i}}function Xp(e){return Aa(e.source,Nr(e.source,e.start))}function Aa(e,t){var n=e.locationOffset.column-1,r=An(n)+e.body,i=t.line-1,s=e.locationOffset.line-1,o=t.line+s,a=t.line===1?n:0,c=t.column+a,u="".concat(e.name,":").concat(o,":").concat(c,`
`),l=r.split(/\r\n|[\n\r]/g),d=l[i];if(d.length>120){for(var f=Math.floor(c/80),p=c%80,h=[],m=0;m<d.length;m+=80)h.push(d.slice(m,m+80));return u+Ls([["".concat(o),h[0]]].concat(h.slice(1,f+1).map(function(g){return["",g]}),[[" ",An(p-1)+"^"],["",h[f+1]]]))}return u+Ls([["".concat(o-1),l[i-1]],["".concat(o),d],["",An(c-1)+"^"],["".concat(o+1),l[i+1]]])}function Ls(e){var t=e.filter(function(r){r[0];var i=r[1];return i!==void 0}),n=Math.max.apply(Math,t.map(function(r){var i=r[0];return i.length}));return t.map(function(r){var i=r[0],s=r[1];return Zp(n,i)+(s?" | "+s:" |")}).join(`
`)}function An(e){return Array(e+1).join(" ")}function Zp(e,t){return An(e-t.length)+t}function wn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wn=function(n){return typeof n}:wn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},wn(e)}function Ms(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function eh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ms(Object(n),!0).forEach(function(r){th(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ms(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function th(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ih(e,t,n){return t&&rh(e.prototype,t),e}function sh(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}function oh(e){var t=ba();return function(){var r=Gt(e),i;if(t){var s=Gt(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return wa(this,i)}}function wa(e,t){return t&&(wn(t)==="object"||typeof t=="function")?t:Ft(e)}function Ft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rr(e){var t=typeof Map=="function"?new Map:void 0;return Rr=function(r){if(r===null||!ah(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return bn(r,arguments,Gt(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),jt(i,r)},Rr(e)}function bn(e,t,n){return ba()?bn=Reflect.construct:bn=function(i,s,o){var a=[null];a.push.apply(a,s);var c=Function.bind.apply(i,a),u=new c;return o&&jt(u,o.prototype),u},bn.apply(null,arguments)}function ba(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ah(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function jt(e,t){return jt=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},jt(e,t)}function Gt(e){return Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Gt(e)}var Bt=function(e){sh(n,e);var t=oh(n);function n(r,i,s,o,a,c,u){var l,d,f,p;nh(this,n),p=t.call(this,r),p.name="GraphQLError",p.originalError=c??void 0,p.nodes=Us(Array.isArray(i)?i:i?[i]:void 0);for(var h=[],m=0,g=(E=p.nodes)!==null&&E!==void 0?E:[];m<g.length;m++){var E,S=g[m],A=S.loc;A!=null&&h.push(A)}h=Us(h),p.source=s??((l=h)===null||l===void 0?void 0:l[0].source),p.positions=o??((d=h)===null||d===void 0?void 0:d.map(function(v){return v.start})),p.locations=o&&s?o.map(function(v){return Nr(s,v)}):(f=h)===null||f===void 0?void 0:f.map(function(v){return Nr(v.source,v.start)}),p.path=a??void 0;var I=c==null?void 0:c.extensions;return u==null&&Qp(I)?p.extensions=eh({},I):p.extensions=u??{},Object.defineProperties(Ft(p),{message:{enumerable:!0},locations:{enumerable:p.locations!=null},path:{enumerable:p.path!=null},extensions:{enumerable:p.extensions!=null&&Object.keys(p.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),c!=null&&c.stack?(Object.defineProperty(Ft(p),"stack",{value:c.stack,writable:!0,configurable:!0}),wa(p)):(Error.captureStackTrace?Error.captureStackTrace(Ft(p),n):Object.defineProperty(Ft(p),"stack",{value:Error().stack,writable:!0,configurable:!0}),p)}return ih(n,[{key:"toString",value:function(){return ch(this)}},{key:Ia,get:function(){return"Object"}}]),n}(Rr(Error));function Us(e){return e===void 0||e.length===0?void 0:e}function ch(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var i=r[n];i.loc&&(t+=`

`+Xp(i.loc))}else if(e.source&&e.locations)for(var s=0,o=e.locations;s<o.length;s++){var a=o[s];t+=`

`+Aa(e.source,a)}return t}function ce(e,t,n){return new Bt("Syntax Error: ".concat(n),void 0,e,[t])}var N=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});function uh(e,t){var n=!!e;if(!n)throw new Error("Unexpected invariant triggered.")}var Cr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):void 0;function Ta(e){var t=e.prototype.toJSON;typeof t=="function"||uh(0),e.prototype.inspect=t,Cr&&(e.prototype[Cr]=t)}var Na=function(){function e(n,r,i){this.start=n.start,this.end=r.end,this.startToken=n,this.endToken=r,this.source=i}var t=e.prototype;return t.toJSON=function(){return{start:this.start,end:this.end}},e}();Ta(Na);var W=function(){function e(n,r,i,s,o,a,c){this.kind=n,this.start=r,this.end=i,this.line=s,this.column=o,this.value=c,this.prev=a,this.next=null}var t=e.prototype;return t.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();Ta(W);function Fs(e){return e!=null&&typeof e.kind=="string"}var y=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function Tn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Tn=function(n){return typeof n}:Tn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Tn(e)}var lh=10,Ra=2;function Ca(e){return Yn(e,[])}function Yn(e,t){switch(Tn(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return e===null?"null":dh(e,t);default:return String(e)}}function dh(e,t){if(t.indexOf(e)!==-1)return"[Circular]";var n=[].concat(t,[e]),r=hh(e);if(r!==void 0){var i=r.call(e);if(i!==e)return typeof i=="string"?i:Yn(i,n)}else if(Array.isArray(e))return ph(e,n);return fh(e,n)}function fh(e,t){var n=Object.keys(e);if(n.length===0)return"{}";if(t.length>Ra)return"["+mh(e)+"]";var r=n.map(function(i){var s=Yn(e[i],t);return i+": "+s});return"{ "+r.join(", ")+" }"}function ph(e,t){if(e.length===0)return"[]";if(t.length>Ra)return"[Array]";for(var n=Math.min(lh,e.length),r=e.length-n,i=[],s=0;s<n;++s)i.push(Yn(e[s],t));return r===1?i.push("... 1 more item"):r>1&&i.push("... ".concat(r," more items")),"["+i.join(", ")+"]"}function hh(e){var t=e[String(Cr)];if(typeof t=="function")return t;if(typeof e.inspect=="function")return e.inspect}function mh(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if(t==="Object"&&typeof e.constructor=="function"){var n=e.constructor.name;if(typeof n=="string"&&n!=="")return n}return t}function ar(e,t){var n=!!e;if(!n)throw new Error(t)}const gh=function(t,n){return t instanceof n};function yh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eh(e,t,n){return t&&yh(e.prototype,t),e}var xa=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"GraphQL request",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{line:1,column:1};typeof t=="string"||ar(0,"Body must be a string. Received: ".concat(Ca(t),".")),this.body=t,this.name=n,this.locationOffset=r,this.locationOffset.line>0||ar(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||ar(0,"column in locationOffset is 1-indexed and must be positive.")}return Eh(e,[{key:Ia,get:function(){return"Source"}}]),e}();function vh(e){return gh(e,xa)}var Sh=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function Ih(e){var t=e.split(/\r\n|[\n\r]/g),n=Ah(e);if(n!==0)for(var r=1;r<t.length;r++)t[r]=t[r].slice(n);for(var i=0;i<t.length&&qs(t[i]);)++i;for(var s=t.length;s>i&&qs(t[s-1]);)--s;return t.slice(i,s).join(`
`)}function qs(e){for(var t=0;t<e.length;++t)if(e[t]!==" "&&e[t]!=="	")return!1;return!0}function Ah(e){for(var t,n=!0,r=!0,i=0,s=null,o=0;o<e.length;++o)switch(e.charCodeAt(o)){case 13:e.charCodeAt(o+1)===10&&++o;case 10:n=!1,r=!0,i=0;break;case 9:case 32:++i;break;default:r&&!n&&(s===null||i<s)&&(s=i),r=!1}return(t=s)!==null&&t!==void 0?t:0}function wh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=e.indexOf(`
`)===-1,i=e[0]===" "||e[0]==="	",s=e[e.length-1]==='"',o=e[e.length-1]==="\\",a=!r||s||o||n,c="";return a&&!(r&&i)&&(c+=`
`+t),c+=t?e.replace(/\n/g,`
`+t):e,a&&(c+=`
`),'"""'+c.replace(/"""/g,'\\"""')+'"""'}var bh=function(){function e(n){var r=new W(y.SOF,0,0,0,0,null);this.source=n,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){this.lastToken=this.token;var r=this.token=this.lookahead();return r},t.lookahead=function(){var r=this.token;if(r.kind!==y.EOF)do{var i;r=(i=r.next)!==null&&i!==void 0?i:r.next=Nh(this,r)}while(r.kind===y.COMMENT);return r},e}();function Th(e){return e===y.BANG||e===y.DOLLAR||e===y.AMP||e===y.PAREN_L||e===y.PAREN_R||e===y.SPREAD||e===y.COLON||e===y.EQUALS||e===y.AT||e===y.BRACKET_L||e===y.BRACKET_R||e===y.BRACE_L||e===y.PIPE||e===y.BRACE_R}function nt(e){return isNaN(e)?y.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function Nh(e,t){for(var n=e.source,r=n.body,i=r.length,s=t.end;s<i;){var o=r.charCodeAt(s),a=e.line,c=1+s-e.lineStart;switch(o){case 65279:case 9:case 32:case 44:++s;continue;case 10:++s,++e.line,e.lineStart=s;continue;case 13:r.charCodeAt(s+1)===10?s+=2:++s,++e.line,e.lineStart=s;continue;case 33:return new W(y.BANG,s,s+1,a,c,t);case 35:return Ch(n,s,a,c,t);case 36:return new W(y.DOLLAR,s,s+1,a,c,t);case 38:return new W(y.AMP,s,s+1,a,c,t);case 40:return new W(y.PAREN_L,s,s+1,a,c,t);case 41:return new W(y.PAREN_R,s,s+1,a,c,t);case 46:if(r.charCodeAt(s+1)===46&&r.charCodeAt(s+2)===46)return new W(y.SPREAD,s,s+3,a,c,t);break;case 58:return new W(y.COLON,s,s+1,a,c,t);case 61:return new W(y.EQUALS,s,s+1,a,c,t);case 64:return new W(y.AT,s,s+1,a,c,t);case 91:return new W(y.BRACKET_L,s,s+1,a,c,t);case 93:return new W(y.BRACKET_R,s,s+1,a,c,t);case 123:return new W(y.BRACE_L,s,s+1,a,c,t);case 124:return new W(y.PIPE,s,s+1,a,c,t);case 125:return new W(y.BRACE_R,s,s+1,a,c,t);case 34:return r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34?Ph(n,s,a,c,t,e):_h(n,s,a,c,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return xh(n,s,o,a,c,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return kh(n,s,a,c,t)}throw ce(n,s,Rh(o))}var u=e.line,l=1+s-e.lineStart;return new W(y.EOF,i,i,u,l,t)}function Rh(e){return e<32&&e!==9&&e!==10&&e!==13?"Cannot contain the invalid character ".concat(nt(e),"."):e===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:"Cannot parse the unexpected character ".concat(nt(e),".")}function Ch(e,t,n,r,i){var s=e.body,o,a=t;do o=s.charCodeAt(++a);while(!isNaN(o)&&(o>31||o===9));return new W(y.COMMENT,t,a,n,r,i,s.slice(t+1,a))}function xh(e,t,n,r,i,s){var o=e.body,a=n,c=t,u=!1;if(a===45&&(a=o.charCodeAt(++c)),a===48){if(a=o.charCodeAt(++c),a>=48&&a<=57)throw ce(e,c,"Invalid number, unexpected digit after 0: ".concat(nt(a),"."))}else c=cr(e,c,a),a=o.charCodeAt(c);if(a===46&&(u=!0,a=o.charCodeAt(++c),c=cr(e,c,a),a=o.charCodeAt(c)),(a===69||a===101)&&(u=!0,a=o.charCodeAt(++c),(a===43||a===45)&&(a=o.charCodeAt(++c)),c=cr(e,c,a),a=o.charCodeAt(c)),a===46||Dh(a))throw ce(e,c,"Invalid number, expected digit but got: ".concat(nt(a),"."));return new W(u?y.FLOAT:y.INT,t,c,r,i,s,o.slice(t,c))}function cr(e,t,n){var r=e.body,i=t,s=n;if(s>=48&&s<=57){do s=r.charCodeAt(++i);while(s>=48&&s<=57);return i}throw ce(e,i,"Invalid number, expected digit but got: ".concat(nt(s),"."))}function _h(e,t,n,r,i){for(var s=e.body,o=t+1,a=o,c=0,u="";o<s.length&&!isNaN(c=s.charCodeAt(o))&&c!==10&&c!==13;){if(c===34)return u+=s.slice(a,o),new W(y.STRING,t,o+1,n,r,i,u);if(c<32&&c!==9)throw ce(e,o,"Invalid character within String: ".concat(nt(c),"."));if(++o,c===92){switch(u+=s.slice(a,o-1),c=s.charCodeAt(o),c){case 34:u+='"';break;case 47:u+="/";break;case 92:u+="\\";break;case 98:u+="\b";break;case 102:u+="\f";break;case 110:u+=`
`;break;case 114:u+="\r";break;case 116:u+="	";break;case 117:{var l=Oh(s.charCodeAt(o+1),s.charCodeAt(o+2),s.charCodeAt(o+3),s.charCodeAt(o+4));if(l<0){var d=s.slice(o+1,o+5);throw ce(e,o,"Invalid character escape sequence: \\u".concat(d,"."))}u+=String.fromCharCode(l),o+=4;break}default:throw ce(e,o,"Invalid character escape sequence: \\".concat(String.fromCharCode(c),"."))}++o,a=o}}throw ce(e,o,"Unterminated string.")}function Ph(e,t,n,r,i,s){for(var o=e.body,a=t+3,c=a,u=0,l="";a<o.length&&!isNaN(u=o.charCodeAt(a));){if(u===34&&o.charCodeAt(a+1)===34&&o.charCodeAt(a+2)===34)return l+=o.slice(c,a),new W(y.BLOCK_STRING,t,a+3,n,r,i,Ih(l));if(u<32&&u!==9&&u!==10&&u!==13)throw ce(e,a,"Invalid character within String: ".concat(nt(u),"."));u===10?(++a,++s.line,s.lineStart=a):u===13?(o.charCodeAt(a+1)===10?a+=2:++a,++s.line,s.lineStart=a):u===92&&o.charCodeAt(a+1)===34&&o.charCodeAt(a+2)===34&&o.charCodeAt(a+3)===34?(l+=o.slice(c,a)+'"""',a+=4,c=a):++a}throw ce(e,a,"Unterminated string.")}function Oh(e,t,n,r){return gn(e)<<12|gn(t)<<8|gn(n)<<4|gn(r)}function gn(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function kh(e,t,n,r,i){for(var s=e.body,o=s.length,a=t+1,c=0;a!==o&&!isNaN(c=s.charCodeAt(a))&&(c===95||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122);)++a;return new W(y.NAME,t,a,n,r,i,s.slice(t,a))}function Dh(e){return e===95||e>=65&&e<=90||e>=97&&e<=122}function ur(e,t){var n=new Lh(e,t);return n.parseDocument()}var Lh=function(){function e(n,r){var i=vh(n)?n:new xa(n);this._lexer=new bh(i),this._options=r}var t=e.prototype;return t.parseName=function(){var r=this.expectToken(y.NAME);return{kind:N.NAME,value:r.value,loc:this.loc(r)}},t.parseDocument=function(){var r=this._lexer.token;return{kind:N.DOCUMENT,definitions:this.many(y.SOF,this.parseDefinition,y.EOF),loc:this.loc(r)}},t.parseDefinition=function(){if(this.peek(y.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(y.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var r=this._lexer.token;if(this.peek(y.BRACE_L))return{kind:N.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(r)};var i=this.parseOperationType(),s;return this.peek(y.NAME)&&(s=this.parseName()),{kind:N.OPERATION_DEFINITION,operation:i,name:s,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(r)}},t.parseOperationType=function(){var r=this.expectToken(y.NAME);switch(r.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(r)},t.parseVariableDefinitions=function(){return this.optionalMany(y.PAREN_L,this.parseVariableDefinition,y.PAREN_R)},t.parseVariableDefinition=function(){var r=this._lexer.token;return{kind:N.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(y.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(y.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(r)}},t.parseVariable=function(){var r=this._lexer.token;return this.expectToken(y.DOLLAR),{kind:N.VARIABLE,name:this.parseName(),loc:this.loc(r)}},t.parseSelectionSet=function(){var r=this._lexer.token;return{kind:N.SELECTION_SET,selections:this.many(y.BRACE_L,this.parseSelection,y.BRACE_R),loc:this.loc(r)}},t.parseSelection=function(){return this.peek(y.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var r=this._lexer.token,i=this.parseName(),s,o;return this.expectOptionalToken(y.COLON)?(s=i,o=this.parseName()):o=i,{kind:N.FIELD,alias:s,name:o,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(y.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(r)}},t.parseArguments=function(r){var i=r?this.parseConstArgument:this.parseArgument;return this.optionalMany(y.PAREN_L,i,y.PAREN_R)},t.parseArgument=function(){var r=this._lexer.token,i=this.parseName();return this.expectToken(y.COLON),{kind:N.ARGUMENT,name:i,value:this.parseValueLiteral(!1),loc:this.loc(r)}},t.parseConstArgument=function(){var r=this._lexer.token;return{kind:N.ARGUMENT,name:this.parseName(),value:(this.expectToken(y.COLON),this.parseValueLiteral(!0)),loc:this.loc(r)}},t.parseFragment=function(){var r=this._lexer.token;this.expectToken(y.SPREAD);var i=this.expectOptionalKeyword("on");return!i&&this.peek(y.NAME)?{kind:N.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(r)}:{kind:N.INLINE_FRAGMENT,typeCondition:i?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(r)}},t.parseFragmentDefinition=function(){var r,i=this._lexer.token;return this.expectKeyword("fragment"),((r=this._options)===null||r===void 0?void 0:r.experimentalFragmentVariables)===!0?{kind:N.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(i)}:{kind:N.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(i)}},t.parseFragmentName=function(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(r){var i=this._lexer.token;switch(i.kind){case y.BRACKET_L:return this.parseList(r);case y.BRACE_L:return this.parseObject(r);case y.INT:return this._lexer.advance(),{kind:N.INT,value:i.value,loc:this.loc(i)};case y.FLOAT:return this._lexer.advance(),{kind:N.FLOAT,value:i.value,loc:this.loc(i)};case y.STRING:case y.BLOCK_STRING:return this.parseStringLiteral();case y.NAME:switch(this._lexer.advance(),i.value){case"true":return{kind:N.BOOLEAN,value:!0,loc:this.loc(i)};case"false":return{kind:N.BOOLEAN,value:!1,loc:this.loc(i)};case"null":return{kind:N.NULL,loc:this.loc(i)};default:return{kind:N.ENUM,value:i.value,loc:this.loc(i)}}case y.DOLLAR:if(!r)return this.parseVariable();break}throw this.unexpected()},t.parseStringLiteral=function(){var r=this._lexer.token;return this._lexer.advance(),{kind:N.STRING,value:r.value,block:r.kind===y.BLOCK_STRING,loc:this.loc(r)}},t.parseList=function(r){var i=this,s=this._lexer.token,o=function(){return i.parseValueLiteral(r)};return{kind:N.LIST,values:this.any(y.BRACKET_L,o,y.BRACKET_R),loc:this.loc(s)}},t.parseObject=function(r){var i=this,s=this._lexer.token,o=function(){return i.parseObjectField(r)};return{kind:N.OBJECT,fields:this.any(y.BRACE_L,o,y.BRACE_R),loc:this.loc(s)}},t.parseObjectField=function(r){var i=this._lexer.token,s=this.parseName();return this.expectToken(y.COLON),{kind:N.OBJECT_FIELD,name:s,value:this.parseValueLiteral(r),loc:this.loc(i)}},t.parseDirectives=function(r){for(var i=[];this.peek(y.AT);)i.push(this.parseDirective(r));return i},t.parseDirective=function(r){var i=this._lexer.token;return this.expectToken(y.AT),{kind:N.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(r),loc:this.loc(i)}},t.parseTypeReference=function(){var r=this._lexer.token,i;return this.expectOptionalToken(y.BRACKET_L)?(i=this.parseTypeReference(),this.expectToken(y.BRACKET_R),i={kind:N.LIST_TYPE,type:i,loc:this.loc(r)}):i=this.parseNamedType(),this.expectOptionalToken(y.BANG)?{kind:N.NON_NULL_TYPE,type:i,loc:this.loc(r)}:i},t.parseNamedType=function(){var r=this._lexer.token;return{kind:N.NAMED_TYPE,name:this.parseName(),loc:this.loc(r)}},t.parseTypeSystemDefinition=function(){var r=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(r.kind===y.NAME)switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(r)},t.peekDescription=function(){return this.peek(y.STRING)||this.peek(y.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("schema");var s=this.parseDirectives(!0),o=this.many(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);return{kind:N.SCHEMA_DEFINITION,description:i,directives:s,operationTypes:o,loc:this.loc(r)}},t.parseOperationTypeDefinition=function(){var r=this._lexer.token,i=this.parseOperationType();this.expectToken(y.COLON);var s=this.parseNamedType();return{kind:N.OPERATION_TYPE_DEFINITION,operation:i,type:s,loc:this.loc(r)}},t.parseScalarTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("scalar");var s=this.parseName(),o=this.parseDirectives(!0);return{kind:N.SCALAR_TYPE_DEFINITION,description:i,name:s,directives:o,loc:this.loc(r)}},t.parseObjectTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("type");var s=this.parseName(),o=this.parseImplementsInterfaces(),a=this.parseDirectives(!0),c=this.parseFieldsDefinition();return{kind:N.OBJECT_TYPE_DEFINITION,description:i,name:s,interfaces:o,directives:a,fields:c,loc:this.loc(r)}},t.parseImplementsInterfaces=function(){var r;if(!this.expectOptionalKeyword("implements"))return[];if(((r=this._options)===null||r===void 0?void 0:r.allowLegacySDLImplementsInterfaces)===!0){var i=[];this.expectOptionalToken(y.AMP);do i.push(this.parseNamedType());while(this.expectOptionalToken(y.AMP)||this.peek(y.NAME));return i}return this.delimitedMany(y.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var r;return((r=this._options)===null||r===void 0?void 0:r.allowLegacySDLEmptyFields)===!0&&this.peek(y.BRACE_L)&&this._lexer.lookahead().kind===y.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(y.BRACE_L,this.parseFieldDefinition,y.BRACE_R)},t.parseFieldDefinition=function(){var r=this._lexer.token,i=this.parseDescription(),s=this.parseName(),o=this.parseArgumentDefs();this.expectToken(y.COLON);var a=this.parseTypeReference(),c=this.parseDirectives(!0);return{kind:N.FIELD_DEFINITION,description:i,name:s,arguments:o,type:a,directives:c,loc:this.loc(r)}},t.parseArgumentDefs=function(){return this.optionalMany(y.PAREN_L,this.parseInputValueDef,y.PAREN_R)},t.parseInputValueDef=function(){var r=this._lexer.token,i=this.parseDescription(),s=this.parseName();this.expectToken(y.COLON);var o=this.parseTypeReference(),a;this.expectOptionalToken(y.EQUALS)&&(a=this.parseValueLiteral(!0));var c=this.parseDirectives(!0);return{kind:N.INPUT_VALUE_DEFINITION,description:i,name:s,type:o,defaultValue:a,directives:c,loc:this.loc(r)}},t.parseInterfaceTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("interface");var s=this.parseName(),o=this.parseImplementsInterfaces(),a=this.parseDirectives(!0),c=this.parseFieldsDefinition();return{kind:N.INTERFACE_TYPE_DEFINITION,description:i,name:s,interfaces:o,directives:a,fields:c,loc:this.loc(r)}},t.parseUnionTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("union");var s=this.parseName(),o=this.parseDirectives(!0),a=this.parseUnionMemberTypes();return{kind:N.UNION_TYPE_DEFINITION,description:i,name:s,directives:o,types:a,loc:this.loc(r)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(y.EQUALS)?this.delimitedMany(y.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("enum");var s=this.parseName(),o=this.parseDirectives(!0),a=this.parseEnumValuesDefinition();return{kind:N.ENUM_TYPE_DEFINITION,description:i,name:s,directives:o,values:a,loc:this.loc(r)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(y.BRACE_L,this.parseEnumValueDefinition,y.BRACE_R)},t.parseEnumValueDefinition=function(){var r=this._lexer.token,i=this.parseDescription(),s=this.parseName(),o=this.parseDirectives(!0);return{kind:N.ENUM_VALUE_DEFINITION,description:i,name:s,directives:o,loc:this.loc(r)}},t.parseInputObjectTypeDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("input");var s=this.parseName(),o=this.parseDirectives(!0),a=this.parseInputFieldsDefinition();return{kind:N.INPUT_OBJECT_TYPE_DEFINITION,description:i,name:s,directives:o,fields:a,loc:this.loc(r)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(y.BRACE_L,this.parseInputValueDef,y.BRACE_R)},t.parseTypeSystemExtension=function(){var r=this._lexer.lookahead();if(r.kind===y.NAME)switch(r.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(r)},t.parseSchemaExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var i=this.parseDirectives(!0),s=this.optionalMany(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);if(i.length===0&&s.length===0)throw this.unexpected();return{kind:N.SCHEMA_EXTENSION,directives:i,operationTypes:s,loc:this.loc(r)}},t.parseScalarTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var i=this.parseName(),s=this.parseDirectives(!0);if(s.length===0)throw this.unexpected();return{kind:N.SCALAR_TYPE_EXTENSION,name:i,directives:s,loc:this.loc(r)}},t.parseObjectTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var i=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),a=this.parseFieldsDefinition();if(s.length===0&&o.length===0&&a.length===0)throw this.unexpected();return{kind:N.OBJECT_TYPE_EXTENSION,name:i,interfaces:s,directives:o,fields:a,loc:this.loc(r)}},t.parseInterfaceTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var i=this.parseName(),s=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),a=this.parseFieldsDefinition();if(s.length===0&&o.length===0&&a.length===0)throw this.unexpected();return{kind:N.INTERFACE_TYPE_EXTENSION,name:i,interfaces:s,directives:o,fields:a,loc:this.loc(r)}},t.parseUnionTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var i=this.parseName(),s=this.parseDirectives(!0),o=this.parseUnionMemberTypes();if(s.length===0&&o.length===0)throw this.unexpected();return{kind:N.UNION_TYPE_EXTENSION,name:i,directives:s,types:o,loc:this.loc(r)}},t.parseEnumTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var i=this.parseName(),s=this.parseDirectives(!0),o=this.parseEnumValuesDefinition();if(s.length===0&&o.length===0)throw this.unexpected();return{kind:N.ENUM_TYPE_EXTENSION,name:i,directives:s,values:o,loc:this.loc(r)}},t.parseInputObjectTypeExtension=function(){var r=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var i=this.parseName(),s=this.parseDirectives(!0),o=this.parseInputFieldsDefinition();if(s.length===0&&o.length===0)throw this.unexpected();return{kind:N.INPUT_OBJECT_TYPE_EXTENSION,name:i,directives:s,fields:o,loc:this.loc(r)}},t.parseDirectiveDefinition=function(){var r=this._lexer.token,i=this.parseDescription();this.expectKeyword("directive"),this.expectToken(y.AT);var s=this.parseName(),o=this.parseArgumentDefs(),a=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var c=this.parseDirectiveLocations();return{kind:N.DIRECTIVE_DEFINITION,description:i,name:s,arguments:o,repeatable:a,locations:c,loc:this.loc(r)}},t.parseDirectiveLocations=function(){return this.delimitedMany(y.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var r=this._lexer.token,i=this.parseName();if(Sh[i.value]!==void 0)return i;throw this.unexpected(r)},t.loc=function(r){var i;if(((i=this._options)===null||i===void 0?void 0:i.noLocation)!==!0)return new Na(r,this._lexer.lastToken,this._lexer.source)},t.peek=function(r){return this._lexer.token.kind===r},t.expectToken=function(r){var i=this._lexer.token;if(i.kind===r)return this._lexer.advance(),i;throw ce(this._lexer.source,i.start,"Expected ".concat(_a(r),", found ").concat(lr(i),"."))},t.expectOptionalToken=function(r){var i=this._lexer.token;if(i.kind===r)return this._lexer.advance(),i},t.expectKeyword=function(r){var i=this._lexer.token;if(i.kind===y.NAME&&i.value===r)this._lexer.advance();else throw ce(this._lexer.source,i.start,'Expected "'.concat(r,'", found ').concat(lr(i),"."))},t.expectOptionalKeyword=function(r){var i=this._lexer.token;return i.kind===y.NAME&&i.value===r?(this._lexer.advance(),!0):!1},t.unexpected=function(r){var i=r??this._lexer.token;return ce(this._lexer.source,i.start,"Unexpected ".concat(lr(i),"."))},t.any=function(r,i,s){this.expectToken(r);for(var o=[];!this.expectOptionalToken(s);)o.push(i.call(this));return o},t.optionalMany=function(r,i,s){if(this.expectOptionalToken(r)){var o=[];do o.push(i.call(this));while(!this.expectOptionalToken(s));return o}return[]},t.many=function(r,i,s){this.expectToken(r);var o=[];do o.push(i.call(this));while(!this.expectOptionalToken(s));return o},t.delimitedMany=function(r,i){this.expectOptionalToken(r);var s=[];do s.push(i.call(this));while(this.expectOptionalToken(r));return s},e}();function lr(e){var t=e.value;return _a(e.kind)+(t!=null?' "'.concat(t,'"'):"")}function _a(e){return Th(e)?'"'.concat(e,'"'):e}var Mh={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Uh=Object.freeze({});function Fh(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mh,r=void 0,i=Array.isArray(e),s=[e],o=-1,a=[],c=void 0,u=void 0,l=void 0,d=[],f=[],p=e;do{o++;var h=o===s.length,m=h&&a.length!==0;if(h){if(u=f.length===0?void 0:d[d.length-1],c=l,l=f.pop(),m){if(i)c=c.slice();else{for(var g={},E=0,S=Object.keys(c);E<S.length;E++){var A=S[E];g[A]=c[A]}c=g}for(var I=0,v=0;v<a.length;v++){var T=a[v][0],P=a[v][1];i&&(T-=I),i&&P===null?(c.splice(T,1),I++):c[T]=P}}o=r.index,s=r.keys,a=r.edits,i=r.inArray,r=r.prev}else{if(u=l?i?o:s[o]:void 0,c=l?l[u]:p,c==null)continue;l&&d.push(u)}var k=void 0;if(!Array.isArray(c)){if(!Fs(c))throw new Error("Invalid AST Node: ".concat(Ca(c),"."));var D=qh(t,c.kind,h);if(D){if(k=D.call(t,c,u,l,d,f),k===Uh)break;if(k===!1){if(!h){d.pop();continue}}else if(k!==void 0&&(a.push([u,k]),!h))if(Fs(k))c=k;else{d.pop();continue}}}if(k===void 0&&m&&a.push([u,c]),h)d.pop();else{var q;r={inArray:i,index:o,keys:s,edits:a,prev:r},i=Array.isArray(c),s=i?c:(q=n[c.kind])!==null&&q!==void 0?q:[],o=-1,a=[],l&&f.push(l),l=c}}while(r!==void 0);return a.length!==0&&(p=a[a.length-1][1]),p}function qh(e,t,n){var r=e[t];if(r){if(!n&&typeof r=="function")return r;var i=n?r.leave:r.enter;if(typeof i=="function")return i}else{var s=n?e.leave:e.enter;if(s){if(typeof s=="function")return s;var o=s[t];if(typeof o=="function")return o}}}function kt(e){return Fh(e,{leave:Bh})}var Kh=80,Bh={Name:function(t){return t.value},Variable:function(t){return"$"+t.name},Document:function(t){return b(t.definitions,`

`)+`
`},OperationDefinition:function(t){var n=t.operation,r=t.name,i=$("(",b(t.variableDefinitions,", "),")"),s=b(t.directives," "),o=t.selectionSet;return!r&&!s&&!i&&n==="query"?o:b([n,b([r,i]),s,o]," ")},VariableDefinition:function(t){var n=t.variable,r=t.type,i=t.defaultValue,s=t.directives;return n+": "+r+$(" = ",i)+$(" ",b(s," "))},SelectionSet:function(t){var n=t.selections;return ve(n)},Field:function(t){var n=t.alias,r=t.name,i=t.arguments,s=t.directives,o=t.selectionSet,a=$("",n,": ")+r,c=a+$("(",b(i,", "),")");return c.length>Kh&&(c=a+$(`(
`,Nn(b(i,`
`)),`
)`)),b([c,b(s," "),o]," ")},Argument:function(t){var n=t.name,r=t.value;return n+": "+r},FragmentSpread:function(t){var n=t.name,r=t.directives;return"..."+n+$(" ",b(r," "))},InlineFragment:function(t){var n=t.typeCondition,r=t.directives,i=t.selectionSet;return b(["...",$("on ",n),b(r," "),i]," ")},FragmentDefinition:function(t){var n=t.name,r=t.typeCondition,i=t.variableDefinitions,s=t.directives,o=t.selectionSet;return"fragment ".concat(n).concat($("(",b(i,", "),")")," ")+"on ".concat(r," ").concat($("",b(s," ")," "))+o},IntValue:function(t){var n=t.value;return n},FloatValue:function(t){var n=t.value;return n},StringValue:function(t,n){var r=t.value,i=t.block;return i?wh(r,n==="description"?"":"  "):JSON.stringify(r)},BooleanValue:function(t){var n=t.value;return n?"true":"false"},NullValue:function(){return"null"},EnumValue:function(t){var n=t.value;return n},ListValue:function(t){var n=t.values;return"["+b(n,", ")+"]"},ObjectValue:function(t){var n=t.fields;return"{"+b(n,", ")+"}"},ObjectField:function(t){var n=t.name,r=t.value;return n+": "+r},Directive:function(t){var n=t.name,r=t.arguments;return"@"+n+$("(",b(r,", "),")")},NamedType:function(t){var n=t.name;return n},ListType:function(t){var n=t.type;return"["+n+"]"},NonNullType:function(t){var n=t.type;return n+"!"},SchemaDefinition:Ee(function(e){var t=e.directives,n=e.operationTypes;return b(["schema",b(t," "),ve(n)]," ")}),OperationTypeDefinition:function(t){var n=t.operation,r=t.type;return n+": "+r},ScalarTypeDefinition:Ee(function(e){var t=e.name,n=e.directives;return b(["scalar",t,b(n," ")]," ")}),ObjectTypeDefinition:Ee(function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return b(["type",t,$("implements ",b(n," & ")),b(r," "),ve(i)]," ")}),FieldDefinition:Ee(function(e){var t=e.name,n=e.arguments,r=e.type,i=e.directives;return t+(Ks(n)?$(`(
`,Nn(b(n,`
`)),`
)`):$("(",b(n,", "),")"))+": "+r+$(" ",b(i," "))}),InputValueDefinition:Ee(function(e){var t=e.name,n=e.type,r=e.defaultValue,i=e.directives;return b([t+": "+n,$("= ",r),b(i," ")]," ")}),InterfaceTypeDefinition:Ee(function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return b(["interface",t,$("implements ",b(n," & ")),b(r," "),ve(i)]," ")}),UnionTypeDefinition:Ee(function(e){var t=e.name,n=e.directives,r=e.types;return b(["union",t,b(n," "),r&&r.length!==0?"= "+b(r," | "):""]," ")}),EnumTypeDefinition:Ee(function(e){var t=e.name,n=e.directives,r=e.values;return b(["enum",t,b(n," "),ve(r)]," ")}),EnumValueDefinition:Ee(function(e){var t=e.name,n=e.directives;return b([t,b(n," ")]," ")}),InputObjectTypeDefinition:Ee(function(e){var t=e.name,n=e.directives,r=e.fields;return b(["input",t,b(n," "),ve(r)]," ")}),DirectiveDefinition:Ee(function(e){var t=e.name,n=e.arguments,r=e.repeatable,i=e.locations;return"directive @"+t+(Ks(n)?$(`(
`,Nn(b(n,`
`)),`
)`):$("(",b(n,", "),")"))+(r?" repeatable":"")+" on "+b(i," | ")}),SchemaExtension:function(t){var n=t.directives,r=t.operationTypes;return b(["extend schema",b(n," "),ve(r)]," ")},ScalarTypeExtension:function(t){var n=t.name,r=t.directives;return b(["extend scalar",n,b(r," ")]," ")},ObjectTypeExtension:function(t){var n=t.name,r=t.interfaces,i=t.directives,s=t.fields;return b(["extend type",n,$("implements ",b(r," & ")),b(i," "),ve(s)]," ")},InterfaceTypeExtension:function(t){var n=t.name,r=t.interfaces,i=t.directives,s=t.fields;return b(["extend interface",n,$("implements ",b(r," & ")),b(i," "),ve(s)]," ")},UnionTypeExtension:function(t){var n=t.name,r=t.directives,i=t.types;return b(["extend union",n,b(r," "),i&&i.length!==0?"= "+b(i," | "):""]," ")},EnumTypeExtension:function(t){var n=t.name,r=t.directives,i=t.values;return b(["extend enum",n,b(r," "),ve(i)]," ")},InputObjectTypeExtension:function(t){var n=t.name,r=t.directives,i=t.fields;return b(["extend input",n,b(r," "),ve(i)]," ")}};function Ee(e){return function(t){return b([t.description,e(t)],`
`)}}function b(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(t=e==null?void 0:e.filter(function(r){return r}).join(n))!==null&&t!==void 0?t:""}function ve(e){return $(`{
`,Nn(b(e,`
`)),`
}`)}function $(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return t!=null&&t!==""?e+t+n:""}function Nn(e){return $("  ",e.replace(/\n/g,`
  `))}function $h(e){return e.indexOf(`
`)!==-1}function Ks(e){return e!=null&&e.some($h)}class zt extends On{constructor(t){super(t),this.constructor=zt,Object.setPrototypeOf(this,zt.prototype)}}class Yt extends zt{constructor(t={}){super({name:"CanceledError",message:"Request is canceled by user",...t}),this.constructor=Yt,Object.setPrototypeOf(this,Yt.prototype)}}const Vh=e=>!!e&&e instanceof Yt;var xr;(function(e){e.InvalidApiName="InvalidApiName"})(xr||(xr={}));xr.InvalidApiName+"";const Pa=async e=>{var n;if(!e)return;const t=await st(Wh(e));if(t){const r=await((n=e.body)==null?void 0:n.text());return Hh(t,{statusCode:e.statusCode,headers:e.headers,body:r})}},Wh=e=>{let t;const n=new Proxy(e.body,{get(i,s,o){return s==="json"?async()=>{t||(t=i.text());try{return JSON.parse(await t)}catch{return{}}}:s==="text"?async()=>(t||(t=i.text()),t):Reflect.get(i,s,o)}});return new Proxy(e,{get(i,s,o){return s==="body"?n:Reflect.get(i,s,o)}})},Hh=(e,t)=>{const n=new zt({name:e==null?void 0:e.name,message:e.message,underlyingError:e,response:t});return Object.assign(n,{$metadata:e.$metadata})},_r=new Q("RestApis");function jh(e,t){const n=c=>!!t,r=new AbortController,i=r.signal,s=t==null?void 0:t.signal;let o;const a=async()=>{try{const c=await(n(e)?e():e(i));if(c.statusCode>=300)throw await Pa(c);return c}catch(c){const u=s??i,l=o??u.reason;if(c.name==="AbortError"||(u==null?void 0:u.aborted)===!0){const d=new Yt({...l&&{message:l},underlyingError:c,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw _r.debug(c),d}throw _r.debug(c),c}};if(n())return a();{const c=u=>{i.aborted!==!0&&(r.abort(u),u&&i.reason!==u&&(o=u))};return{response:a(),cancel:c}}}const Bs="execute-api",Gh="us-east-1",zh=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,Yh=(e,t)=>{const{service:n=Bs,region:r=Gh}={},{hostname:i}=e,[,s,o]=zh.exec(i)??[];return s===Bs?{service:s,region:o??r}:s==="appsync-api"?{service:"appsync",region:o??r}:{service:n,region:r}},Jh=({headers:e},t)=>!e.authorization&&!e["x-api-key"]&&!!t,Qh=(e,t)=>{const n={};for(const r in e)n[r.toLowerCase()]=e[r];return t&&(n["content-type"]="application/json; charset=UTF-8",t instanceof FormData&&delete n["content-type"]),n},Xh=Xt(Jr,[Yr,zr,Ql]),Zh=Xt(Jr,[Yr,zr]),em=async(e,t,n,r)=>{var S,A,I;const{url:i,method:s,headers:o,body:a,withCredentials:c,abortSignal:u,retryStrategy:l}=t,d=a?a instanceof FormData?a:JSON.stringify(a??""):void 0,f=Qh(o,a),p={url:i,headers:f,method:s,body:d},h={retryDecider:tm(l??((I=(A=(S=e==null?void 0:e.libraryOptions)==null?void 0:S.API)==null?void 0:A.REST)==null?void 0:I.retryStrategy)),computeDelay:jr,withCrossDomainCredentials:c,abortSignal:u},m=n(p,r);let g;const E=await nm(e);if(m&&E){const v=Yh(i),T=(r==null?void 0:r.service)??v.service,P=(r==null?void 0:r.region)??v.region;g=await Xh(p,{...h,credentials:E,region:P,service:T})}else g=await Zh(p,{...h});return{statusCode:g.statusCode,headers:g.headers,body:g.body}},tm=e=>(e==null?void 0:e.strategy)==="no-retry"?()=>Promise.resolve({retryable:!1}):Gr(Pa),nm=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch{_r.debug("No credentials available, the request will be unsigned.")}return null},ai=new WeakMap,rm=(e,{url:t,options:n,abortController:r})=>{const i=r??new AbortController,o=jh(async()=>em(e,{url:t,method:"POST",...n,abortSignal:i.signal,retryStrategy:{strategy:"jittered-exponential-backoff"}},Jh,n==null?void 0:n.signingServiceInfo),i).finally(()=>{ai.delete(o)});return o},im=(e,t)=>{const n=ai.get(e);return n?(n.abort(t),t&&n.signal.reason!==t&&(n.signal.reason=t),!0):!1},sm=(e,t)=>{ai.set(e,t)},om=5e3,am=[400,401,403],cm=["BadRequestException","UnauthorizedException"],um="ConnectionStateChange";var pe;(function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error",e.EVENT_SUBSCRIBE="subscribe",e.EVENT_PUBLISH="publish",e.EVENT_SUBSCRIBE_ACK="subscribe_success",e.EVENT_PUBLISH_ACK="publish_success",e.EVENT_STOP="unsubscribe",e.EVENT_COMPLETE="unsubscribe_success"})(pe||(pe={}));var ke;(function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"})(ke||(ke={}));var re;(function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"})(re||(re={}));const lm={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},$s=15e3,dm=15e3,fm=5*60*1e3,pm=5*1e3,hm=65*1e3,mm=5*1e3,gm=60*1e3;var Se;(function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"})(Se||(Se={}));var J;(function(e){e.Connected="Connected",e.ConnectedPendingNetwork="ConnectedPendingNetwork",e.ConnectionDisrupted="ConnectionDisrupted",e.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",e.Connecting="Connecting",e.ConnectedPendingDisconnect="ConnectedPendingDisconnect",e.Disconnected="Disconnected",e.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive"})(J||(J={}));const Vs=()=>new ut().networkMonitor(),fe={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class ym{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=Vs().subscribe(({online:t})=>{var n;this.record(t?fe.ONLINE:fe.OFFLINE),(n=this._initialNetworkStateSubscription)==null||n.unsubscribe()}),this._linkedConnectionStateObservable=new oe(t=>{t.next(this._linkedConnectionState),this._linkedConnectionStateObserver=t})}enableNetworkMonitoring(){var t;(t=this._initialNetworkStateSubscription)==null||t.unsubscribe(),this._networkMonitoringSubscription===void 0&&(this._networkMonitoringSubscription=Vs().subscribe(({online:n})=>{this.record(n?fe.ONLINE:fe.OFFLINE)}))}disableNetworkMonitoring(){var t;(t=this._networkMonitoringSubscription)==null||t.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let t;return this._linkedConnectionStateObservable.pipe(Wr(n=>this.connectionStatesTranslator(n))).pipe(Hu(n=>{const r=n!==t;return t=n,r}))}record(t){var r;t.intendedConnectionState==="connected"?this.enableNetworkMonitoring():t.intendedConnectionState==="disconnected"&&this.disableNetworkMonitoring();const n={...this._linkedConnectionState,...t};this._linkedConnectionState={...n},(r=this._linkedConnectionStateObserver)==null||r.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState:t,networkState:n,intendedConnectionState:r,keepAliveState:i}){return t==="connected"&&n==="disconnected"?J.ConnectedPendingNetwork:t==="connected"&&r==="disconnected"?J.ConnectedPendingDisconnect:t==="disconnected"&&r==="connected"&&n==="disconnected"?J.ConnectionDisruptedPendingNetwork:t==="disconnected"&&r==="connected"?J.ConnectionDisrupted:t==="connected"&&i==="unhealthy"?J.ConnectedPendingKeepAlive:t==="connecting"?J.Connecting:t==="disconnected"?J.Disconnected:J.Connected}}var mt;(function(e){e.START_RECONNECT="START_RECONNECT",e.HALT_RECONNECT="HALT_RECONNECT"})(mt||(mt={}));class Em{constructor(){this.reconnectObservers=[]}addObserver(t){this.reconnectObservers.push(t)}record(t){t===mt.START_RECONNECT&&this.reconnectSetTimeoutId===void 0&&this.reconnectIntervalId===void 0&&(this.reconnectSetTimeoutId=setTimeout(()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval(()=>{this._triggerReconnect()},gm)},mm)),t===mt.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach(t=>{var n;(n=t.complete)==null||n.call(t)})}_triggerReconnect(){this.reconnectObservers.forEach(t=>{var n;(n=t.next)==null||n.call(t)})}}const Ws="wss://",vm=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i,Sm=/^https:\/\/\w{26}\.\w+-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/event$/i,Hs="/realtime",Im=e=>e.match(vm)===null,Am=e=>e.match(Sm)!==null,wm=e=>{let t=e??"";return Am(t)?t=t.concat(Hs).replace("ddpg-api","grt-gamma").replace("appsync-api","appsync-realtime-api"):Im(t)?t=t.concat(Hs):t=t.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta").replace("ddpg-api","grt-gamma"),t=t.replace("https://",Ws).replace("http://",Ws),new Re(t)},bm=e=>{if(!e)return{};if("Authorization"in e){const{Authorization:t,...n}=e;return n}return e},Tm=e=>{const t=bm(e),n=new Yo;return Object.entries(t).forEach(([r,i])=>{n.append(r,i)}),n},Nm=(e,t)=>{const n=wm(e),r=new Yo(n.search);for(const[i,s]of t.entries())r.append(i,s);return n.search=r.toString(),n.toString()},dr=async e=>{const{appSyncGraphqlEndpoint:t,query:n,libraryConfigHeaders:r=()=>({}),additionalHeaders:i={},authToken:s}=e;let o={};const a=await r();return typeof i=="function"?o=await i({url:t||"",queryString:n||""}):o=i,s&&(o={...o,Authorization:s}),{additionalCustomHeaders:o,libraryConfigHeaders:a}},js=new Q("AWSAppSyncRealTimeProvider Auth"),Gs=async({host:e})=>{var n,r;const t=await Hr();return{Authorization:(r=(n=t==null?void 0:t.tokens)==null?void 0:n.accessToken)==null?void 0:r.toString(),host:e}},Rm=async({apiKey:e,host:t})=>{const r=new Date().toISOString().replace(/[:-]|\.\d{3}/g,"");return{host:t,"x-amz-date":r,"x-api-key":e}},Cm=async({payload:e,canonicalUri:t,appSyncGraphqlEndpoint:n,region:r})=>{const i={region:r,service:"appsync"},s=(await Hr()).credentials,o={url:`${n}${t}`,data:e,method:"POST",headers:{...lm}};return ra({headers:o.headers,method:o.method,url:new Re(o.url),body:o.data},{credentials:s,signingRegion:i.region,signingService:i.service}).headers},zs=async({host:e,additionalCustomHeaders:t})=>{if(!(t!=null&&t.Authorization))throw new Error("No auth token specified");return{Authorization:t.Authorization,host:e}},Oa=async({apiKey:e,authenticationType:t,canonicalUri:n,appSyncGraphqlEndpoint:r,region:i,additionalCustomHeaders:s,payload:o})=>{const a={apiKey:Rm,iam:Cm,oidc:Gs,userPool:Gs,lambda:zs,none:zs};if(!t||!a[t]){js.debug(`Authentication type ${t} not supported`);return}else{const c=a[t],u=r?new Re(r).host:void 0,l=t==="apiKey"?e:void 0;return js.debug(`Authenticating with ${JSON.stringify(t)}`),await c({payload:o,canonicalUri:n,appSyncGraphqlEndpoint:r,apiKey:l,region:i,host:u,additionalCustomHeaders:s})}},Ys=e=>{Ye.dispatch("api",e,"PubSub",ze)};class xm{constructor(t){this.subscriptionObserverMap=new Map,this.allowNoSubscriptions=!1,this.socketStatus=re.CLOSED,this.keepAliveTimestamp=Date.now(),this.promiseArray=[],this.connectionStateMonitor=new ym,this.reconnectionMonitor=new Em,this._establishConnection=async(n,r)=>{this.logger.debug(`Establishing WebSocket connection to ${n}`);try{await this._openConnection(n,r),await this._initiateHandshake()}catch(i){const{errorType:s,errorCode:o}=i;throw am.includes(o)||cm.includes(s)?new Zl(s):s?new Error(s):i}},this.logger=new Q(t.providerName),this.wsProtocolName=t.wsProtocolName,this.wsConnectUri=t.connectUri,this.connectionStateMonitorSubscription=this._startConnectionStateMonitoring()}close(){return this.socketStatus=re.CLOSED,this.connectionStateMonitor.record(fe.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close(),new Promise((t,n)=>{this.awsRealTimeSocket?(this.awsRealTimeSocket.onclose=r=>{this._closeSocket(),this.subscriptionObserverMap=new Map,this.awsRealTimeSocket=void 0,t()},this.awsRealTimeSocket.onerror=r=>{n(r)},this.awsRealTimeSocket.close()):t()})}subscribe(t,n){return new oe(r=>{if(!(t!=null&&t.appSyncGraphqlEndpoint)){r.error({errors:[{...new Bt("Subscribe only available for AWS AppSync endpoint")}]}),r.complete();return}let i=!1;const s=Er(),o=()=>{i||(i=!0,this._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:r,subscriptionId:s,customUserAgentDetails:n}).catch(c=>{this.logger.debug(`${Se.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${c}`),this._closeSocket()}).finally(()=>{i=!1}))},a=new oe(c=>{this.reconnectionMonitor.addObserver(c)}).subscribe(()=>{o()});return o(),async()=>{await this._cleanupSubscription(s,a)}})}async connect(t){this.socketStatus!==re.READY&&await this._connectWebSocket(t)}async publish(t,n){if(this.socketStatus!==re.READY)throw new Error("Subscription has not been initialized");return this._publishMessage(t,n)}async _connectWebSocket(t){const{apiKey:n,appSyncGraphqlEndpoint:r,authenticationType:i,region:s}=t,{additionalCustomHeaders:o}=await dr(t);this.connectionStateMonitor.record(fe.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey:n,appSyncGraphqlEndpoint:r,authenticationType:i,region:s,additionalCustomHeaders:o})}async _publishMessage(t,n){const r=Er(),{additionalCustomHeaders:i,libraryConfigHeaders:s}=await dr(t),o=await this._prepareSubscriptionPayload({options:t,subscriptionId:r,customUserAgentDetails:n,additionalCustomHeaders:i,libraryConfigHeaders:s,publish:!0});return new Promise((a,c)=>{if(this.awsRealTimeSocket){const u=p=>{const h=JSON.parse(p.data);if(h.id===r&&h.type==="publish_success"&&(this.awsRealTimeSocket&&this.awsRealTimeSocket.removeEventListener("message",u),f(),a()),h.errors&&h.errors.length>0){const m=h.errors.map(g=>g.errorType);f(),c(new Error(`Publish errors: ${m.join(", ")}`))}},l=p=>{f(),c(new Error(`WebSocket error: ${p}`))},d=()=>{f(),c(new Error("WebSocket is closed"))},f=()=>{var p,h,m;(p=this.awsRealTimeSocket)==null||p.removeEventListener("message",u),(h=this.awsRealTimeSocket)==null||h.removeEventListener("error",l),(m=this.awsRealTimeSocket)==null||m.removeEventListener("close",d)};this.awsRealTimeSocket.addEventListener("message",u),this.awsRealTimeSocket.addEventListener("error",l),this.awsRealTimeSocket.addEventListener("close",d),this.awsRealTimeSocket.send(o)}else c(new Error("WebSocket is not connected"))})}async _cleanupSubscription(t,n){n==null||n.unsubscribe();try{await this._waitForSubscriptionToBeConnected(t);const{subscriptionState:r}=this.subscriptionObserverMap.get(t)||{};if(!r)return;if(r===ke.CONNECTED)this._sendUnsubscriptionMessage(t);else throw new Error("Subscription never connected")}catch(r){this.logger.debug(`Error while unsubscribing ${r}`)}finally{this._removeSubscriptionObserver(t)}}_startConnectionStateMonitoring(){return this.connectionStateMonitor.connectionStateObservable.subscribe(t=>{Ys({event:um,data:{provider:this,connectionState:t},message:`Connection state is ${t}`}),this.connectionState=t,t===J.ConnectionDisrupted&&this.reconnectionMonitor.record(mt.START_RECONNECT),[J.Connected,J.ConnectedPendingDisconnect,J.ConnectedPendingKeepAlive,J.ConnectedPendingNetwork,J.ConnectionDisruptedPendingNetwork,J.Disconnected].includes(t)&&this.reconnectionMonitor.record(mt.HALT_RECONNECT)})}async _startSubscriptionWithAWSAppSyncRealTime({options:t,observer:n,subscriptionId:r,customUserAgentDetails:i}){const{query:s,variables:o}=t;this.subscriptionObserverMap.set(r,{observer:n,query:s??"",variables:o??{},subscriptionState:ke.PENDING,startAckTimeoutId:void 0});const{additionalCustomHeaders:a,libraryConfigHeaders:c}=await dr(t),u=await this._prepareSubscriptionPayload({options:t,subscriptionId:r,customUserAgentDetails:i,additionalCustomHeaders:a,libraryConfigHeaders:c});try{await this._connectWebSocket(t)}catch(f){this._logStartSubscriptionError(r,n,f);return}const{subscriptionFailedCallback:l,subscriptionReadyCallback:d}=this.subscriptionObserverMap.get(r)??{};this.subscriptionObserverMap.set(r,{observer:n,subscriptionState:ke.PENDING,query:s??"",variables:o??{},subscriptionReadyCallback:d,subscriptionFailedCallback:l,startAckTimeoutId:setTimeout(()=>{this._timeoutStartSubscriptionAck(r)},dm)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(u)}_logStartSubscriptionError(t,n,r){this.logger.debug({err:r});const i=String(r.message??"");if(this._closeSocket(),this.connectionState!==J.ConnectionDisruptedPendingNetwork){fo(r)?n.error({errors:[{...new Bt(`${Se.CONNECTION_FAILED}: ${i}`)}]}):this.logger.debug(`${Se.CONNECTION_FAILED}: ${i}`);const{subscriptionFailedCallback:s}=this.subscriptionObserverMap.get(t)||{};typeof s=="function"&&s()}}async _waitForSubscriptionToBeConnected(t){const n=this.subscriptionObserverMap.get(t);if(n){const{subscriptionState:r}=n;if(r===ke.PENDING)return new Promise((i,s)=>{const{observer:o,subscriptionState:a,variables:c,query:u}=n;this.subscriptionObserverMap.set(t,{observer:o,subscriptionState:a,variables:c,query:u,subscriptionReadyCallback:i,subscriptionFailedCallback:s})})}}_sendUnsubscriptionMessage(t){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===re.READY){const n=this._unsubscribeMessage(t),r=JSON.stringify(n);this.awsRealTimeSocket.send(r)}}catch(n){this.logger.debug({err:n})}}_removeSubscriptionObserver(t){this.subscriptionObserverMap.delete(t),this.allowNoSubscriptions||setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0)){if(!this.awsRealTimeSocket){this.socketStatus=re.CLOSED;return}if(this.connectionStateMonitor.record(fe.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{this.logger.debug("closing WebSocket...");const t=this.awsRealTimeSocket;t.onclose=null,t.onerror=null,t.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=re.CLOSED,this._closeSocket()}}}maintainKeepAlive(){this.keepAliveTimestamp=Date.now()}keepAliveHeartbeat(t){const n=Date.now();n-this.keepAliveTimestamp>hm?this.connectionStateMonitor.record(fe.KEEP_ALIVE_MISSED):this.connectionStateMonitor.record(fe.KEEP_ALIVE),n-this.keepAliveTimestamp>t&&this._errorDisconnect(Se.TIMEOUT_DISCONNECT)}_handleIncomingSubscriptionMessage(t){if(typeof t.data!="string")return;const[n,r]=this._handleSubscriptionData(t);if(n){this.maintainKeepAlive();return}const{type:i,id:s,payload:o}=r,{observer:a=null,query:c="",variables:u={},startAckTimeoutId:l,subscriptionReadyCallback:d,subscriptionFailedCallback:f}=this.subscriptionObserverMap.get(s)||{};if(i===pe.GQL_START_ACK||i===pe.EVENT_SUBSCRIBE_ACK){this.logger.debug(`subscription ready for ${JSON.stringify({query:c,variables:u})}`),typeof d=="function"&&d(),l&&clearTimeout(l),Ys({event:Se.SUBSCRIPTION_ACK,data:{query:c,variables:u},message:"Connection established for subscription"});const p=ke.CONNECTED;a&&this.subscriptionObserverMap.set(s,{observer:a,query:c,variables:u,startAckTimeoutId:void 0,subscriptionState:p,subscriptionReadyCallback:d,subscriptionFailedCallback:f}),this.connectionStateMonitor.record(fe.CONNECTION_ESTABLISHED);return}if(i===pe.GQL_CONNECTION_KEEP_ALIVE){this.maintainKeepAlive();return}if(i===pe.GQL_ERROR){const p=ke.FAILED;a&&(this.subscriptionObserverMap.set(s,{observer:a,query:c,variables:u,startAckTimeoutId:l,subscriptionReadyCallback:d,subscriptionFailedCallback:f,subscriptionState:p}),this.logger.debug(`${Se.CONNECTION_FAILED}: ${JSON.stringify(o??r)}`),a.error({errors:[{...new Bt(`${Se.CONNECTION_FAILED}: ${JSON.stringify(o??r)}`)}]}),l&&clearTimeout(l),typeof f=="function"&&f())}}_errorDisconnect(t){this.logger.debug(`Disconnect error: ${t}`),this.awsRealTimeSocket&&(this._closeSocket(),this.awsRealTimeSocket.close()),this.socketStatus=re.CLOSED}_closeSocket(){this.keepAliveHeartbeatIntervalId&&(clearInterval(this.keepAliveHeartbeatIntervalId),this.keepAliveHeartbeatIntervalId=void 0),this.connectionStateMonitor.record(fe.CLOSED)}_timeoutStartSubscriptionAck(t){const n=this.subscriptionObserverMap.get(t);if(n){const{observer:r,query:i,variables:s}=n;if(!r)return;this.subscriptionObserverMap.set(t,{observer:r,query:i,variables:s,subscriptionState:ke.FAILED}),this._closeSocket(),this.logger.debug("timeoutStartSubscription",JSON.stringify({query:i,variables:s}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint:t,authenticationType:n,apiKey:r,region:i,additionalCustomHeaders:s}){if(this.socketStatus!==re.READY)return new Promise(async(o,a)=>{if(this.promiseArray.push({res:o,rej:a}),this.socketStatus===re.CLOSED)try{this.socketStatus=re.CONNECTING;const u=await Oa({authenticationType:n,payload:"{}",canonicalUri:this.wsConnectUri,apiKey:r,appSyncGraphqlEndpoint:t,region:i,additionalCustomHeaders:s}),l=u?JSON.stringify(u):"",f=`header-${ft.convert(l,{urlSafe:!0,skipPadding:!0})}`,p=Tm(s),h=Nm(t,p);await this._establishRetryableConnection(h,f),this.promiseArray.forEach(({res:m})=>{this.logger.debug("Notifying connection successful"),m()}),this.socketStatus=re.READY,this.promiseArray=[]}catch(c){this.logger.debug("Connection exited with",c),this.promiseArray.forEach(({rej:u})=>{u(c)}),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=re.CLOSED}})}async _establishRetryableConnection(t,n){this.logger.debug("Establishing retryable connection"),await ed(this._establishConnection.bind(this),[t,n],om)}async _openConnection(t,n){return new Promise((r,i)=>{const s=this._getNewWebSocket(t,[this.wsProtocolName,n]);s.onerror=()=>{this.logger.debug("WebSocket connection error")},s.onclose=()=>{this._closeSocket(),i(new Error("Connection handshake error"))},s.onopen=()=>{this.awsRealTimeSocket=s,r()}})}_getNewWebSocket(t,n){return new WebSocket(t,n)}async _initiateHandshake(){return new Promise((t,n)=>{if(!this.awsRealTimeSocket){n(new Error("awsRealTimeSocket undefined"));return}let r=!1;this.awsRealTimeSocket.onerror=o=>{this.logger.debug(`WebSocket error ${JSON.stringify(o)}`)},this.awsRealTimeSocket.onclose=o=>{this.logger.debug(`WebSocket closed ${o.reason}`),this._closeSocket(),n(new Error(JSON.stringify(o)))},this.awsRealTimeSocket.onmessage=o=>{if(typeof o.data!="string")return;this.logger.debug(`subscription message from AWS AppSyncRealTime: ${o.data} `);const a=JSON.parse(o.data),{type:c}=a,u=this._extractConnectionTimeout(a);if(c===pe.GQL_CONNECTION_ACK){r=!0,this._registerWebsocketHandlers(u),t("Connected to AWS AppSyncRealTime");return}if(c===pe.GQL_CONNECTION_ERROR){const{errorType:l,errorCode:d}=this._extractErrorCodeAndType(a);n({errorType:l,errorCode:d})}};const i={type:pe.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(i));const s=o=>{o||(this.connectionStateMonitor.record(fe.CONNECTION_FAILED),n(new Error(`Connection timeout: ack from AWSAppSyncRealTime was not received after ${$s} ms`)))};setTimeout(()=>{s(r)},$s)})}_registerWebsocketHandlers(t){this.awsRealTimeSocket&&(this.keepAliveHeartbeatIntervalId=setInterval(()=>{this.keepAliveHeartbeat(t)},pm),this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=n=>{this.logger.debug(n),this._errorDisconnect(Se.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=n=>{this.logger.debug(`WebSocket closed ${n.reason}`),this._closeSocket(),this._errorDisconnect(Se.CONNECTION_CLOSED)})}}const Js="AWSAppSyncRealTimeProvider",_m="graphql-ws",Pm="/connect";class Om extends xm{constructor(){super({providerName:Js,wsProtocolName:_m,connectUri:Pm})}getProviderName(){return Js}subscribe(t,n){return super.subscribe(t,n)}async _prepareSubscriptionPayload({options:t,subscriptionId:n,customUserAgentDetails:r,additionalCustomHeaders:i,libraryConfigHeaders:s}){const{appSyncGraphqlEndpoint:o,authenticationType:a,query:c,variables:u,apiKey:l,region:d}=t,p=JSON.stringify({query:c,variables:u}),h={...await Oa({apiKey:l,appSyncGraphqlEndpoint:o,authenticationType:a,payload:p,canonicalUri:"",region:d,additionalCustomHeaders:i}),...s,...i,[rc]:Et(r)},m={id:n,payload:{data:p,extensions:{authorization:{...h}}},type:pe.GQL_START};return JSON.stringify(m)}_handleSubscriptionData(t){this.logger.debug(`subscription message from AWS AppSync RealTime: ${t.data}`);const{id:n="",payload:r,type:i}=JSON.parse(String(t.data)),{observer:s=null,query:o="",variables:a={}}=this.subscriptionObserverMap.get(n)||{};return this.logger.debug({id:n,observer:s,query:o,variables:a}),i===pe.DATA&&r&&r.data?(s?s.next(r):this.logger.debug(`observer not found for id: ${n}`),[!0,{id:n,type:i,payload:r}]):[!1,{id:n,type:i,payload:r}]}_unsubscribeMessage(t){return{id:t,type:pe.GQL_STOP}}_extractConnectionTimeout(t){const{payload:{connectionTimeoutMs:n=fm}={}}=t;return n}_extractErrorCodeAndType(t){const{payload:{errors:[{errorType:n="",errorCode:r=0}={}]=[]}={}}=t;return{errorCode:r,errorType:n}}}class Ne extends ne{constructor(t){super(t),this.constructor=Ne,Object.setPrototypeOf(this,Ne.prototype)}}var lt;(function(e){e.NoAuthSession="NoAuthSession",e.NoRegion="NoRegion",e.NoCustomEndpoint="NoCustomEndpoint"})(lt||(lt={}));const km={[lt.NoAuthSession]:{message:"Auth session should not be empty."},[lt.NoRegion]:{message:"Missing region."},[lt.NoCustomEndpoint]:{message:"Custom endpoint region is present without custom endpoint."}};function Dm(e,t){const{message:n,recoverySuggestion:r}=km[t];if(!e)throw new Ne({name:t,message:n,recoverySuggestion:r})}const Lm=new Q("GraphQLAPI resolveConfig"),Qs=e=>{var c,u;const t=e.getConfig();(c=t.API)!=null&&c.GraphQL||Lm.warn("The API configuration is missing. This is likely due to Amplify.configure() not being called prior to generateClient().");const{apiKey:n,customEndpoint:r,customEndpointRegion:i,defaultAuthMode:s,endpoint:o,region:a}=((u=t.API)==null?void 0:u.GraphQL)??{};return Dm(!(!r&&i),lt.NoCustomEndpoint),{apiKey:n,customEndpoint:r,customEndpointRegion:i,defaultAuthMode:s,endpoint:o,region:a}},Xs=e=>{var r,i,s,o,a,c;const t=(s=(i=(r=e.libraryOptions)==null?void 0:r.API)==null?void 0:i.GraphQL)==null?void 0:s.headers,n=(c=(a=(o=e.libraryOptions)==null?void 0:o.API)==null?void 0:a.GraphQL)==null?void 0:c.withCredentials;return{headers:t,withCredentials:n}};function Zs(e){return e.errors&&Array.isArray(e.errors)&&e.errors.forEach(t=>{Mm(t)&&(t.message="Unauthorized",t.recoverySuggestion=`If you're calling an Amplify-generated API, make sure to set the "authMode" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')`)}),e}function Mm(e){var t,n,r,i;return!!((n=(t=e==null?void 0:e.originalError)==null?void 0:t.name)!=null&&n.startsWith("UnauthorizedException")||(r=e.message)!=null&&r.startsWith("Connection failed:")&&((i=e.message)!=null&&i.includes("Permission denied")))}var rt;(function(e){e.NO_API_KEY="No api-key configured",e.NO_CURRENT_USER="No current user",e.NO_CREDENTIALS="No credentials",e.NO_FEDERATED_JWT="No federated jwt",e.NO_AUTH_TOKEN="No auth token specified"})(rt||(rt={}));const ka=Symbol("amplify"),Rn=Symbol("authMode"),Da=Symbol("authToken"),Pr=Symbol("apiKey"),La=Symbol("headers"),Cn=Symbol("endpoint");function ci(e){const t=e;return{amplify:t[ka],apiKey:t[Pr],authMode:t[Rn],authToken:t[Da],endpoint:t[Cn],headers:t[La]}}const Um={name:"NoApiKey",message:rt.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},Fm={name:"NoCredentials",message:rt.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},qm={name:"NoValidAuthTokens",message:rt.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},Km={name:"NoSignedUser",message:rt.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},Bm={name:"NoAuthorizationHeader",message:rt.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'},$m={name:"NoEndpoint",message:"No GraphQL endpoint configured in `Amplify.configure()`.",recoverySuggestion:"Review if the GraphQL API endpoint is set in the `Amplify.configure()` function."},eo=e=>({data:{},errors:[new Bt(e.message,null,null,null,null,e)]});function Vm(e){if(!e)return!1;const t=e;return Array.isArray(t.errors)&&t.errors.length>0}async function Wm(e,t,n,r={}){var s;let i={};switch(t){case"apiKey":if(!n)throw new Ne(Um);i={"X-Api-Key":n};break;case"iam":{if((await e.Auth.fetchAuthSession()).credentials===void 0)throw new Ne(Fm);break}case"oidc":case"userPool":{let o;try{o=(s=(await e.Auth.fetchAuthSession()).tokens)==null?void 0:s.accessToken.toString()}catch(a){throw new Ne({...Km,underlyingError:a})}if(!o)throw new Ne(qm);i={Authorization:o};break}case"lambda":if(typeof r=="object"&&!r.Authorization)throw new Ne(Bm);i={Authorization:r.Authorization};break}return i}const Hm="x-amz-user-agent",jm=e=>typeof e!="function";class Gm{constructor(){this.appSyncRealTime=new Map,this._api={post:rm,cancelREST:im,isCancelErrorREST:Vh,updateRequestToBeCancellable:sm}}getModuleName(){return"InternalGraphQLAPI"}getGraphqlOperationType(t){const r=ur(t).definitions,[{operation:i}]=r;return i}graphql(t,{query:n,variables:r={},authMode:i,authToken:s,endpoint:o,apiKey:a},c,u){const l=ur(typeof n=="string"?n:kt(n)),[d={}]=l.definitions.filter(h=>h.kind==="OperationDefinition"),{operation:f}=d,p=c||{};switch(f){case"query":case"mutation":{const h=new AbortController;let m;return jm(t)?m=this._graphql(t,{query:l,variables:r,authMode:i,apiKey:a,endpoint:o},p,h,u,s):m=t(async E=>await this._graphql(E,{query:l,variables:r,authMode:i,apiKey:a,endpoint:o},p,h,u,s)),this._api.updateRequestToBeCancellable(m,h),m}case"subscription":return this._graphqlSubscribe(t,{query:l,variables:r,authMode:i,apiKey:a,endpoint:o},p,u,s);default:throw new Error(`invalid operation type: ${f}`)}}async _graphql(t,{query:n,variables:r,authMode:i,endpoint:s,apiKey:o},a={},c,u,l){const{apiKey:d,region:f,endpoint:p,customEndpoint:h,customEndpointRegion:m,defaultAuthMode:g}=Qs(t),E=i||g||"iam",S=E==="identityPool"?"iam":E,{headers:A,withCredentials:I}=Xs(t);let v;if(typeof a=="function"){const O={method:"POST",url:new Re(s||h||p||"").toString(),queryString:kt(n)};v=await a(O)}else v=a;l&&(v={...v,Authorization:l});const T=await Wm(t,S,o??d,v),P={...!h&&T,...h&&(m?T:{})||{},...A&&await A({query:kt(n),variables:r}),...v,...!h&&{[Hm]:Et(u)}},k={query:kt(n),variables:r||null};let D;h&&!m||S!=="oidc"&&S!=="userPool"&&S!=="iam"&&S!=="lambda"?D=void 0:D={service:m?"execute-api":"appsync",region:m||f};const q=s||h||p;if(!q)throw eo(new Ne($m));let V;try{const{body:O}=await this._api.post(t,{url:new Re(q),options:{headers:P,body:k,signingServiceInfo:D,withCredentials:I},abortController:c});V=await O.json()}catch(O){if(this.isCancelError(O))throw O;V=eo(O)}if(Vm(V))throw Zs(V);return V}isCancelError(t){return this._api.isCancelErrorREST(t)}cancel(t,n){return this._api.cancelREST(t,n)}_graphqlSubscribe(t,{query:n,variables:r,authMode:i,apiKey:s,endpoint:o},a={},c,u){const l=Qs(t),d=i||(l==null?void 0:l.defaultAuthMode)||"iam",f=d==="identityPool"?"iam":d,{headers:p}=Xs(t),h=o??(l==null?void 0:l.endpoint),m=h??"none",g=this.appSyncRealTime.get(m)??new Om;return this.appSyncRealTime.set(m,g),g.subscribe({query:kt(n),variables:r,appSyncGraphqlEndpoint:h,region:l==null?void 0:l.region,authenticationType:f,apiKey:s??(l==null?void 0:l.apiKey),additionalHeaders:a,authToken:u,libraryConfigHeaders:p},c).pipe(Mo(E=>{throw E.errors?Zs(E):E}))}}function Jn(e){const t=new Set;for(const n of e.attributes||[])if(zm(n))for(const r of n.properties.rules)r.allow==="owner"?t.add(r.ownerField||"owner"):r.allow==="groups"&&r.groupsField!==void 0&&t.add(r.groupsField);return Array.from(t)}function zm(e){var t,n;return(e==null?void 0:e.type)==="auth"&&typeof(e==null?void 0:e.properties)=="object"&&Array.isArray((t=e==null?void 0:e.properties)==null?void 0:t.rules)?((n=e==null?void 0:e.properties)==null?void 0:n.rules).every(r=>!!r.allow):!1}function xn(e){return`${e[0].toUpperCase()}${e.slice(1)}`}function We(e){let t,n;const r=new Promise((i,s)=>{t=i,n=s});return e(r).then(i=>{t(i)}).catch(i=>{n(i)}),r}const Mn=new WeakMap;function He(e,t){return Mn.set(t,e),e.finally(()=>{Mn.delete(t)})}function Ym(e){const t=e.cancel.bind(e);e.cancel=function(n,r){const i=new Set;let s=n;for(;s&&Mn.has(s);){if(i.has(s))throw new Error("A cycle was detected in the modeled graphql cancellation chain. This is a bug. Please report it!");i.add(s),s=Mn.get(s)}return t(s,r)}}const ot={HAS_ONE:"HAS_ONE",HAS_MANY:"HAS_MANY",BELONGS_TO:"BELONGS_TO"},to={ID:"ID",String:"String",AWSDate:"String",AWSTime:"String",AWSDateTime:"String",AWSTimestamp:"Int",AWSEmail:"String",AWSPhone:"String",AWSURL:"String",AWSIPAddress:"String",AWSJSON:"String",Boolean:"Boolean",Int:"Int",Float:"Float"},Un=e=>e.length===1?e[0]:e.reduce((t,n,r)=>r===0?n:t+xn(n),""),Fe=(e,t,n)=>{var i;if(!n)return null;const r={};for(const[s,o]of Object.entries(n)){const a=t?(i=e.models[t])==null?void 0:i.fields[s]:void 0,c={fieldDef:a,value:o};Jm(c)?r[s]=c.value.items.map(u=>Fe(e,c.fieldDef.type.model,u)):Qm(a)?r[s]=Fe(e,a.type.model,o):r[s]=o}return r};function Jm(e){var t,n;return typeof((t=e.fieldDef)==null?void 0:t.type)=="object"&&"model"in e.fieldDef.type&&typeof e.fieldDef.type.model=="string"&&e.fieldDef.isArray&&Array.isArray((n=e.value)==null?void 0:n.items)}function Qm(e){return typeof(e==null?void 0:e.type)=="object"&&"model"in e.type&&typeof e.type.model=="string"}function qe(e,t,n,r,i,s,o=!1){const a=r.models[t],c=a.fields,u=Object.entries(c).filter(([l,d])=>{var f;return((f=d==null?void 0:d.type)==null?void 0:f.model)!==void 0}).map(([l])=>l);return n.map(l=>{var f,p,h,m,g;if(l==null)return l;const d={};for(const E of u){const S=c[E],I=(S==null?void 0:S.type).model,v=r.models[I],T=v.primaryKeyInfo.primaryKeyFieldName,P=v.primaryKeyInfo.sortKeyFieldNames,k=(f=S.association)==null?void 0:f.connectionType;let D=[];S.association&&"associatedWith"in S.association&&(D=S.association.associatedWith);const q=[];switch(S.association&&"targetNames"in S.association&&q.push(...S.association.targetNames),k){case ot.BELONGS_TO:{const V=P.reduce((O,C)=>(l[C]&&(O[C]=l[C]),O),{});if(((p=e.models[I])==null?void 0:p.get)===void 0)break;o?d[E]=(O,C)=>l[q[0]]?e.models[I].get(O,{[T]:l[q[0]],...V},{authMode:(C==null?void 0:C.authMode)||i,authToken:(C==null?void 0:C.authToken)||s}):{data:null}:d[E]=O=>l[q[0]]?e.models[I].get({[T]:l[q[0]],...V},{authMode:(O==null?void 0:O.authMode)||i,authToken:(O==null?void 0:O.authToken)||s}):{data:null};break}case ot.HAS_ONE:case ot.HAS_MANY:{const V=k===ot.HAS_ONE?_=>({data:(_==null?void 0:_.data.shift())||null,errors:_.errors,extensions:_.extensions}):_=>_,O=a.primaryKeyInfo.primaryKeyFieldName,C=a.primaryKeyInfo.sortKeyFieldNames,U=v.fields[D[0]];if(U.type.model){let _=[];U.association&&"targetNames"in U.association&&(_=(h=U.association)==null?void 0:h.targetNames);const K=_.map((L,F)=>F===0?{[L]:{eq:l[O]}}:{[L]:{eq:l[C[F-1]]}});if(((m=e.models[I])==null?void 0:m.list)===void 0)break;o?d[E]=(L,F)=>l[O]?We(async $e=>{const _t=e.models[I].list(L,{filter:{and:K},limit:F==null?void 0:F.limit,nextToken:F==null?void 0:F.nextToken,authMode:(F==null?void 0:F.authMode)||i,authToken:(F==null?void 0:F.authToken)||s}),nr=He(_t,$e);return V(await nr)}):[]:d[E]=L=>l[O]?We(async F=>{const $e=e.models[I].list({filter:{and:K},limit:L==null?void 0:L.limit,nextToken:L==null?void 0:L.nextToken,authMode:(L==null?void 0:L.authMode)||i,authToken:(L==null?void 0:L.authToken)||s}),_t=He($e,F);return V(await _t)}):[];break}const le=D.map((_,K)=>K===0?{[_]:{eq:l[O]}}:{[_]:{eq:l[C[K-1]]}});if(((g=e.models[I])==null?void 0:g.list)===void 0)break;o?d[E]=(_,K)=>l[O]?We(async L=>{const F=e.models[I].list(_,{filter:{and:le},limit:K==null?void 0:K.limit,nextToken:K==null?void 0:K.nextToken,authMode:(K==null?void 0:K.authMode)||i,authToken:(K==null?void 0:K.authToken)||s}),$e=He(F,L);return V(await $e)}):[]:d[E]=_=>l[O]?We(async K=>{const L=e.models[I].list({filter:{and:le},limit:_==null?void 0:_.limit,nextToken:_==null?void 0:_.nextToken,authMode:(_==null?void 0:_.authMode)||i,authToken:(_==null?void 0:_.authToken)||s}),F=He(L,K);return V(await F)}):[];break}}}return{...l,...d}})}const Or={CREATE:{operationPrefix:"create",usePlural:!1},GET:{operationPrefix:"get",usePlural:!1},UPDATE:{operationPrefix:"update",usePlural:!1},DELETE:{operationPrefix:"delete",usePlural:!1},LIST:{operationPrefix:"list",usePlural:!0},INDEX_QUERY:{operationPrefix:"",usePlural:!1},ONCREATE:{operationPrefix:"onCreate",usePlural:!1},ONUPDATE:{operationPrefix:"onUpdate",usePlural:!1},ONDELETE:{operationPrefix:"onDelete",usePlural:!1},OBSERVEQUERY:{operationPrefix:"observeQuery",usePlural:!1}},kr="*",Qn=(e,t)=>{const{fields:n}=e,r=Object.values(n).map(({type:i,name:s})=>{if(typeof i.enum=="string")return[s,gt];if(typeof i.nonModel=="string")return[s,Qn(t.nonModels[i.nonModel],t)];if(typeof i=="string")return[s,gt]}).filter(i=>i!==void 0);return Object.fromEntries(r)},Xm=(e,t)=>{const{fields:n}=e,r=Object.values(n).map(({type:s,name:o})=>{if(typeof s.enum=="string"||typeof s=="string")return[o,gt];if(typeof s.nonModel=="string")return[o,Qn(t.nonModels[s.nonModel],t)]}).filter(s=>s!==void 0),i=Jn(e).map(s=>[s,gt]);return Object.fromEntries(r.concat(i))};function Zm(e){const{fields:t}=e,n=Object.values(t).map(({type:i,name:s})=>{if(typeof i=="string")return s;if(typeof i=="object"){if(typeof(i==null?void 0:i.enum)=="string")return s;if(typeof(i==null?void 0:i.nonModel)=="string")return`${s}.${kr}`}}).filter(Boolean),r=Jn(e);return Array.from(new Set(n.concat(r)))}const gt="";function eg(e,t,n){const r=(i,s)=>{var g,E,S,A,I,v;const[o,...a]=i.split("."),c=a[0],u=e.models[s]??e.nonModels[s],l=u==null?void 0:u.fields,d=(E=(g=l==null?void 0:l[o])==null?void 0:g.type)==null?void 0:E.model,f=e.models[d],p=(A=(S=l==null?void 0:l[o])==null?void 0:S.type)==null?void 0:A.nonModel,h=e.nonModels[p],m=f?"model":h?"nonModel":"field";if(m==="nonModel"){let T={};if(!c)throw Error(`${o} must declare a wildcard (*) or a field of custom type ${p}`);return c===kr?T={[o]:Qn(h,e)}:T={[o]:r(a.join("."),p)},T}else if(m==="model"){let T={};if(!c)throw Error(`${o} must declare a wildcard (*) or a field of model ${d}`);if(c===kr){const P=e.models[d];T={[o]:Xm(P,e)}}else T={[o]:r(a.join("."),d)};return(I=l[o])!=null&&I.isArray&&(T={[o]:{items:T[o]}}),T}else{const T=l==null?void 0:l[o],P=e.nonModels[s],k=(v=P==null?void 0:P.fields)==null?void 0:v[o];if(P){if(!k)throw Error(`${o} is not a field of custom type ${s}`)}else{const D=Jn(u).includes(o);if(!T&&!D)throw Error(`${o} is not a field of model ${s}`)}return{[o]:gt}}};return n.reduce((i,s)=>Ma(r(s,t),i),{})}function Fn(e){const t=[];return Object.entries(e).forEach(([n,r])=>{r===gt?t.push(n):typeof r=="object"&&r!==null&&(r!=null&&r.items?t.push(n,"{","items","{",Fn(r.items),"}","}"):t.push(n,"{",Fn(r),"}"))}),t.join(" ")}function Ma(e,t){const n=r=>r&&typeof r=="object";for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)&&n(t[r])?Ma(e[r],t[r]):t[r]=e[r]);return t}function Ua(e,t,n){const r=e.models[t],i=eg(e,t,n??Zm(r));return Fn(i)}function Xn(e,t,n,r,i){var V,O;const{name:s,pluralName:o,fields:a,primaryKeyInfo:{isCustomPrimaryKey:c,primaryKeyFieldName:u,sortKeyFieldNames:l},attributes:d}=t,f=s.charAt(0).toUpperCase()+s.slice(1),p=o.charAt(0).toUpperCase()+o.slice(1),{operationPrefix:h,usePlural:m}=Or[n],{selectionSet:g}=r||{};let E,S;if(h)E=`${h}${m?p:f}`;else if(i){const{queryField:C,pk:U,sk:Y=[]}=i;E=C;let le={};if(Y.length===1){const[_]=Y,K=typeof a[_].type=="string"?a[_].type:"String",L=to[K];le={[_]:`Model${L}KeyConditionInput`}}else if(Y.length>1){const _=Un(Y),K=(O=(V=d==null?void 0:d.find(L=>{var F;return((F=L==null?void 0:L.properties)==null?void 0:F.queryField)===C}))==null?void 0:V.properties)==null?void 0:O.name;le={[_]:`Model${xn(s)}${xn(K)}CompositeKeyConditionInput`}}S={[U]:`${Object.prototype.hasOwnProperty.call(a[U].type,"enum")?a[U].type.enum:a[U].type}!`,...le}}else throw new Error("Error generating GraphQL Document - invalid operation name");let A,I,v;const T=Ua(e,s,g),P={[u]:`${a[u].type}!`},k={},D=C=>{if(l.length===0)return{};if(C==="get")return l.reduce((U,Y)=>{const le=a[Y].type;return C==="get"&&(U[Y]=`${le}!`),U},{});if(l.length===1){const[U]=l,Y=typeof a[U].type=="string"?a[U].type:"String",le=to[Y];return{[U]:`Model${le}KeyConditionInput`}}else return{[Un(l)]:`Model${xn(s)}PrimaryCompositeKeyConditionInput`}};switch(c&&(Object.assign(P,D("get")),Object.assign(k,{[u]:`${a[u].type}`,sortDirection:"ModelSortDirection"},D("list"))),n){case"CREATE":case"UPDATE":case"DELETE":v??(v={input:`${h.charAt(0).toLocaleUpperCase()+h.slice(1)}${f}Input!`}),A??(A="mutation");case"GET":v??(v=P),I??(I=T);case"LIST":v??(v={...k,filter:`Model${f}FilterInput`,limit:"Int",nextToken:"String"}),A??(A="query"),I??(I=`items { ${T} } nextToken __typename`);case"INDEX_QUERY":v??(v={...S,filter:`Model${f}FilterInput`,sortDirection:"ModelSortDirection",limit:"Int",nextToken:"String"}),A??(A="query"),I??(I=`items { ${T} } nextToken __typename`);case"ONCREATE":case"ONUPDATE":case"ONDELETE":v??(v={filter:`ModelSubscription${f}FilterInput`}),A??(A="subscription"),I??(I=T);break;case"OBSERVEQUERY":default:throw new Error("Internal error: Attempted to generate graphql document for observeQuery. Please report this error.")}return`${A}${v?`(${Object.entries(v).map(([C,U])=>`$${C}: ${U}`)})`:""} { ${E}${v?`(${Object.keys(v).map(C=>`${C}: $${C}`)})`:""} { ${I} } }`}function Zn(e,t,n,r,i){const{fields:s,primaryKeyInfo:{isCustomPrimaryKey:o,primaryKeyFieldName:a,sortKeyFieldNames:c}}=e,u=(c==null?void 0:c.length)&&Un(c);let l={};switch(t){case"CREATE":l={input:n?no(n,e,r):{}};break;case"UPDATE":l={input:n?Object.fromEntries(Object.entries(no(n,e,r)).filter(([d])=>s[d]?!s[d].isReadOnly:!Jn(e).includes(d))):{}};break;case"GET":case"DELETE":n&&(l=o?[a,...c].reduce((d,f)=>(d[f]=n[f],d),{}):{[a]:n[a]}),t==="DELETE"&&(l={input:l});break;case"LIST":n!=null&&n.filter&&(l.filter=n.filter),n!=null&&n.sortDirection&&(l.sortDirection=n.sortDirection),n&&n[a]&&(l[a]=n[a]),u&&n&&n[u]&&(l[u]=n[u]),n!=null&&n.nextToken&&(l.nextToken=n.nextToken),n!=null&&n.limit&&(l.limit=n.limit);break;case"INDEX_QUERY":{const{pk:d,sk:f=[]}=i,p=(f==null?void 0:f.length)&&Un(f);l[d]=n[d],p&&n&&n[p]&&(l[p]=n[p]),n!=null&&n.filter&&(l.filter=n.filter),n!=null&&n.sortDirection&&(l.sortDirection=n.sortDirection),n!=null&&n.nextToken&&(l.nextToken=n.nextToken),n!=null&&n.limit&&(l.limit=n.limit);break}case"ONCREATE":case"ONUPDATE":case"ONDELETE":n!=null&&n.filter&&(l={filter:n.filter});break;case"OBSERVEQUERY":throw new Error("Internal error: Attempted to build variables for observeQuery. Please report this error.");default:{const d=t;throw new Error(`Unhandled operation case: ${d}`)}}return l}function no(e,t,n){const{fields:r}=t,i={};return Object.entries(e).forEach(([s,o])=>{var u,l;const a=(u=r[s])==null?void 0:u.type,c=a==null?void 0:a.model;if(c){const d=(l=r[s])==null?void 0:l.association,p=n.models[c].primaryKeyInfo;if((d==null?void 0:d.connectionType)===ot.HAS_ONE){const h=d;h.targetNames.forEach((m,g)=>{const E=h.associatedWith[g];i[m]=o[E]})}(d==null?void 0:d.connectionType)===ot.BELONGS_TO&&d.targetNames.forEach((m,g)=>{if(g===0){const E=p.primaryKeyFieldName;i[m]=o[E]}else{const E=p.sortKeyFieldNames[g-1];i[m]=o[E]}})}else i[s]=o}),i}function Rt(e,t,n={}){const r=t(e);return{authMode:n.authMode||r.authMode,authToken:n.authToken||r.authToken}}function Ct(e,t,n){let r=t(e).headers||{};return n&&(r=n),r}function Dr(e){if(e!=null&&e.errors)return{...e,data:[]};throw e}function qn(e){if(e.errors)return{...e,data:null};throw e}const ui=Symbol("INTERNAL_USER_AGENT_OVERRIDE");var Ae;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnStreamEvent="7",e.Generation="8",e.UpdateConversation="9"})(Ae||(Ae={}));const Be=e=>({category:"ai",action:e});function er(e){return e?{[ui]:e}:void 0}const tg=e=>{var t;return typeof((t=e==null?void 0:e.token)==null?void 0:t.value)=="symbol"};function tr(e,t,n,r,i,s,o){const a=r.arguments!==void 0;return(...u)=>{const l=u[u.length-1];let d,f;if(i)if(tg(u[0]))d=u[0];else throw new Error(`Invalid first argument passed to ${r.name}. Expected contextSpec`);return a&&(i?f=u[1]:f=u[0]),n==="subscription"?og(e,t,r,s,f,l,o):sg(e,t,n,r,s,f,l,d,o)}}function at(e,t){return typeof e[t]=="string"}function ng(e){return e instanceof Object&&"enum"in e}function rg(e){return e instanceof Object&&"input"in e}function ig({type:e,isRequired:t}){const n=t?"!":"";return ng(e)?`${e.enum}${n}`:rg(e)?`${e.input}${n}`:`${e}${n}`}function Fa(e){if(e.arguments===void 0)return"";const t=Object.entries(e.arguments).map(([n,r])=>{const i=ig(r),s=r.isArray?`[${i}]${r.isArrayNullable?"":"!"}`:i;return`$${n}: ${s}`}).join(", ");return t.length>0?`(${t})`:""}function qa(e){if(e.arguments===void 0)return"";const t=Object.keys(e.arguments).map(n=>`${n}: $${n}`).join(", ");return t.length>0?`(${t})`:""}function Ka(e,t){if(at(t,"type")||at(t.type,"enum"))return"";if(at(t.type,"nonModel")){const n=e.nonModels[t.type.nonModel];return`{${Fn(Qn(n,e))}}`}else return at(t.type,"model")?`{${Ua(e,t.type.model)}}`:""}function Ba(e,t={}){const n={};if(e.arguments===void 0)return n;for(const r of Object.values(e.arguments))if(typeof t[r.name]<"u")n[r.name]=t[r.name];else if(r.isRequired)throw new Error(`${e.name} requires arguments '${r.name}'`);return n}function sg(e,t,n,r,i,s,o,a,c){return We(async u=>{const{name:l}=r,d=Rt(e,i,o),f=Ct(e,i,o==null?void 0:o.headers),p=Fa(r),h=qa(r),m=Ka(t,r),g=at(r.type,"model")?r.type.model:void 0,E=`
    ${n.toLocaleLowerCase()}${p} {
      ${l}${h} ${m}
    }
  `,S=Ba(r,s),A=er(c);try{const I=a?e.graphql(a,{...d,query:E,variables:S},f):e.graphql({...d,query:E,variables:S,...A},f),v=He(I,u),{data:T,extensions:P}=await v;if(T){const[k]=Object.keys(T),D=Array.isArray(T[k]),q=D?T[k].filter(O=>O):T[k],V=g?qe(e,g,D?q:[q],t,d.authMode,d.authToken,!!a):q;return{data:!D&&Array.isArray(V)?V.shift():V,extensions:P}}else return{data:null,extensions:P}}catch(I){const{data:v,errors:T}=I;if(v&&Object.keys(v).length!==0&&T){const[P]=Object.keys(v),k=Array.isArray(v[P]),D=k?v[P].filter(q=>q):v[P];if(D){const q=g?qe(e,g,k?D:[D],t,d.authMode,d.authToken,!!a):D;return{data:!k&&Array.isArray(q)?q.shift():q,errors:T}}else return qn(I)}else return qn(I)}})}function og(e,t,n,r,i,s,o){const a="subscription",{name:c}=n,u=Rt(e,r,s),l=Ct(e,r,s==null?void 0:s.headers),d=Fa(n),f=qa(n),p=Ka(t,n),h=at(n.type,"model")?n.type.model:void 0,m=`
    ${a.toLocaleLowerCase()}${d} {
      ${c}${f} ${p}
    }
  `,g=Ba(n,i),E=er(o);return e.graphql({...u,query:m,variables:g,...E},l).pipe(Wr(A=>{const[I]=Object.keys(A.data),v=A.data[I],[T]=h?qe(e,h,[v],t,u.authMode,u.authToken):[v];return T}))}const ag={queries:"query",mutations:"mutation",subscriptions:"subscription"};function li(e,t,n,r){if(!t)return{};const i=t.modelIntrospection;if(!i)return{};const s=i[n];if(!s)return{};const o={},a=r(e).amplify===null;for(const c of Object.values(s))o[c.name]=tr(e,i,ag[n],c,a,r);return o}function cg(e,t,n){return li(e,t,"mutations",n)}function ug(e,t,n){return li(e,t,"queries",n)}function lg(e,t,n){return li(e,t,"subscriptions",n)}function rn(e,t,n,r,i,s=!1,o){return s?(u,l,d)=>ro(e,t,n,l,d,r,i,u,o):(u,l)=>ro(e,t,n,u,l,r,i,void 0,o)}function ro(e,t,n,r,i,s,o,a,c){return We(async u=>{const{name:l}=n,d=Xn(t,n,s,i),f=Zn(n,s,r,t),p=Rt(e,o,i),h=Ct(e,o,i==null?void 0:i.headers),m=er(c);try{const g=a?e.graphql(a,{...p,query:d,variables:f},h):e.graphql({...p,query:d,variables:f,...m},h),E=He(g,u),{data:S,extensions:A}=await E;if(S){const[I]=Object.keys(S),v=Fe(t,l,S[I]);if(v===null)return{data:null,extensions:A};if(i!=null&&i.selectionSet)return{data:v,extensions:A};{const[T]=qe(e,l,[v],t,p.authMode,p.authToken,!!a);return{data:T,extensions:A}}}else return{data:null,extensions:A}}catch(g){const{data:E,errors:S}=g;if(E&&Object.keys(E).length!==0&&S){const[A]=Object.keys(E),I=Fe(t,l,E[A]);if(I){if(i!=null&&i.selectionSet)return{data:I,errors:S};{const[v]=qe(e,l,[I],t,p.authMode,p.authToken,!!a);return{data:v,errors:S}}}else return qn(g)}else return qn(g)}})}function di(e,t,n,r,i=!1,s){return i?(c,u)=>io(e,t,n,r,u,c,s):c=>io(e,t,n,r,c,void 0,s)}function io(e,t,n,r,i,s,o){return We(async a=>{var h,m,g,E;const{name:c}=n,u=Xn(t,n,"LIST",i),l=Zn(n,"LIST",i,t),d=Rt(e,r,i),f=Ct(e,r,i==null?void 0:i.headers),p=er(o);try{const S=s?e.graphql(s,{...d,query:u,variables:l},f):e.graphql({...d,query:u,variables:l,...p},f),A=He(S,a),{data:I,extensions:v}=await A;if(I!==void 0){const[T]=Object.keys(I);if(I[T].items){const P=I[T].items.map(k=>Fe(t,c,k));return i!=null&&i.selectionSet?{data:P,nextToken:I[T].nextToken,extensions:v}:{data:qe(e,c,P,t,d.authMode,d.authToken,!!s),nextToken:I[T].nextToken,extensions:v}}return{data:I[T],nextToken:I[T].nextToken,extensions:v}}}catch(S){const{data:A,errors:I}=S;if(A!=null&&Object.keys(A).length!==0&&I){const[v]=Object.keys(A);if((h=A[v])!=null&&h.items){const T=A[v].items.map(P=>Fe(t,c,P));return T?i!=null&&i.selectionSet?{data:T,nextToken:(m=A[v])==null?void 0:m.nextToken,errors:I}:{data:qe(e,c,T,t,d.authMode,d.authToken,!!s),nextToken:(g=A[v])==null?void 0:g.nextToken,errors:I}:{data:A[v],nextToken:(E=A[v])==null?void 0:E.nextToken,errors:I}}else return Dr(S)}else return Dr(S)}})}const Qe={},xt=new Array(64);for(let e=0,t=65,n=90;e+t<=n;e++){const r=String.fromCharCode(e+t);Qe[r]=e,xt[e]=r}for(let e=0,t=97,n=122;e+t<=n;e++){const r=String.fromCharCode(e+t),i=e+26;Qe[r]=i,xt[i]=r}for(let e=0;e<10;e++){Qe[e.toString(10)]=e+52;const t=e.toString(10),n=e+52;Qe[t]=n,xt[n]=t}Qe["+"]=62;xt[62]="+";Qe["/"]=63;xt[63]="/";const dt=6,$t=8,dg=63,$a=e=>{let t=e.length/4*3;e.slice(-2)==="=="?t-=2:e.slice(-1)==="="&&t--;const n=new ArrayBuffer(t),r=new DataView(n);for(let i=0;i<e.length;i+=4){let s=0,o=0;for(let u=i,l=i+3;u<=l;u++)if(e[u]!=="="){if(!(e[u]in Qe))throw new TypeError(`Invalid character ${e[u]} in base64 string.`);s|=Qe[e[u]]<<(l-u)*dt,o+=dt}else s>>=dt;const a=i/4*3;s>>=o%$t;const c=Math.floor(o/$t);for(let u=0;u<c;u++){const l=(c-u-1)*$t;r.setUint8(a+u,(s&255<<l)>>l)}}return new Uint8Array(n)},fg=e=>new TextEncoder().encode(e);function Va(e){let t;typeof e=="string"?t=fg(e):t=e;const n=typeof t=="object"&&typeof t.length=="number",r=typeof t=="object"&&typeof t.byteOffset=="number"&&typeof t.byteLength=="number";if(!n&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let i="";for(let s=0;s<t.length;s+=3){let o=0,a=0;for(let u=s,l=Math.min(s+3,t.length);u<l;u++)o|=t[u]<<(l-u-1)*$t,a+=$t;const c=Math.ceil(a/dt);o<<=c*dt-a;for(let u=1;u<=c;u++){const l=(c-u)*dt;i+=xt[(o&dg<<l)>>l]}i+="==".slice(0,4-c)}return i}const pg=e=>e.map(t=>t.image?Wa(t):t.document?hg(t):t.toolUse?gg(t):t.toolResult?yg(t):Ha(t)),Wa=({image:e})=>({image:{...e,source:{...e.source,bytes:$a(e.source.bytes)}}}),hg=({document:e})=>({document:{...e,source:{...e.source,bytes:$a(e.source.bytes)}}}),mg=({json:e})=>({json:JSON.parse(e)}),gg=({toolUse:e})=>({toolUse:{...e,input:JSON.parse(e.input)}}),yg=({toolResult:e})=>({toolResult:{toolUseId:e.toolUseId,content:e.content.map(t=>t.image?Wa(t):t.json?mg(t):Ha(t))}}),Ha=e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==null)),ja=({content:e,createdAt:t,id:n,conversationId:r,role:i})=>({content:pg(e??[]),conversationId:r,createdAt:t,id:n,role:i}),Eg=(e,t,n,r,i)=>async s=>{const o=di(e,t,r,i,!1,Be(Ae.ListMessages)),{data:a,nextToken:c,errors:u}=await o({...s,filter:{conversationId:{eq:n}}});return{data:a.map(l=>ja(l)),nextToken:c,errors:u}},vg=({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:r,contentBlockDoneAtIndex:i,contentBlockDeltaIndex:s,contentBlockText:o,contentBlockToolUse:a,stopReason:c,errors:u})=>u?{error:{id:e,conversationId:t,associatedUserMessageId:n,errors:u}}:{next:Ig({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:r,contentBlockDoneAtIndex:i,contentBlockDeltaIndex:s,text:o,toolUse:Sg(a),stopReason:c})},Sg=e=>{if(e)return{...e,input:JSON.parse(e.input)}},Ig=e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==null)),Ag=(e,t,n,r,i)=>s=>{const{conversations:o}=t;if(!o)return{};const a=o[r].message.subscribe;return tr(e,t,"subscription",a,!1,i,Be(Ae.OnStreamEvent))({conversationId:n}).subscribe(u=>{const{next:l,error:d}=vg(u);d&&s.error(d),l&&s.next(l)})},wg=e=>JSON.stringify(e),bg=e=>e.map(t=>t.image?Ga(t):t.document?Ng(t):t.toolResult?Cg(t):t),Tg=({tools:e})=>({tools:Object.entries(e).map(([t,n])=>({toolSpec:{name:t,description:n.description,inputSchema:{json:JSON.stringify(n.inputSchema.json)}}}))}),Ga=({image:e})=>({image:{...e,source:{...e.source,bytes:Va(e.source.bytes)}}}),Ng=({document:e})=>({document:{...e,source:{...e.source,bytes:Va(e.source.bytes)}}}),Rg=({json:e})=>({json:JSON.stringify(e)}),Cg=({toolResult:e})=>({toolResult:{...e,content:e.content.map(t=>t.image?Ga(t):t.json?Rg(t):t)}}),xg=(e,t,n,r,i)=>async s=>{const{conversations:o}=t;if(!o)return{};const a=typeof s=="string"?{content:[{text:s}]}:s,{content:c,aiContext:u,toolConfiguration:l}=a,d=o[r].message.send,f=tr(e,t,"mutation",d,!1,i,Be(Ae.SendMessage)),{data:p,errors:h}=await f({conversationId:n,content:bg(c),...u&&{aiContext:wg(u)},...l&&{toolConfiguration:Tg(l)}});return{data:p&&ja(p),errors:h}},sn=(e,t,n,r,i,s,o,a,c,u)=>{if(!n)throw new Error(`An error occurred converting a ${s} conversation: Missing ID`);return{id:n,createdAt:r,updatedAt:i,metadata:c,name:u,onStreamEvent:Ag(e,t,n,s,a),sendMessage:xg(e,t,n,s,a),listMessages:Eg(e,t,n,o,a)}},_g=(e,t,n,r,i,s)=>async o=>{const{name:a,metadata:c}=o??{},u=JSON.stringify(c),l=rn(e,t,r,"CREATE",s,!1,Be(Ae.CreateConversation)),{data:d,errors:f}=await l({name:a,metadata:u});return{data:sn(e,t,d==null?void 0:d.id,d==null?void 0:d.createdAt,d==null?void 0:d.updatedAt,n,i,s,d==null?void 0:d.metadata,d==null?void 0:d.name),errors:f}},Pg=(e,t,n,r,i,s)=>async({id:o})=>{const a=rn(e,t,r,"GET",s,!1,Be(Ae.GetConversation)),{data:c,errors:u}=await a({id:o});return{data:c&&sn(e,t,c.id,c.createdAt,c.updatedAt,n,i,s,c==null?void 0:c.metadata,c==null?void 0:c.name),errors:u}},Og=(e,t,n,r,i,s)=>async o=>{const a=di(e,t,r,s,!1,Be(Ae.ListConversations)),{data:c,nextToken:u,errors:l}=await a(o);return{data:c.map(d=>sn(e,t,d.id,d.createdAt,d.updatedAt,n,i,s,d==null?void 0:d.metadata,d==null?void 0:d.name)),nextToken:u,errors:l}},kg=(e,t,n,r,i,s)=>async({id:o})=>{const a=rn(e,t,r,"DELETE",s,!1,Be(Ae.DeleteConversation)),{data:c,errors:u}=await a({id:o});return{data:c&&sn(e,t,c==null?void 0:c.id,c==null?void 0:c.createdAt,c==null?void 0:c.updatedAt,n,i,s,c==null?void 0:c.metadata,c==null?void 0:c.name),errors:u}},Dg=(e,t,n,r,i,s)=>async({id:o,metadata:a,name:c})=>{const u=JSON.stringify(a),l=rn(e,t,r,"UPDATE",s,!1,Be(Ae.UpdateConversation)),{data:d,errors:f}=await l({id:o,metadata:u,name:c});return{data:d&&sn(e,t,d==null?void 0:d.id,d==null?void 0:d.createdAt,d==null?void 0:d.updatedAt,n,i,s,d==null?void 0:d.metadata,d==null?void 0:d.name),errors:f}};function Lg(e,t,n){const r=t==null?void 0:t.modelIntrospection;if(!(r!=null&&r.conversations))return{};const i={};for(const{name:s,conversation:o,message:a,models:c,nonModels:u,enums:l}of Object.values(r.conversations)){const d=c[o.modelName],f=c[a.modelName];if(!d||!f)return{};const p={...r,models:{...r.models,...c},nonModels:{...r.nonModels,...u},enums:{...r.enums,...l}};i[s]={update:Dg(e,p,s,d,f,n),create:_g(e,p,s,d,f,n),get:Pg(e,p,s,d,f,n),delete:kg(e,p,s,d,f,n),list:Og(e,p,s,d,f,n)}}return i}function Mg(e,t,n){const r=t==null?void 0:t.modelIntrospection;if(!(r!=null&&r.generations))return{};const i={};for(const s of Object.values(r.generations))i[s.name]=tr(e,r,"query",s,!1,n,Be(Ae.Generation));return i}const Ug=e=>{const t=e.modelIntrospection;if(!t)return{};const n={};for(const[r,i]of Object.entries(t.enums))n[i.name]={values:()=>i.values};return n};function Fg(e,t,n,r,i,s=!1){return s?(c,u,l)=>so(e,t,n,r,i,{...u,...l},c):(c,u)=>so(e,t,n,r,i,{...c,...u})}function qg(e,t,n,r,i){const{data:s,extensions:o}=n,[a]=Object.keys(s);if(s[a].items){const c=s[a].items.map(u=>Fe(e,t,u));return{data:r?c:i(c),nextToken:s[a].nextToken,extensions:o}}return{data:s[a],nextToken:s[a].nextToken,extensions:o}}function so(e,t,n,r,i,s,o){return We(async a=>{var p,h,m,g;const{name:c}=n,u=Xn(t,n,"INDEX_QUERY",s,r),l=Zn(n,"INDEX_QUERY",s,t,r),d=Rt(e,i,s),f=E=>qe(e,c,E,t,d.authMode,d.authToken,!!o);try{const E=Ct(e,i,s==null?void 0:s.headers),A=[{...d,query:u,variables:l},E];o!==void 0&&A.unshift(o);const I=e.graphql(...A),T=await He(I,a);if(T.data!==void 0)return qg(t,c,T,s==null?void 0:s.selectionSet,f)}catch(E){const{data:S,errors:A}=E;if(S!=null&&Object.keys(S).length!==0&&A){const[I]=Object.keys(S);if((p=S[I])!=null&&p.items){const v=(h=S[I])==null?void 0:h.items.map(T=>Fe(t,c,T));if(v)return{data:s!=null&&s.selectionSet?v:f(v),nextToken:(m=S[I])==null?void 0:m.nextToken}}return{data:S[I],nextToken:(g=S[I])==null?void 0:g.nextToken}}else return Dr(E)}})}function Kg(e,t,n,r,i){const{name:s}=n;return a=>{const c=Xn(t,n,r,a),u=Zn(n,r,a,t),l=Rt(e,i,a),d=Ct(e,i,a==null?void 0:a.headers);return e.graphql({...l,query:c,variables:u},d).pipe(Wr(p=>{const[h]=Object.keys(p.data),m=p.data[h],g=Fe(t,s,m);if(g===null)return null;if(a!=null&&a.selectionSet)return g;{const[E]=qe(e,s,[g],t,l.authMode,l.authToken);return E}}))}}function Bg(e){const{primaryKeyFieldName:t,sortKeyFieldNames:n}=e.primaryKeyInfo;return[t,...n]}function $g(e,t,n){const r=Object.fromEntries(n.map(i=>[i,e[i]]));for(let i=0;i<t.length;i++)if(Object.keys(r).every(s=>r[s]===t[i][s]))return i;return-1}function Vg(e,t){const{name:n}=t;return i=>new oe(s=>{const o=[],a=[];let c=(...h)=>a.push(...h);const u=e[n].onCreate(i).subscribe({next(h){c({item:h,type:"create"})},error(h){s.error({type:"onCreate",error:h})}}),l=e[n].onUpdate(i).subscribe({next(h){c({item:h,type:"update"})},error(h){s.error({type:"onUpdate",error:h})}}),d=e[n].onDelete(i).subscribe({next(h){c({item:h,type:"delete"})},error(h){s.error({type:"onDelete",error:h})}});function f(h){for(const m of h){const g=$g(m.item,o,p);switch(m.type){case"create":g<0&&o.push(m.item);break;case"update":g>=0&&(o[g]=m.item);break;case"delete":g>=0&&o.splice(g,1);break;default:console.error("Unrecognized message in observeQuery.",m)}}s.next({items:o,isSynced:!0})}const p=Bg(t);return(async()=>{let h=!0,m=null;for(;!s.closed&&(h||m);){h=!1;const{data:g,errors:E,nextToken:S}=await e[n].list({...i,nextToken:m});m=S,o.push(...g);const A=a.length===0&&m==null;if(s.next({items:o,isSynced:A}),Array.isArray(E))for(const I of E)s.error(I)}a.length>0&&f(a),c=(...g)=>(f(g),o.length)})(),()=>{u.unsubscribe(),l.unsubscribe(),d.unsubscribe()}})}const Wg=e=>{var t,n,r;return e.type==="key"&&((t=e.properties)==null?void 0:t.name)&&((n=e.properties)==null?void 0:n.queryField)&&((r=e.properties)==null?void 0:r.fields.length)>0},Hg=e=>{var n;return((n=e.attributes)==null?void 0:n.filter(Wg).map(r=>{const i=r.properties.queryField,[s,...o]=r.properties.fields;return{queryField:i,pk:s,sk:o}}))||[]},jg=(e,t)=>{var a;const n=(a=e.models[t].attributes)==null?void 0:a.find(c=>c.type==="model"),r={queries:["list","get","observeQuery"],mutations:["create","update","delete"],subscriptions:["onCreate","onUpdate","onDelete"]},i=[];if(!n)return Or;if(n.properties)for(const[c,u]of Object.entries(n.properties))c in r&&(u===null?i.push(...r[c]):u instanceof Object&&i.push(...Object.keys(u)));i.includes("list")&&i.push("observeQuery");const s=i.map(c=>c.toUpperCase());return Object.fromEntries(Object.entries(Or).filter(([c])=>!s.includes(c)))};function Gg(e,t,n){const r={},i=t.modelIntrospection;if(!i)return{};const s=["ONCREATE","ONUPDATE","ONDELETE"];for(const o of Object.values(i.models)){const{name:a}=o;r[a]={};const c=jg(i,a);Object.entries(c).forEach(([l,{operationPrefix:d}])=>{const f=l;f==="LIST"?r[a][d]=di(e,i,o,n):s.includes(f)?r[a][d]=Kg(e,i,o,f,n):f==="OBSERVEQUERY"?r[a][d]=Vg(r,o):r[a][d]=rn(e,i,o,f,n)});const u=Hg(o);for(const l of u)r[a][l.queryField]=Fg(e,i,o,l,n)}return r}function za(e,t,n){return Ym(e),e.models=Gg(e,t,n),e.enums=Ug(t),e.queries=ug(e,t,n),e.mutations=cg(e,t,n),e.subscriptions=lg(e,t,n),e.conversations=Lg(e,t,n),e.generations=Mg(e,t,n),e}function zg(e){return ui in e}class Yg extends Gm{getModuleName(){return"GraphQLAPI"}graphql(t,n,r){const i={category:Pn.API,action:mr.GraphQl};if(zg(n)){const{[ui]:s,...o}=n;return super.graphql(t,o,r,{...i,...s})}return super.graphql(t,n,r,{...i})}isCancelError(t){return super.isCancelError(t)}cancel(t,n){return super.cancel(t,n)}}const fi=new Yg;function Jg(e,t){const n=ci(this),r=n.endpoint,i=n.authMode,s=n.apiKey;if(e.authMode=e.authMode||i,e.apiKey=e.apiKey??s,e.authToken=e.authToken||n.authToken,r&&e.authMode==="apiKey"&&!e.apiKey)throw new Error("graphql() requires an explicit `apiKey` for a custom `endpoint` when `authMode = 'apiKey'`.");const o=t||n.headers;return fi.graphql(n.amplify,{...e,endpoint:r},o)}function Qg(e,t){return fi.cancel(e,t)}function Xg(e){return fi.isCancelError(e)}function Ya(e){return e!==void 0}function Zg(e){return e.event==="configure"}function ey(e){var r;const t={[ka]:e.amplify,[Rn]:e.authMode,[Da]:e.authToken,[Pr]:"apiKey"in e?e.apiKey:void 0,[Cn]:"endpoint"in e?e.endpoint:void 0,[La]:e.headers,graphql:Jg,cancel:Qg,isCancelError:Xg,models:Dt,enums:Dt,queries:Dt,mutations:Dt,subscriptions:Dt},n=(r=e.amplify.getConfig().API)==null?void 0:r.GraphQL;if(t[Cn]){if(!t[Rn])throw new Error("generateClient() requires an explicit `authMode` when `endpoint` is provided.");if(t[Rn]==="apiKey"&&!t[Pr])throw new Error("generateClient() requires an explicit `apiKey` when `endpoint` is provided and `authMode = 'apiKey'`.")}return t[Cn]||(Ya(n)?za(t,n,ci):ty(t)),t}const ty=e=>{Ye.listen("core",t=>{var r;if(!Zg(t.payload))return;const n=(r=t.payload.data.API)==null?void 0:r.GraphQL;Ya(n)&&za(e,n,ci)})},Dt=new Proxy({},{get(){throw new Error("Client could not be generated. This is likely due to `Amplify.configure()` not being called prior to `generateClient()` or because the configuration passed to `Amplify.configure()` is missing GraphQL provider configuration.")}});function ny(e){return ey({amplify:B})}const ry={user_pool_id:"us-east-1_KnQjYWRfE",aws_region:"us-east-1",user_pool_client_id:"2co2nrfab8pftc7oog99qdluu3",identity_pool_id:"us-east-1:4a029cfd-3ce1-45ce-8dae-8770333af96b",mfa_methods:[],standard_required_attributes:["email"],username_attributes:["email"],user_verification_types:["email"],groups:[],mfa_configuration:"NONE",password_policy:{min_length:8,require_lowercase:!0,require_numbers:!0,require_symbols:!0,require_uppercase:!0},unauthenticated_identities_enabled:!0},iy=JSON.parse('{"url":"https://sctbcpga3zcmzc6kbin23prnju.appsync-api.us-east-1.amazonaws.com/graphql","aws_region":"us-east-1","api_key":"da2-6vqawsay75herjeq3ozehv5rny","default_authorization_type":"AMAZON_COGNITO_USER_POOLS","authorization_types":["API_KEY","AWS_IAM"],"model_introspection":{"version":1,"models":{"UserProfile":{"name":"UserProfile","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"userId":{"name":"userId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"username":{"name":"username","isArray":false,"type":"String","isRequired":true,"attributes":[]},"email":{"name":"email","isArray":false,"type":"String","isRequired":true,"attributes":[]},"currentSeason":{"name":"currentSeason","isArray":false,"type":"String","isRequired":true,"attributes":[]},"totalSurvivedRaces":{"name":"totalSurvivedRaces","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"isEliminated":{"name":"isEliminated","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"eliminatedAt":{"name":"eliminatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"preferredTeam":{"name":"preferredTeam","isArray":false,"type":"String","isRequired":false,"attributes":[]},"timeZone":{"name":"timeZone","isArray":false,"type":"String","isRequired":false,"attributes":[]},"notificationsEnabled":{"name":"notificationsEnabled","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"joinedAt":{"name":"joinedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"lastActiveAt":{"name":"lastActiveAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"picks":{"name":"picks","isArray":true,"type":{"model":"DriverPick"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["userId"]}},"leagueMemberships":{"name":"leagueMemberships","isArray":true,"type":{"model":"LeagueMember"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["userId"]}},"ownedLeagues":{"name":"ownedLeagues","isArray":true,"type":{"model":"League"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["ownerId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"UserProfiles","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"provider":"userPools","ownerField":"owner","allow":"owner","identityClaim":"cognito:username","operations":["create","update","delete","read"]},{"allow":"private","operations":["read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"League":{"name":"League","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"leagueId":{"name":"leagueId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"name":{"name":"name","isArray":false,"type":"String","isRequired":true,"attributes":[]},"description":{"name":"description","isArray":false,"type":"String","isRequired":false,"attributes":[]},"inviteCode":{"name":"inviteCode","isArray":false,"type":"String","isRequired":true,"attributes":[]},"ownerId":{"name":"ownerId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"season":{"name":"season","isArray":false,"type":"String","isRequired":true,"attributes":[]},"maxMembers":{"name":"maxMembers","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"isPrivate":{"name":"isPrivate","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"autoPickEnabled":{"name":"autoPickEnabled","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"status":{"name":"status","isArray":false,"type":{"enum":"LeagueStatus"},"isRequired":false,"attributes":[]},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"lastActiveAt":{"name":"lastActiveAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"settings":{"name":"settings","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"owner":{"name":"owner","isArray":false,"type":{"model":"UserProfile"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["ownerId"]}},"members":{"name":"members","isArray":true,"type":{"model":"LeagueMember"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["leagueId"]}},"picks":{"name":"picks","isArray":true,"type":{"model":"DriverPick"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["leagueId"]}},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"Leagues","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"provider":"userPools","ownerField":"ownerId","allow":"owner","identityClaim":"cognito:username","operations":["create","update","delete","read"]},{"allow":"private","operations":["read"]},{"groupClaim":"cognito:groups","provider":"userPools","allow":"groups","groups":["administrators"],"operations":["create","update","delete","read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"LeagueMember":{"name":"LeagueMember","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"leagueId":{"name":"leagueId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"userId":{"name":"userId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"status":{"name":"status","isArray":false,"type":{"enum":"LeagueMemberStatus"},"isRequired":false,"attributes":[]},"joinedAt":{"name":"joinedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"eliminatedAt":{"name":"eliminatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"leftAt":{"name":"leftAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"survivedRaces":{"name":"survivedRaces","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"totalPicks":{"name":"totalPicks","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"autoPickCount":{"name":"autoPickCount","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"isOwner":{"name":"isOwner","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"isModerator":{"name":"isModerator","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"league":{"name":"league","isArray":false,"type":{"model":"League"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["leagueId"]}},"user":{"name":"user","isArray":false,"type":{"model":"UserProfile"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["userId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"LeagueMembers","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"provider":"userPools","ownerField":"owner","allow":"owner","identityClaim":"cognito:username","operations":["create","update","delete","read"]},{"allow":"private","operations":["read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"Season":{"name":"Season","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"year":{"name":"year","isArray":false,"type":"String","isRequired":true,"attributes":[]},"name":{"name":"name","isArray":false,"type":"String","isRequired":true,"attributes":[]},"isActive":{"name":"isActive","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"startDate":{"name":"startDate","isArray":false,"type":"AWSDate","isRequired":true,"attributes":[]},"endDate":{"name":"endDate","isArray":false,"type":"AWSDate","isRequired":true,"attributes":[]},"totalRaces":{"name":"totalRaces","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"currentRound":{"name":"currentRound","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"races":{"name":"races","isArray":true,"type":{"model":"Race"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["seasonId"]}},"drivers":{"name":"drivers","isArray":true,"type":{"model":"Driver"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["seasonId"]}},"picks":{"name":"picks","isArray":true,"type":{"model":"DriverPick"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["seasonId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"Seasons","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"public","provider":"apiKey","operations":["read"]},{"allow":"private","operations":["read"]},{"groupClaim":"cognito:groups","provider":"userPools","allow":"groups","groups":["administrators"],"operations":["create","update","delete","read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"Race":{"name":"Race","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"raceId":{"name":"raceId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"seasonId":{"name":"seasonId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"name":{"name":"name","isArray":false,"type":"String","isRequired":true,"attributes":[]},"location":{"name":"location","isArray":false,"type":"String","isRequired":true,"attributes":[]},"country":{"name":"country","isArray":false,"type":"String","isRequired":true,"attributes":[]},"circuit":{"name":"circuit","isArray":false,"type":"String","isRequired":true,"attributes":[]},"round":{"name":"round","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"raceDate":{"name":"raceDate","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"qualifyingDate":{"name":"qualifyingDate","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"pickDeadline":{"name":"pickDeadline","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"status":{"name":"status","isArray":false,"type":{"enum":"RaceStatus"},"isRequired":false,"attributes":[]},"timeLocal":{"name":"timeLocal","isArray":false,"type":"String","isRequired":false,"attributes":[]},"timeGMT":{"name":"timeGMT","isArray":false,"type":"String","isRequired":false,"attributes":[]},"timeZone":{"name":"timeZone","isArray":false,"type":"String","isRequired":false,"attributes":[]},"weather":{"name":"weather","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"season":{"name":"season","isArray":false,"type":{"model":"Season"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["seasonId"]}},"picks":{"name":"picks","isArray":true,"type":{"model":"DriverPick"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["raceId"]}},"results":{"name":"results","isArray":true,"type":{"model":"RaceResult"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["raceId"]}},"qualifyingResults":{"name":"qualifyingResults","isArray":true,"type":{"model":"QualifyingResult"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["raceId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"Races","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"public","provider":"apiKey","operations":["read"]},{"allow":"private","operations":["read"]},{"groupClaim":"cognito:groups","provider":"userPools","allow":"groups","groups":["administrators"],"operations":["create","update","delete","read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"Driver":{"name":"Driver","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"driverId":{"name":"driverId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"seasonId":{"name":"seasonId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"name":{"name":"name","isArray":false,"type":"String","isRequired":true,"attributes":[]},"firstName":{"name":"firstName","isArray":false,"type":"String","isRequired":false,"attributes":[]},"lastName":{"name":"lastName","isArray":false,"type":"String","isRequired":false,"attributes":[]},"nationality":{"name":"nationality","isArray":false,"type":"String","isRequired":false,"attributes":[]},"team":{"name":"team","isArray":false,"type":"String","isRequired":true,"attributes":[]},"teamColor":{"name":"teamColor","isArray":false,"type":"String","isRequired":false,"attributes":[]},"number":{"name":"number","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"isActive":{"name":"isActive","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"imageUrl":{"name":"imageUrl","isArray":false,"type":"String","isRequired":false,"attributes":[]},"profileUrl":{"name":"profileUrl","isArray":false,"type":"String","isRequired":false,"attributes":[]},"season":{"name":"season","isArray":false,"type":{"model":"Season"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["seasonId"]}},"picks":{"name":"picks","isArray":true,"type":{"model":"DriverPick"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["driverId"]}},"results":{"name":"results","isArray":true,"type":{"model":"RaceResult"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["driverId"]}},"qualifyingResults":{"name":"qualifyingResults","isArray":true,"type":{"model":"QualifyingResult"},"isRequired":false,"attributes":[],"isArrayNullable":true,"association":{"connectionType":"HAS_MANY","associatedWith":["driverId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"Drivers","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"public","provider":"apiKey","operations":["read"]},{"allow":"private","operations":["read"]},{"groupClaim":"cognito:groups","provider":"userPools","allow":"groups","groups":["administrators"],"operations":["create","update","delete","read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"DriverPick":{"name":"DriverPick","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"pickId":{"name":"pickId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"userId":{"name":"userId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"seasonId":{"name":"seasonId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"raceId":{"name":"raceId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"leagueId":{"name":"leagueId","isArray":false,"type":"ID","isRequired":false,"attributes":[]},"driverId":{"name":"driverId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"driverName":{"name":"driverName","isArray":false,"type":"String","isRequired":true,"attributes":[]},"teamName":{"name":"teamName","isArray":false,"type":"String","isRequired":true,"attributes":[]},"raceName":{"name":"raceName","isArray":false,"type":"String","isRequired":true,"attributes":[]},"submittedAt":{"name":"submittedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"pickDeadline":{"name":"pickDeadline","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"isAutoPick":{"name":"isAutoPick","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"autoPickReason":{"name":"autoPickReason","isArray":false,"type":"String","isRequired":false,"attributes":[]},"finalPosition":{"name":"finalPosition","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"didFinishInTop10":{"name":"didFinishInTop10","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"survived":{"name":"survived","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"points":{"name":"points","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"eliminatedAt":{"name":"eliminatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"isValid":{"name":"isValid","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"validationErrors":{"name":"validationErrors","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"user":{"name":"user","isArray":false,"type":{"model":"UserProfile"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["userId"]}},"league":{"name":"league","isArray":false,"type":{"model":"League"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["leagueId"]}},"race":{"name":"race","isArray":false,"type":{"model":"Race"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["raceId"]}},"driver":{"name":"driver","isArray":false,"type":{"model":"Driver"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["driverId"]}},"season":{"name":"season","isArray":false,"type":{"model":"Season"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["seasonId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"DriverPicks","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"provider":"userPools","ownerField":"owner","allow":"owner","identityClaim":"cognito:username","operations":["create","update","delete","read"]},{"allow":"private","operations":["read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"RaceResult":{"name":"RaceResult","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"resultId":{"name":"resultId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"raceId":{"name":"raceId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"driverId":{"name":"driverId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"finalPosition":{"name":"finalPosition","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"gridPosition":{"name":"gridPosition","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"fastestLap":{"name":"fastestLap","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"didFinish":{"name":"didFinish","isArray":false,"type":"Boolean","isRequired":false,"attributes":[]},"dnfReason":{"name":"dnfReason","isArray":false,"type":"String","isRequired":false,"attributes":[]},"raceTime":{"name":"raceTime","isArray":false,"type":"String","isRequired":false,"attributes":[]},"gapToWinner":{"name":"gapToWinner","isArray":false,"type":"String","isRequired":false,"attributes":[]},"points":{"name":"points","isArray":false,"type":"Int","isRequired":false,"attributes":[]},"processedAt":{"name":"processedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"race":{"name":"race","isArray":false,"type":{"model":"Race"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["raceId"]}},"driver":{"name":"driver","isArray":false,"type":{"model":"Driver"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["driverId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"RaceResults","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"public","provider":"apiKey","operations":["read"]},{"allow":"private","operations":["read"]},{"groupClaim":"cognito:groups","provider":"userPools","allow":"groups","groups":["administrators"],"operations":["create","update","delete","read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"QualifyingResult":{"name":"QualifyingResult","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"qualifyingId":{"name":"qualifyingId","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"raceId":{"name":"raceId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"driverId":{"name":"driverId","isArray":false,"type":"String","isRequired":true,"attributes":[]},"position":{"name":"position","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"q1Time":{"name":"q1Time","isArray":false,"type":"String","isRequired":false,"attributes":[]},"q2Time":{"name":"q2Time","isArray":false,"type":"String","isRequired":false,"attributes":[]},"q3Time":{"name":"q3Time","isArray":false,"type":"String","isRequired":false,"attributes":[]},"bestLapTime":{"name":"bestLapTime","isArray":false,"type":"String","isRequired":false,"attributes":[]},"processedAt":{"name":"processedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"race":{"name":"race","isArray":false,"type":{"model":"Race"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["raceId"]}},"driver":{"name":"driver","isArray":false,"type":{"model":"Driver"},"isRequired":false,"attributes":[],"association":{"connectionType":"BELONGS_TO","targetNames":["driverId"]}},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[],"isReadOnly":true}},"syncable":true,"pluralName":"QualifyingResults","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"public","provider":"apiKey","operations":["read"]},{"allow":"private","operations":["read"]},{"groupClaim":"cognito:groups","provider":"userPools","allow":"groups","groups":["administrators"],"operations":["create","update","delete","read"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}}},"enums":{"LeagueStatus":{"name":"LeagueStatus","values":["ACTIVE","COMPLETED","PAUSED"]},"LeagueMemberStatus":{"name":"LeagueMemberStatus","values":["ACTIVE","ELIMINATED","LEFT"]},"RaceStatus":{"name":"RaceStatus","values":["SCHEDULED","QUALIFYING","RACE_WEEKEND","COMPLETED"]}},"nonModels":{}}}'),sy="1.4",oy={auth:ry,data:iy,version:sy};Jp.configure(oy);class ay{constructor(){this.client=ny(),this.currentUser=null,this.authStateListeners=[],this.initializeAuthState()}async initializeAuthState(){try{const t=await Kt();this.currentUser=t,this.notifyAuthStateChange(!0)}catch{this.currentUser=null,this.notifyAuthStateChange(!1)}}async signIn(t,n,r=!1){try{console.log("Attempting to sign in:",t);const i=await gp({username:t,password:n});if(console.log("Sign in result:",i),i.nextStep){if(console.log("Sign in requires additional steps:",i.nextStep),i.nextStep.signInStep==="CONFIRM_SIGN_UP")return{success:!1,error:"Please verify your email first",code:"UserNotConfirmedException",needsVerification:!0,email:t};if(i.nextStep.signInStep==="DONE")console.log("Authentication completed successfully");else return{success:!1,error:"Additional authentication step required: "+i.nextStep.signInStep,nextStep:i.nextStep}}return console.log("Sign in successful, creating user profile..."),this.currentUser=i,await this.createOrUpdateUserProfile(i),this.notifyAuthStateChange(!0),{success:!0,user:i}}catch(i){return console.error("Sign in error:",i),this.handleAuthError(i)}}async signUp(t,n){try{console.log("Attempting to sign up:",t);const r=await Ip({username:t,password:n,options:{userAttributes:{email:t}}});return{success:!0,userId:r.userId,nextStep:r.nextStep,needsVerification:r.nextStep.signUpStep==="CONFIRM_SIGN_UP"}}catch(r){return console.error("Sign up error:",r),this.handleAuthError(r)}}async confirmSignUp(t,n){try{console.log("Confirming sign up for:",t);const r=await xp({username:t,confirmationCode:n});return r.isSignUpComplete?{success:!0,autoSignIn:!0}:{success:!0,nextStep:r.nextStep}}catch(r){return console.error("Confirm sign up error:",r),this.handleAuthError(r)}}async resendSignUpCode(t){try{return console.log("Resending verification code for:",t),await Rp({username:t}),{success:!0}}catch(n){return console.error("Resend code error:",n),this.handleAuthError(n)}}async resetPassword(t){try{console.log("Initiating password reset for:",t);const n=await wp({username:t});return console.log("Password reset initiated:",n),{success:!0,nextStep:n.nextStep,codeDeliveryDetails:n.nextStep.resetPasswordStep==="CONFIRM_RESET_PASSWORD_WITH_CODE"?n.nextStep.codeDeliveryDetails:null}}catch(n){return console.error("Reset password error:",n),n.name==="UserNotFoundException"?{success:!1,error:"No account found with this email address",code:n.name}:n.name==="InvalidParameterException"?{success:!1,error:"Please enter a valid email address",code:n.name}:this.handleAuthError(n)}}async confirmResetPassword(t,n,r){try{return console.log("Confirming password reset for:",t),await Tp({username:t,confirmationCode:n,newPassword:r}),console.log("Password reset successful"),{success:!0}}catch(i){return console.error("Confirm reset password error:",i),this.handleAuthError(i)}}async createOrUpdateUserProfile(t){var n,r;try{const i=t.userId||t.username;if(console.log("Creating/updating user profile for:",i),(await this.client.models.UserProfile.get({userId:i})).data)await this.client.models.UserProfile.update({userId:i,lastActiveAt:new Date().toISOString()}),console.log("Updated existing user profile");else{const o=this.generateUsername(((n=t.signInDetails)==null?void 0:n.loginId)||i);await this.client.models.UserProfile.create({userId:i,username:o,email:((r=t.signInDetails)==null?void 0:r.loginId)||i,currentSeason:"2025",totalSurvivedRaces:0,isEliminated:!1,notificationsEnabled:!0,joinedAt:new Date().toISOString()}),console.log("Created new user profile"),await this.migrateLocalStoragePicks(i)}}catch(i){console.error("Error managing user profile:",i)}}generateUsername(t){return t?t.split("@")[0].replace(/[^a-zA-Z0-9]/g,""):`Player${Math.floor(Math.random()*1e4)}`}async migrateLocalStoragePicks(t){try{const n=JSON.parse(localStorage.getItem("f1survivor_user_picks")||"{}");if(n.picks&&n.picks.length>0){console.log("Migrating picks from localStorage:",n.picks.length);for(const r of n.picks)(await this.client.models.DriverPick.list({filter:{userId:{eq:t},raceId:{eq:r.raceId}}})).data.length===0&&await this.client.models.DriverPick.create({userId:t,seasonId:"2025",raceId:r.raceId,driverId:r.driverId.toString(),driverName:r.driverName,teamName:r.teamName,raceName:r.raceName||"",submittedAt:r.timestamp,pickDeadline:new Date(r.timestamp).toISOString(),isAutoPick:r.isAutoPick||!1});localStorage.removeItem("f1survivor_user_picks"),console.log("Successfully migrated picks from localStorage")}}catch(n){console.error("Error migrating picks:",n)}}async signOut(){try{return console.log("Signing out user"),await Bp(),this.currentUser=null,this.notifyAuthStateChange(!1),sessionStorage.clear(),{success:!0}}catch(t){return console.error("Sign out error:",t),this.handleAuthError(t)}}async getCurrentUser(){try{if(this.currentUser)return this.currentUser;const t=await Kt();return this.currentUser=t,t}catch{return null}}async isAuthenticated(){try{return await Kt(),!0}catch{return!1}}async getSession(){try{return await Hr()}catch{return null}}onAuthStateChange(t){return this.authStateListeners.push(t),this.isAuthenticated().then(n=>t(n)),()=>{const n=this.authStateListeners.indexOf(t);n>-1&&this.authStateListeners.splice(n,1)}}notifyAuthStateChange(t){this.authStateListeners.forEach(n=>{n(t)})}handleAuthError(t){return{success:!1,error:{UserNotFoundException:"No account found with this email",NotAuthorizedException:"Incorrect email or password",UserNotConfirmedException:"Please verify your email first",UsernameExistsException:"An account with this email already exists",InvalidPasswordException:"Password does not meet requirements",LimitExceededException:"Too many attempts. Please try again later",NetworkError:"Network error. Please check your connection",CodeMismatchException:"Invalid verification code",ExpiredCodeException:"Verification code has expired",InvalidParameterException:"Please check your input and try again"}[t.name]||t.message||"Authentication failed",code:t.name}}}const Ze=new ay;class cy{constructor(){this.modal=null,this.currentForm="signin",this.pendingEmail="",this.isInitialized=!1,this.init()}async init(){if(!this.isInitialized)try{await this.loadAuthModal(),this.setupEventListeners(),this.setupPasswordValidation(),this.isInitialized=!0,console.log("Auth UI initialized successfully")}catch(t){console.error("Failed to initialize Auth UI:",t)}}async loadAuthModal(){try{const t=await fetch("/auth-modal.html");if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.text(),r=document.createElement("div");r.innerHTML=n,document.body.appendChild(r.firstElementChild),this.modal=document.getElementById("auth-modal"),console.log("Auth modal loaded successfully")}catch(t){console.error("Failed to load auth modal:",t),console.log("Using fallback modal creation"),this.createComprehensiveModal()}}createComprehensiveModal(){console.log("Creating comprehensive fallback modal"),document.body.insertAdjacentHTML("beforeend",`
      <div id="auth-modal" class="auth-modal">
        <div class="auth-modal-content">
          <button class="close-btn" id="close-auth-modal">&times;</button>
          
          <!-- Tab Navigation -->
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="signin">Sign In</button>
            <button class="auth-tab" data-tab="signup">Sign Up</button>
          </div>
          
          <!-- Sign In Form -->
          <form id="signin-form" class="auth-form active">
            <h2>Welcome Back</h2>
            <p class="auth-subtitle">Sign in to make your picks</p>
            
            <div class="form-group">
              <input type="email" id="signin-email" placeholder="Email" required>
            </div>
            
            <div class="form-group">
              <input type="password" id="signin-password" placeholder="Password" required>
            </div>
            
            <div class="form-options">
              <label>
                <input type="checkbox" id="remember-me"> Remember me
              </label>
              <a href="#" id="forgot-password-link">Forgot password?</a>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Sign In</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="auth-error" id="signin-error"></div>
          </form>
          
          <!-- Sign Up Form -->
          <form id="signup-form" class="auth-form">
            <h2>Join F1 Survivor</h2>
            <p class="auth-subtitle">Create an account to start playing</p>
            
            <div class="form-group">
              <input type="email" id="signup-email" placeholder="Email" required>
            </div>
            
            <div class="form-group">
              <input type="password" id="signup-password" placeholder="Password" required>
              <div class="password-requirements">
                <span class="requirement" data-req="length">8+ characters</span>
                <span class="requirement" data-req="lowercase">Lowercase</span>
                <span class="requirement" data-req="uppercase">Uppercase</span>
                <span class="requirement" data-req="number">Number</span>
                <span class="requirement" data-req="symbol">Symbol</span>
              </div>
            </div>
            
            <div class="form-group">
              <input type="password" id="signup-confirm" placeholder="Confirm Password" required>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Create Account</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="auth-error" id="signup-error"></div>
          </form>
          
          <!-- Email Verification Form -->
          <form id="verify-form" class="auth-form" style="display: none;">
            <h2>Verify Your Email</h2>
            <p class="auth-subtitle">We sent a verification code to <span id="verify-email"></span></p>
            
            <div class="form-group">
              <input type="text" id="verification-code" placeholder="Enter 6-digit code" maxlength="6" required>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Verify Email</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="form-options">
              <a href="#" id="resend-code-link">Resend code</a>
            </div>
            
            <div class="auth-error" id="verify-error"></div>
          </form>

          <!-- Password Reset Form -->
          <form id="reset-form" class="auth-form" style="display: none;">
            <h2>Reset Password</h2>
            <p class="auth-subtitle">Enter your email to reset your password</p>
            
            <div class="form-group">
              <input type="email" id="reset-email" placeholder="Email" required>
            </div>
            
            <button type="submit" class="cta-button auth-submit">
              <span class="button-text">Send Reset Code</span>
              <span class="loading-spinner" style="display: none;">⏳</span>
            </button>
            
            <div class="form-options">
              <a href="#" id="back-to-signin-link">Back to Sign In</a>
            </div>
            
            <div class="auth-error" id="reset-error"></div>
          </form>
        </div>
      </div>
    `),this.modal=document.getElementById("auth-modal")}setupEventListeners(){if(!this.modal)return;this.modal.querySelectorAll(".auth-tab").forEach(f=>{f.addEventListener("click",p=>{p.preventDefault(),this.switchTab(f.dataset.tab)})});const n=this.modal.querySelector("#close-auth-modal");n&&n.addEventListener("click",()=>this.hideModal()),this.modal.addEventListener("click",f=>{f.target===this.modal&&this.hideModal()}),document.addEventListener("keydown",f=>{f.key==="Escape"&&this.modal.classList.contains("show")&&this.hideModal()});const r=this.modal.querySelector("#signin-form"),i=this.modal.querySelector("#signup-form"),s=this.modal.querySelector("#verify-form"),o=this.modal.querySelector("#reset-form"),a=this.modal.querySelector("#confirm-reset-form");r&&r.addEventListener("submit",f=>this.handleSignIn(f)),i&&i.addEventListener("submit",f=>this.handleSignUp(f)),s&&s.addEventListener("submit",f=>this.handleVerification(f)),o&&o.addEventListener("submit",f=>this.handlePasswordReset(f)),a&&a.addEventListener("submit",f=>this.handleConfirmPasswordReset(f));const c=this.modal.querySelector("#forgot-password-link");c&&c.addEventListener("click",f=>{f.preventDefault(),this.switchTab("reset")});const u=this.modal.querySelector("#resend-code-link");u&&u.addEventListener("click",f=>this.handleResendCode(f));const l=this.modal.querySelector("#back-to-signin-link");l&&l.addEventListener("click",f=>{f.preventDefault(),this.switchTab("signin")});const d=this.modal.querySelector("#back-to-reset-link");d&&d.addEventListener("click",f=>{f.preventDefault(),this.switchTab("reset")})}setupPasswordValidation(){this.setupPasswordValidationForForm("#signup-password","#signup-form"),this.setupPasswordValidationForForm("#new-password","#confirm-reset-form")}setupPasswordValidationForForm(t,n){var o,a;const r=(o=this.modal)==null?void 0:o.querySelector(t),i=(a=this.modal)==null?void 0:a.querySelector(n),s=i==null?void 0:i.querySelectorAll(".requirement");!r||!s.length||r.addEventListener("input",()=>{const c=r.value;s.forEach(u=>{const l=u.dataset.req;let d=!1;switch(l){case"length":d=c.length>=8;break;case"lowercase":d=/[a-z]/.test(c);break;case"uppercase":d=/[A-Z]/.test(c);break;case"number":d=/\d/.test(c);break;case"symbol":d=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(c);break}u.classList.toggle("valid",d),u.classList.toggle("invalid",!d&&c.length>0)})})}async showModal(t="signin"){if(this.modal||(console.log("Modal not ready, initializing..."),await this.init()),!this.modal){console.error("Auth modal could not be initialized");return}this.switchTab(t),this.modal.classList.add("show"),setTimeout(()=>{const n=this.modal.querySelector(".auth-form.active input");n&&n.focus()},100)}hideModal(){this.modal&&(this.modal.classList.remove("show"),this.clearErrors(),this.clearForms())}switchTab(t){if(!this.modal)return;console.log("Switching to tab:",t),this.currentForm=t,this.modal.querySelectorAll(".auth-tab").forEach(s=>{s.classList.toggle("active",s.dataset.tab===t)}),this.modal.querySelectorAll(".auth-form").forEach(s=>{s.style.display="none",s.classList.remove("active")});const i=this.modal.querySelector(`#${t}-form`);i?(i.style.display="block",i.classList.add("active"),console.log("Form displayed:",t,i)):console.error("Form not found:",`#${t}-form`),this.clearErrors()}async handleSignIn(t){var s;t.preventDefault();const n=this.modal.querySelector("#signin-email").value,r=this.modal.querySelector("#signin-password").value,i=((s=this.modal.querySelector("#remember-me"))==null?void 0:s.checked)||!1;this.setLoading("signin",!0),this.clearErrors();try{const o=await Ze.signIn(n,r,i);o.success?(console.log("Sign in successful"),this.showSuccess("signin","Sign in successful!"),setTimeout(()=>{this.hideModal(),this.handleSuccessfulAuth()},1e3)):(console.log("Sign in failed:",o),o.needsVerification?(console.log("User needs email verification"),this.pendingEmail=o.email||n,this.showError("signin",o.error+" Redirecting to verification..."),setTimeout(()=>{this.switchTab("verify"),this.modal.querySelector("#verify-email").textContent=this.pendingEmail,this.clearErrors()},2e3)):this.showError("signin",o.error))}catch(o){console.error("Sign in error:",o),this.showError("signin","An unexpected error occurred. Please try again.")}finally{this.setLoading("signin",!1)}}async handleSignUp(t){t.preventDefault();const n=this.modal.querySelector("#signup-email").value,r=this.modal.querySelector("#signup-password").value,i=this.modal.querySelector("#signup-confirm").value;if(r!==i){this.showError("signup","Passwords do not match");return}if(!this.validatePassword(r)){this.showError("signup","Password does not meet requirements");return}this.setLoading("signup",!0),this.clearErrors();try{const s=await Ze.signUp(n,r);s.success?(console.log("Sign up successful, result:",s),console.log("needsVerification:",s.needsVerification),console.log("nextStep:",s.nextStep),this.pendingEmail=n,s.needsVerification!==!1?(console.log("Switching to verification tab"),this.switchTab("verify"),this.modal.querySelector("#verify-email").textContent=n):(console.log("Auto-confirmed user, showing success"),this.showSuccess("signup","Account created and confirmed successfully!"),setTimeout(()=>this.switchTab("signin"),3e3))):this.showError("signup",s.error)}catch(s){console.error("Sign up error:",s),this.showError("signup","An unexpected error occurred. Please try again.")}finally{this.setLoading("signup",!1)}}async handleVerification(t){t.preventDefault();const n=this.modal.querySelector("#verification-code").value;if(!n||n.length!==6){this.showError("verify","Please enter a valid 6-digit code");return}this.setLoading("verify",!0),this.clearErrors();try{const r=await Ze.confirmSignUp(this.pendingEmail,n);r.success?(console.log("Email verification successful"),this.showSuccess("verify","Email verified successfully!"),r.autoSignIn?setTimeout(async()=>{const i=this.modal.querySelector("#signup-password").value;(await Ze.signIn(this.pendingEmail,i)).success?(this.hideModal(),this.handleSuccessfulAuth()):this.switchTab("signin")},1e3):setTimeout(()=>this.switchTab("signin"),2e3)):this.showError("verify",r.error)}catch(r){console.error("Verification error:",r),this.showError("verify","An unexpected error occurred. Please try again.")}finally{this.setLoading("verify",!1)}}async handleResendCode(t){t.preventDefault();try{const n=await Ze.resendSignUpCode(this.pendingEmail);n.success?this.showSuccess("verify","Verification code sent!"):this.showError("verify",n.error)}catch(n){console.error("Resend code error:",n),this.showError("verify","Failed to resend code. Please try again.")}}async handlePasswordReset(t){t.preventDefault();const n=this.modal.querySelector("#reset-email").value;if(!n){this.showError("reset","Please enter your email address");return}this.setLoading("reset",!0),this.clearErrors();try{console.log("Initiating password reset for:",n);const r=await Ze.resetPassword(n);r.success?(this.pendingEmail=n,this.showSuccess("reset","If an account with this email exists, you will receive a reset code shortly."),setTimeout(()=>{this.switchTab("confirm-reset"),this.modal.querySelector("#confirm-reset-email").textContent=n,this.clearErrors()},2e3)):this.showError("reset",r.error)}catch(r){console.error("Password reset error:",r),this.showError("reset","An unexpected error occurred. Please try again.")}finally{this.setLoading("reset",!1)}}async handleConfirmPasswordReset(t){t.preventDefault();const n=this.modal.querySelector("#reset-code").value,r=this.modal.querySelector("#new-password").value,i=this.modal.querySelector("#confirm-new-password").value;if(!n||n.length!==6){this.showError("confirm-reset","Please enter a valid 6-digit code");return}if(!r){this.showError("confirm-reset","Please enter a new password");return}if(!this.validatePassword(r)){this.showError("confirm-reset","Password does not meet requirements");return}if(r!==i){this.showError("confirm-reset","Passwords do not match");return}this.setLoading("confirm-reset",!0),this.clearErrors();try{console.log("Confirming password reset");const s=await Ze.confirmResetPassword(this.pendingEmail,n,r);s.success?(this.showSuccess("confirm-reset","Password reset successful! You can now sign in."),setTimeout(()=>{this.switchTab("signin"),this.modal.querySelector("#signin-email").value=this.pendingEmail,this.clearForms()},2e3)):this.showError("confirm-reset",s.error)}catch(s){console.error("Confirm password reset error:",s),this.showError("confirm-reset","An unexpected error occurred. Please try again.")}finally{this.setLoading("confirm-reset",!1)}}validatePassword(t){return t.length>=8&&/[a-z]/.test(t)&&/[A-Z]/.test(t)&&/\d/.test(t)&&/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)}setLoading(t,n){const r=this.modal.querySelector(`#${t}-form .auth-submit`),i=r==null?void 0:r.querySelector(".button-text"),s=r==null?void 0:r.querySelector(".loading-spinner");r&&(r.disabled=n),i&&s&&(i.style.display=n?"none":"inline",s.style.display=n?"inline":"none")}showError(t,n){const r=this.modal.querySelector(`#${t}-error`);r&&(r.textContent=n,r.classList.add("show"))}showSuccess(t,n){const r=this.modal.querySelector(".auth-success");r&&r.remove();const i=document.createElement("div");i.className="auth-success show",i.textContent=n;const s=this.modal.querySelector(`#${t}-form`);s&&s.appendChild(i)}clearErrors(){this.modal.querySelectorAll(".auth-error").forEach(r=>{r.classList.remove("show"),r.textContent=""}),this.modal.querySelectorAll(".auth-success").forEach(r=>r.remove())}clearForms(){this.modal.querySelectorAll("form").forEach(r=>r.reset()),this.modal.querySelectorAll(".requirement").forEach(r=>{r.classList.remove("valid","invalid")})}handleSuccessfulAuth(){const t=sessionStorage.getItem("redirectAfterAuth");t?(sessionStorage.removeItem("redirectAfterAuth"),window.location.href=t):window.location.reload()}}const uy=new cy;window.showAuthModal=async(e="signin")=>{await uy.showModal(e)};const ly="modulepreload",dy=function(e,t){return new URL(e,t).href},oo={},fy=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let o=function(l){return Promise.all(l.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const a=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=o(n.map(l=>{if(l=dy(l,r),l in oo)return;oo[l]=!0;const d=l.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(!!r)for(let m=a.length-1;m>=0;m--){const g=a[m];if(g.href===l&&(!d||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":ly,d||(h.as="script"),h.crossOrigin="",h.href=l,u&&h.setAttribute("nonce",u),document.head.appendChild(h),d)return new Promise((m,g)=>{h.addEventListener("load",m),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},on={USER_PICKS:"f1survivor_user_picks",CURRENT_SEASON:"f1survivor_season",USER_SETTINGS:"f1survivor_settings"};function Ja(e,t=null){try{let n=an();console.log("Existing picks before save:",n),Array.isArray(n)||(console.log("Converting existing picks to array"),n=[]);const r=JSON.parse(localStorage.getItem("nextRaceData"));if(!r||!r.raceId)throw new Error("No valid race data found. Cannot save pick.");const i={driverId:parseInt(e),timestamp:new Date().toISOString(),raceId:r.raceId,driverName:(t==null?void 0:t.driverName)||null,teamName:(t==null?void 0:t.teamName)||null,isAutoPick:(t==null?void 0:t.isAutoPick)||!1},s=n.findIndex(a=>a.raceId===r.raceId);s!==-1?(n[s]=i,console.log("Updated existing pick for race:",r.raceId)):(n.push(i),console.log("Added new pick for race:",r.raceId));const o={userId:"local-user",currentSeason:it(),picks:n};return console.log("Saving picks data:",o),localStorage.setItem(on.USER_PICKS,JSON.stringify(o)),i}catch(n){throw console.error("Failed to save picks to localStorage:",n),n}}function an(){try{const e=localStorage.getItem(on.USER_PICKS);if(!e)return[];const t=JSON.parse(e);return t.currentSeason!==it()?[]:t.picks?Array.isArray(t.picks)?t.picks:typeof t.picks=="object"&&t.picks.driverId?[t.picks]:typeof t.picks=="number"?[{driverId:t.picks,timestamp:new Date().toISOString()}]:[]:[]}catch(e){return console.error("Failed to load picks from localStorage:",e),[]}}function it(){return"2025"}function py(e){try{const t=an();if(!Array.isArray(t))return console.error("Picks is not an array:",t),!1;const n=t.some(r=>r.driverId===e);return console.log(`Checking if driver ${e} is picked:`,n),n}catch(t){return console.error("Error checking if driver is picked:",t),!1}}function hy(){try{return localStorage.removeItem(on.USER_PICKS),!0}catch(e){return console.error("Failed to clear pick data:",e),!1}}function my(){try{const e=JSON.parse(localStorage.getItem("nextRaceData"));return e&&an().find(n=>n.raceId===e.raceId)||null}catch(e){return console.error("Failed to get current race pick:",e),null}}function gy(){try{const e=localStorage.getItem("f1survivor_user_picks"),t=e?JSON.parse(e):{userId:"local-user",currentSeason:"2025",picks:[]},n=[{raceId:"bhr-2025",driverId:1,driverName:"Max Verstappen",teamName:"Red Bull Racing",timestamp:"2025-03-02T12:00:00.000Z",isAutoPick:!1},{raceId:"sau-2025",driverId:7,driverName:"Lando Norris",teamName:"McLaren",timestamp:"2025-03-09T12:00:00.000Z",isAutoPick:!1}];return t.picks=[...n,...t.picks],localStorage.setItem("f1survivor_user_picks",JSON.stringify(t)),console.log("Test previous race picks added successfully"),!0}catch(e){return console.error("Failed to add test previous race picks:",e),!1}}const yy=Object.freeze(Object.defineProperty({__proto__:null,STORAGE_KEYS:on,addTestPreviousRacePicks:gy,clearPickData:hy,getCurrentRacePick:my,getCurrentSeason:it,isDriverAlreadyPicked:py,loadUserPicks:an,saveUserPicks:Ja},Symbol.toStringTag,{value:"Module"})),Ey={...on,USER_LEAGUES:"f1survivor_user_leagues",LEAGUE_DATA:"f1survivor_league_data",ACTIVE_LEAGUE:"f1survivor_active_league",USER_ID:"f1survivor_user_id",USER_NAME:"f1survivor_user_name"};class vy{constructor(){this.STORAGE_KEYS=Ey,this.currentUserId=this.getCurrentUserId()}getCurrentUserId(){let t=localStorage.getItem(this.STORAGE_KEYS.USER_ID);return t||(t=`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(this.STORAGE_KEYS.USER_ID,t)),t}getCurrentUsername(){let t=localStorage.getItem(this.STORAGE_KEYS.USER_NAME);return t||(t=`Player${Math.floor(Math.random()*1e4)}`,localStorage.setItem(this.STORAGE_KEYS.USER_NAME,t)),t}setUsername(t){localStorage.setItem(this.STORAGE_KEYS.USER_NAME,t)}getAllLeagues(){try{const t=localStorage.getItem(this.STORAGE_KEYS.LEAGUE_DATA);return t?JSON.parse(t):{}}catch(t){return console.error("Failed to load leagues:",t),{}}}getLeague(t){return this.getAllLeagues()[t]||null}saveLeague(t){try{const n=this.getAllLeagues();return n[t.leagueId]=t,localStorage.setItem(this.STORAGE_KEYS.LEAGUE_DATA,JSON.stringify(n)),!0}catch(n){return console.error("Failed to save league:",n),!1}}getUserLeagueData(){try{const t=localStorage.getItem(this.STORAGE_KEYS.USER_LEAGUES);return t?JSON.parse(t):{userId:this.currentUserId,currentSeason:it(),activeLeagueId:null,leagues:[],createdLeagues:[]}}catch(t){return console.error("Failed to load user league data:",t),{userId:this.currentUserId,currentSeason:it(),activeLeagueId:null,leagues:[],createdLeagues:[]}}}saveUserLeagueData(t){try{return localStorage.setItem(this.STORAGE_KEYS.USER_LEAGUES,JSON.stringify(t)),!0}catch(n){return console.error("Failed to save user league data:",n),!1}}addUserToLeague(t,n=!1){const r=this.getUserLeagueData();r.leagues.includes(t)||r.leagues.push(t),n&&!r.createdLeagues.includes(t)&&r.createdLeagues.push(t),this.saveUserLeagueData(r)}removeUserFromLeague(t){const n=this.getUserLeagueData();n.leagues=n.leagues.filter(r=>r!==t),n.createdLeagues=n.createdLeagues.filter(r=>r!==t),n.activeLeagueId===t&&(n.activeLeagueId=null),this.saveUserLeagueData(n)}getActiveLeagueId(){return this.getUserLeagueData().activeLeagueId}setActiveLeagueId(t){const n=this.getUserLeagueData();n.activeLeagueId=t,this.saveUserLeagueData(n)}getActiveLeague(){const t=this.getActiveLeagueId();return t?this.getLeague(t):null}saveUserPicksWithLeague(t,n,r=null){return r?this.saveLeaguePick(r,t,n):Ja(t,n)}saveLeaguePick(t,n,r){const i=this.getLeague(t);if(!i)throw new Error("League not found");const s=this.getCurrentUserId(),o=JSON.parse(localStorage.getItem("nextRaceData"));if(!o||!o.raceId)throw new Error("No valid race data found. Cannot save pick.");const a={driverId:parseInt(n),timestamp:new Date().toISOString(),raceId:o.raceId,driverName:(r==null?void 0:r.driverName)||null,teamName:(r==null?void 0:r.teamName)||null,isAutoPick:(r==null?void 0:r.isAutoPick)||!1};i.picks||(i.picks={}),i.picks[s]||(i.picks[s]=[]);const c=i.picks[s].findIndex(u=>u.raceId===o.raceId);return c!==-1?i.picks[s][c]=a:i.picks[s].push(a),this.saveLeague(i),a}loadUserPicksWithLeague(t=null){return t?this.loadLeaguePicks(t):an()}loadLeaguePicks(t,n=null){const r=this.getLeague(t);if(!r)return[];const i=n||this.getCurrentUserId();return r.picks&&r.picks[i]?r.picks[i]:[]}isDriverAlreadyPickedInLeague(t,n){return this.loadLeaguePicks(n).some(i=>i.driverId===parseInt(t))}getCurrentRacePickForLeague(t){try{const n=JSON.parse(localStorage.getItem("nextRaceData"));return n&&this.loadLeaguePicks(t).find(i=>i.raceId===n.raceId)||null}catch(n){return console.error("Failed to get current race pick for league:",n),null}}getUserLeagues(){const t=this.getUserLeagueData(),n=this.getAllLeagues();return t.leagues.map(r=>n[r]).filter(r=>r!==null).map(r=>({...r,isOwner:r.ownerId===this.currentUserId}))}findLeagueByInviteCode(t){const n=this.getAllLeagues();return Object.values(n).find(r=>r.inviteCode===t.toUpperCase())||null}}const Qa=new vy;class Sy{constructor(){this.storageManager=Qa,this.currentUserId=this.storageManager.getCurrentUserId(),this.activeLeagueId=this.storageManager.getActiveLeagueId()}async createLeague(t,n={}){if(!t||t.trim().length===0)throw new Error("League name cannot be empty");if(t.trim().length>50)throw new Error("League name cannot exceed 50 characters");const r=this.generateLeagueId(),i=this.generateInviteCode(),s={leagueId:r,leagueName:t.trim(),ownerId:this.currentUserId,inviteCode:i,season:it(),createdAt:new Date().toISOString(),members:[{userId:this.currentUserId,username:this.storageManager.getCurrentUsername(),joinedAt:new Date().toISOString(),status:"ACTIVE",isOwner:!0}],picks:{},settings:{maxMembers:20,isPrivate:!0,autoPickEnabled:!0,...n}};if(!this.storageManager.saveLeague(s))throw new Error("Failed to save league");return this.storageManager.addUserToLeague(r,!0),s}async joinLeague(t){if(!t||t.trim().length===0)throw new Error("Invalid invite code");const n=this.storageManager.findLeagueByInviteCode(t.trim());if(!n)throw new Error("Invalid invite code");if(n.season!==it())throw new Error("This league is from a different season");if(n.members.some(i=>i.userId===this.currentUserId))throw new Error("Already a member of this league");if(n.members.length>=n.settings.maxMembers)throw new Error("League is full");const r={userId:this.currentUserId,username:this.storageManager.getCurrentUsername(),joinedAt:new Date().toISOString(),status:"ACTIVE",isOwner:!1};if(n.members.push(r),n.picks||(n.picks={}),n.picks[this.currentUserId]=[],!this.storageManager.saveLeague(n))throw new Error("Failed to join league");return this.storageManager.addUserToLeague(n.leagueId,!1),n}async leaveLeague(t){const n=this.storageManager.getLeague(t);if(!n)throw new Error("League not found");const r=n.members.findIndex(i=>i.userId===this.currentUserId);if(r===-1)throw new Error("Not a member of this league");if(n.ownerId===this.currentUserId)throw new Error("League owner cannot leave. Delete the league instead.");if(n.members.splice(r,1),n.picks&&n.picks[this.currentUserId]&&delete n.picks[this.currentUserId],!this.storageManager.saveLeague(n))throw new Error("Failed to leave league");return this.storageManager.removeUserFromLeague(t),!0}async deleteLeague(t){const n=this.storageManager.getLeague(t);if(!n)throw new Error("League not found");if(n.ownerId!==this.currentUserId)throw new Error("Only the league owner can delete the league");n.members.forEach(i=>{i.userId,this.currentUserId});const r=this.storageManager.getAllLeagues();return delete r[t],localStorage.setItem("f1survivor_league_data",JSON.stringify(r)),this.storageManager.removeUserFromLeague(t),!0}async kickMember(t,n){const r=this.storageManager.getLeague(t);if(!r)throw new Error("League not found");if(r.ownerId!==this.currentUserId)throw new Error("Only the league owner can kick members");if(n===this.currentUserId)throw new Error("Cannot kick yourself from the league");const i=r.members.findIndex(s=>s.userId===n);if(i===-1)throw new Error("Member not found in league");if(r.members.splice(i,1),r.picks&&r.picks[n]&&delete r.picks[n],!this.storageManager.saveLeague(r))throw new Error("Failed to kick member");return!0}async updateLeagueSettings(t,n){const r=this.storageManager.getLeague(t);if(!r)throw new Error("League not found");if(r.ownerId!==this.currentUserId)throw new Error("Only the league owner can update settings");if(n.maxMembers&&n.maxMembers<r.members.length)throw new Error("Cannot set max members below current member count");if(r.settings={...r.settings,...n},!this.storageManager.saveLeague(r))throw new Error("Failed to update league settings");return r}getLeagueStandings(t){const n=this.storageManager.getLeague(t);if(!n)throw new Error("League not found");const r=n.members.map(i=>{const s=n.picks[i.userId]||[],o=s.length;return{userId:i.userId,username:i.username,survivedRaces:o,totalPicks:s.length,lastPick:s[s.length-1]||null,isEliminated:!1,isOwner:i.isOwner}});return r.sort((i,s)=>s.survivedRaces-i.survivedRaces),r}generateLeagueId(){return`league_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateInviteCode(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let r=0;r<8;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}getActiveLeague(){return this.storageManager.getActiveLeague()}setActiveLeague(t){this.storageManager.setActiveLeagueId(t),this.activeLeagueId=t}getUserLeagues(){return this.storageManager.getUserLeagues()}isLeagueOwner(t){const n=this.storageManager.getLeague(t);return n&&n.ownerId===this.currentUserId}getLeague(t){return this.storageManager.getLeague(t)}previewLeague(t){const n=this.storageManager.findLeagueByInviteCode(t.trim());return n?{leagueName:n.leagueName,memberCount:n.members.length,maxMembers:n.settings.maxMembers,season:n.season,createdAt:n.createdAt}:null}}const Xa=new Sy;class Iy{constructor(){this.leagueManager=Xa,this.activeModal=null}showCreateLeagueModal(){this.closeActiveModal(),document.body.insertAdjacentHTML("beforeend",`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content">
          <button class="close-btn">&times;</button>
          <h3>Create New League</h3>
          
          <form id="create-league-form">
            <div class="form-group">
              <label for="league-name">League Name</label>
              <input type="text" id="league-name" maxlength="50" required>
              <small>Choose a memorable name for your league</small>
            </div>
            
            <div class="form-group">
              <label for="max-members">Max Members</label>
              <select id="max-members">
                <option value="10">10 Players</option>
                <option value="15">15 Players</option>
                <option value="20" selected>20 Players</option>
                <option value="30">30 Players</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>
                <input type="checkbox" id="auto-pick-enabled" checked>
                Enable auto-pick for missed deadlines
              </label>
            </div>
            
            <div class="form-actions">
              <button type="button" id="cancel-create">Cancel</button>
              <button type="submit" id="create-league-btn">Create League</button>
            </div>
          </form>
        </div>
      </div>
    `),this.activeModal=document.getElementById("league-modal"),this.attachCreateLeagueEvents()}showJoinLeagueModal(){this.closeActiveModal(),document.body.insertAdjacentHTML("beforeend",`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content">
          <button class="close-btn">&times;</button>
          <h3>Join League</h3>
          
          <form id="join-league-form">
            <div class="form-group">
              <label for="invite-code">Invite Code</label>
              <input type="text" id="invite-code" placeholder="Enter 8-character code" maxlength="8" required>
              <small>Ask your league organizer for the invite code</small>
            </div>
            
            <div id="league-preview" class="league-preview" style="display: none;">
              <h4>League Preview</h4>
              <div class="preview-info">
                <p><strong>Name:</strong> <span id="preview-name"></span></p>
                <p><strong>Members:</strong> <span id="preview-members"></span></p>
                <p><strong>Season:</strong> <span id="preview-season"></span></p>
              </div>
            </div>
            
            <div id="join-error" class="error-message" style="display: none;"></div>
            
            <div class="form-actions">
              <button type="button" id="cancel-join">Cancel</button>
              <button type="submit" id="join-league-btn">Join League</button>
            </div>
          </form>
        </div>
      </div>
    `),this.activeModal=document.getElementById("league-modal"),this.attachJoinLeagueEvents()}showManageLeaguesModal(){this.closeActiveModal();const t=this.leagueManager.getUserLeagues(),n=`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content large">
          <button class="close-btn">&times;</button>
          <h3>Manage Leagues</h3>
          
          <div class="league-actions">
            <button id="create-league-action" class="action-btn create">
              <span class="icon">+</span>
              Create New League
            </button>
            <button id="join-league-action" class="action-btn join">
              <span class="icon">🔗</span>
              Join League
            </button>
          </div>
          
          <div class="user-leagues">
            <h4>Your Leagues</h4>
            <div class="leagues-list">
              ${t.length===0?`<p class="no-leagues">You haven't joined any leagues yet.</p>`:t.map(r=>`
                  <div class="league-item" data-league-id="${r.leagueId}">
                    <div class="league-info">
                      <h5>${this.escapeHtml(r.leagueName)}</h5>
                      <p>${r.members.length} members • ${r.isOwner?"Owner":"Member"}</p>
                      ${r.isOwner?`<p class="invite-code">Invite Code: <strong>${r.inviteCode}</strong></p>`:""}
                    </div>
                    <div class="league-actions-item">
                      <button class="select-league" data-league-id="${r.leagueId}">Select</button>
                      ${r.isOwner?`<button class="manage-league" data-league-id="${r.leagueId}">Settings</button>`:""}
                      <button class="leave-league" data-league-id="${r.leagueId}">${r.isOwner?"Delete":"Leave"}</button>
                    </div>
                  </div>
                `).join("")}
            </div>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",n),this.activeModal=document.getElementById("league-modal"),this.attachManageLeaguesEvents()}showLeagueSettingsModal(t){this.closeActiveModal();const n=this.leagueManager.getLeague(t);if(!n||n.ownerId!==this.leagueManager.currentUserId)return;const r=`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content">
          <button class="close-btn">&times;</button>
          <h3>League Settings: ${this.escapeHtml(n.leagueName)}</h3>
          
          <div class="league-info-section">
            <p><strong>Invite Code:</strong> <span class="invite-code-display">${n.inviteCode}</span></p>
            <button class="copy-invite-code" data-code="${n.inviteCode}">Copy Code</button>
          </div>
          
          <form id="league-settings-form">
            <div class="form-group">
              <label for="max-members-setting">Max Members</label>
              <select id="max-members-setting">
                <option value="10" ${n.settings.maxMembers===10?"selected":""}>10 Players</option>
                <option value="15" ${n.settings.maxMembers===15?"selected":""}>15 Players</option>
                <option value="20" ${n.settings.maxMembers===20?"selected":""}>20 Players</option>
                <option value="30" ${n.settings.maxMembers===30?"selected":""}>30 Players</option>
              </select>
              <small>Current members: ${n.members.length}</small>
            </div>
            
            <div class="form-group">
              <label>
                <input type="checkbox" id="auto-pick-enabled-setting" ${n.settings.autoPickEnabled?"checked":""}>
                Enable auto-pick for missed deadlines
              </label>
            </div>
            
            <div class="form-actions">
              <button type="button" id="cancel-settings">Cancel</button>
              <button type="submit" id="save-settings-btn">Save Settings</button>
            </div>
          </form>
          
          <div class="members-section">
            <h4>Members</h4>
            <div class="members-list">
              ${n.members.map(i=>`
                <div class="member-item">
                  <span class="member-name">${this.escapeHtml(i.username)} ${i.isOwner?"(Owner)":""}</span>
                  ${!i.isOwner&&i.userId!==this.leagueManager.currentUserId?`<button class="kick-member" data-user-id="${i.userId}">Remove</button>`:""}
                </div>
              `).join("")}
            </div>
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),this.activeModal=document.getElementById("league-modal"),this.attachLeagueSettingsEvents(t)}attachCreateLeagueEvents(){const t=this.activeModal,n=t.querySelector("#create-league-form"),r=t.querySelector(".close-btn"),i=t.querySelector("#cancel-create");r.addEventListener("click",()=>this.closeActiveModal()),i.addEventListener("click",()=>this.closeActiveModal()),n.addEventListener("submit",async s=>{s.preventDefault();const o=document.getElementById("league-name").value,a=parseInt(document.getElementById("max-members").value),c=document.getElementById("auto-pick-enabled").checked;try{const u=await this.leagueManager.createLeague(o,{maxMembers:a,autoPickEnabled:c});this.showSuccessModal("League Created!",`Your league "${u.leagueName}" has been created successfully.<br>
          <strong>Invite Code: ${u.inviteCode}</strong><br>
          Share this code with friends to invite them to your league.`),this.leagueManager.setActiveLeague(u.leagueId),setTimeout(()=>{window.location.reload()},3e3)}catch(u){this.showError(u.message)}})}attachJoinLeagueEvents(){const t=this.activeModal,n=t.querySelector("#join-league-form"),r=t.querySelector(".close-btn"),i=t.querySelector("#cancel-join"),s=t.querySelector("#invite-code"),o=t.querySelector("#league-preview"),a=t.querySelector("#join-error");r.addEventListener("click",()=>this.closeActiveModal()),i.addEventListener("click",()=>this.closeActiveModal());let c;s.addEventListener("input",u=>{clearTimeout(c);const l=u.target.value.trim();l.length===8?c=setTimeout(()=>{const d=this.leagueManager.previewLeague(l);d?(t.querySelector("#preview-name").textContent=d.leagueName,t.querySelector("#preview-members").textContent=`${d.memberCount}/${d.maxMembers}`,t.querySelector("#preview-season").textContent=d.season,o.style.display="block",a.style.display="none"):o.style.display="none"},300):o.style.display="none"}),n.addEventListener("submit",async u=>{u.preventDefault();const l=s.value.trim();try{const d=await this.leagueManager.joinLeague(l);this.showSuccessModal("Joined League!",`You have successfully joined "${d.leagueName}".`),this.leagueManager.setActiveLeague(d.leagueId),setTimeout(()=>{window.location.reload()},2e3)}catch(d){a.textContent=d.message,a.style.display="block"}})}attachManageLeaguesEvents(){const t=this.activeModal,n=t.querySelector(".close-btn"),r=t.querySelector("#create-league-action"),i=t.querySelector("#join-league-action");n.addEventListener("click",()=>this.closeActiveModal()),r.addEventListener("click",()=>this.showCreateLeagueModal()),i.addEventListener("click",()=>this.showJoinLeagueModal()),t.querySelectorAll(".select-league").forEach(s=>{s.addEventListener("click",o=>{const a=o.target.dataset.leagueId;this.leagueManager.setActiveLeague(a),window.location.reload()})}),t.querySelectorAll(".manage-league").forEach(s=>{s.addEventListener("click",o=>{const a=o.target.dataset.leagueId;this.showLeagueSettingsModal(a)})}),t.querySelectorAll(".leave-league").forEach(s=>{s.addEventListener("click",async o=>{const a=o.target.dataset.leagueId,c=this.leagueManager.getLeague(a),u=this.leagueManager.isLeagueOwner(a),l=u?`Are you sure you want to delete "${c.leagueName}"? This action cannot be undone.`:`Are you sure you want to leave "${c.leagueName}"?`;if(confirm(l))try{u?await this.leagueManager.deleteLeague(a):await this.leagueManager.leaveLeague(a),window.location.reload()}catch(d){this.showError(d.message)}})})}attachLeagueSettingsEvents(t){const n=this.activeModal,r=n.querySelector("#league-settings-form"),i=n.querySelector(".close-btn"),s=n.querySelector("#cancel-settings"),o=n.querySelector(".copy-invite-code");i.addEventListener("click",()=>this.closeActiveModal()),s.addEventListener("click",()=>this.closeActiveModal()),o.addEventListener("click",a=>{const c=a.target.dataset.code;navigator.clipboard.writeText(c).then(()=>{a.target.textContent="Copied!",setTimeout(()=>{a.target.textContent="Copy Code"},2e3)})}),r.addEventListener("submit",async a=>{a.preventDefault();const c=parseInt(document.getElementById("max-members-setting").value),u=document.getElementById("auto-pick-enabled-setting").checked;try{await this.leagueManager.updateLeagueSettings(t,{maxMembers:c,autoPickEnabled:u}),this.showSuccessModal("Settings Updated","League settings have been updated successfully."),setTimeout(()=>{this.showManageLeaguesModal()},1500)}catch(l){this.showError(l.message)}}),n.querySelectorAll(".kick-member").forEach(a=>{a.addEventListener("click",async c=>{const u=c.target.dataset.userId,d=this.leagueManager.getLeague(t).members.find(f=>f.userId===u);if(confirm(`Are you sure you want to remove ${d.username} from the league?`))try{await this.leagueManager.kickMember(t,u),this.showLeagueSettingsModal(t)}catch(f){this.showError(f.message)}})})}showSuccessModal(t,n){this.closeActiveModal();const r=`
      <div id="league-modal" class="league-modal">
        <div class="league-modal-content small success">
          <h3>${t}</h3>
          <p>${n}</p>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",r),this.activeModal=document.getElementById("league-modal"),setTimeout(()=>{this.closeActiveModal()},3e3)}showError(t){const n=document.createElement("div");n.className="error-toast",n.textContent=t,document.body.appendChild(n),setTimeout(()=>{n.remove()},3e3)}closeActiveModal(){this.activeModal&&(this.activeModal.remove(),this.activeModal=null)}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}const Ay=new Iy;class wy{constructor(){this.leagueManager=Xa,this.modalManager=Ay,this.storageManager=Qa,this.currentLeague=null}async initialize(){this.currentLeague=this.leagueManager.getActiveLeague(),this.renderLeagueSelector(),this.currentLeague&&this.updateDashboardForLeague()}renderLeagueSelector(){const t=document.querySelector(".dashboard-container");if(!t)return;const n=document.querySelector(".league-selector-wrapper");n&&n.remove();const r=this.leagueManager.getUserLeagues(),i=this.storageManager.getActiveLeagueId(),s=`
      <div class="league-selector-wrapper">
        <div class="league-selector">
          <label>Current Mode:</label>
          <select id="league-selector">
            <option value="" ${i?"":"selected"}>Solo Play</option>
            ${r.map(o=>`
              <option value="${o.leagueId}" ${o.leagueId===i?"selected":""}>
                ${this.escapeHtml(o.leagueName)}
              </option>
            `).join("")}
          </select>
          <button id="manage-leagues-btn" class="manage-leagues-btn">
            <span class="icon">⚙️</span>
            Manage Leagues
          </button>
        </div>
      </div>
    `;t.insertAdjacentHTML("afterbegin",s),this.attachSelectorEvents()}attachSelectorEvents(){const t=document.getElementById("league-selector"),n=document.getElementById("manage-leagues-btn");t&&t.addEventListener("change",r=>{const i=r.target.value;i?this.leagueManager.setActiveLeague(i):this.leagueManager.setActiveLeague(null),window.location.reload()}),n&&n.addEventListener("click",()=>{this.modalManager.showManageLeaguesModal()})}updateDashboardForLeague(){const t=document.querySelector(".dashboard-container h1");t&&this.currentLeague&&(t.innerHTML=`Dashboard - <span class="league-name">${this.escapeHtml(this.currentLeague.leagueName)}</span>`),this.updateEliminationZoneForLeague(),this.updateStatsForLeague()}updateEliminationZoneForLeague(){if(!this.currentLeague)return;const t=this.leagueManager.getLeagueStandings(this.currentLeague.leagueId),n=document.querySelector(".elimination-zone");if(n){const r=n.querySelector(".players-container");r&&(r.innerHTML=t.map((s,o)=>`
          <div class="player-card ${s.userId===this.leagueManager.currentUserId?"current-user":""} ${s.isEliminated?"eliminated":""}">
            <div class="player-rank">${o+1}</div>
            <div class="player-info">
              <h3>${this.escapeHtml(s.username)} ${s.isOwner?'<span class="owner-badge">Owner</span>':""}</h3>
              <p>${s.survivedRaces} races survived</p>
              ${s.lastPick?`<p class="last-pick">Last pick: ${s.lastPick.driverName}</p>`:""}
            </div>
            ${s.isEliminated?'<div class="status eliminated">ELIMINATED</div>':'<div class="status active">ACTIVE</div>'}
          </div>
        `).join(""));const i=n.querySelector("h2");i&&(i.textContent=`League Standings - ${this.currentLeague.leagueName}`)}}updateStatsForLeague(){if(!this.currentLeague)return;const t=this.storageManager.loadLeaguePicks(this.currentLeague.leagueId),n=document.querySelector('[data-stat="races-survived"]');n&&(n.textContent=t.length);const r=this.leagueManager.getLeagueStandings(this.currentLeague.leagueId),i=r.findIndex(o=>o.userId===this.leagueManager.currentUserId)+1,s=document.querySelector('[data-stat="league-position"]');if(s)s.textContent=`${i}/${r.length}`;else{const o=document.querySelector(".stats-grid");if(o){const a=document.createElement("div");a.className="stat-card",a.innerHTML=`
          <h3>League Position</h3>
          <p class="stat-value" data-stat="league-position">${i}/${r.length}</p>
        `,o.appendChild(a)}}}getPickContext(){const t=this.storageManager.getActiveLeagueId();return{isLeagueMode:!!t,leagueId:t,league:t?this.leagueManager.getLeague(t):null}}async savePickWithContext(t,n){const r=this.getPickContext();if(r.isLeagueMode)return await this.storageManager.saveLeaguePick(r.leagueId,t,n);{const{saveUserPicks:i}=await fy(async()=>{const{saveUserPicks:s}=await Promise.resolve().then(()=>yy);return{saveUserPicks:s}},void 0,import.meta.url);return i(t,n)}}loadPicksWithContext(){const t=this.getPickContext();if(t.isLeagueMode)return this.storageManager.loadLeaguePicks(t.leagueId);{const{loadUserPicks:n}=window;return n()}}isDriverAlreadyPickedInContext(t){const n=this.getPickContext();if(n.isLeagueMode)return this.storageManager.isDriverAlreadyPickedInLeague(t,n.leagueId);{const{isDriverAlreadyPicked:r}=window;return r(t)}}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}const ao=new wy;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{ao.initialize()}):ao.initialize();export{co as F,fy as _,my as a,an as b,uy as c,Ze as d,hy as e,gy as f,tc as g,py as i,Qa as l,by as r,Ja as s};
